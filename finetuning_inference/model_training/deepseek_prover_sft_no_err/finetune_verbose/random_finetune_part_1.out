nohup: ignoring input
Finetuning starting.
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]Downloading shards:  50%|█████     | 1/2 [00:56<00:56, 56.23s/it]Downloading shards: 100%|██████████| 2/2 [01:29<00:00, 43.01s/it]Downloading shards: 100%|██████████| 2/2 [01:29<00:00, 44.99s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.06it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.01it/s]
trainable params: 10,644,480 || all params: 6,901,373,952 || trainable%: 0.1542
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 7876 examples [00:00, 34465.48 examples/s]Generating train split: 7876 examples [00:00, 33664.85 examples/s]
Generating valid split: 0 examples [00:00, ? examples/s]Generating valid split: 1000 examples [00:00, 29033.76 examples/s]
Map:   0%|          | 0/7876 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7876 [00:00<00:05, 1191.97 examples/s]Map:  25%|██▌       | 2000/7876 [00:01<00:04, 1205.38 examples/s]Map:  38%|███▊      | 3000/7876 [00:02<00:04, 1199.21 examples/s]Map:  51%|█████     | 4000/7876 [00:03<00:03, 1185.89 examples/s]Map:  63%|██████▎   | 5000/7876 [00:04<00:02, 1184.64 examples/s]Map:  76%|███████▌  | 6000/7876 [00:05<00:01, 1177.92 examples/s]Map:  89%|████████▉ | 7000/7876 [00:05<00:00, 1184.04 examples/s]Map: 100%|██████████| 7876/7876 [00:06<00:00, 1189.12 examples/s]Map: 100%|██████████| 7876/7876 [00:06<00:00, 1185.36 examples/s]
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1256.46 examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1228.62 examples/s]
[2024-09-07 09:00:42,446] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
df: /root/.triton/autotune: No such file or directory
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
wandb: Currently logged in as: tcwong. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.7
wandb: Run data is saved locally in /workspace/wandb/run-20240907_090055-exnotmv9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deepseek_prover_sft_no_err-random-09-07-09-00
wandb: ⭐️ View project at https://wandb.ai/tcwong/decoder
wandb: 🚀 View run at https://wandb.ai/tcwong/decoder/runs/exnotmv9
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
  0%|          | 0/492 [00:00<?, ?it/s]W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0] Graph break from `Tensor.item()`, consider setting:
W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0]     torch._dynamo.config.capture_scalar_outputs = True
W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0] or:
W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0] to include these operations in the captured graph.
W0907 09:01:03.992000 139628476088768 torch/_dynamo/variables/tensor.py:715] [17/0] 
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/492 [02:18<18:51:36, 138.28s/it]  0%|          | 2/492 [04:09<16:39:07, 122.34s/it]  1%|          | 3/492 [06:04<16:08:34, 118.84s/it]  1%|          | 4/492 [07:58<15:53:36, 117.25s/it]  1%|          | 5/492 [09:53<15:42:42, 116.14s/it]                                                     1%|          | 5/492 [09:53<15:42:42, 116.14s/it]  1%|          | 6/492 [11:47<15:36:58, 115.68s/it]  1%|▏         | 7/492 [13:41<15:30:10, 115.07s/it]  2%|▏         | 8/492 [15:36<15:26:55, 114.91s/it]  2%|▏         | 9/492 [17:30<15:24:11, 114.81s/it]  2%|▏         | 10/492 [19:25<15:21:43, 114.74s/it]                                                      2%|▏         | 10/492 [19:25<15:21:43, 114.74s/it]  2%|▏         | 11/492 [21:20<15:19:52, 114.75s/it]  2%|▏         | 12/492 [23:14<15:16:29, 114.56s/it]  3%|▎         | 13/492 [25:08<15:14:45, 114.58s/it]  3%|▎         | 14/492 [27:03<15:13:35, 114.68s/it]  3%|▎         | 15/492 [28:58<15:11:14, 114.62s/it]                                                      3%|▎         | 15/492 [28:58<15:11:14, 114.62s/it]  3%|▎         | 16/492 [30:52<15:09:05, 114.59s/it]  3%|▎         | 17/492 [32:47<15:06:53, 114.55s/it]  4%|▎         | 18/492 [34:41<15:05:00, 114.56s/it]  4%|▍         | 19/492 [36:36<15:03:11, 114.57s/it]  4%|▍         | 20/492 [38:30<15:00:51, 114.52s/it]                                                      4%|▍         | 20/492 [38:30<15:00:51, 114.52s/it]  4%|▍         | 21/492 [40:25<14:58:06, 114.41s/it]  4%|▍         | 22/492 [42:20<14:57:24, 114.56s/it]  5%|▍         | 23/492 [44:14<14:54:25, 114.43s/it]  5%|▍         | 24/492 [46:08<14:52:40, 114.45s/it]  5%|▌         | 25/492 [48:03<14:51:29, 114.54s/it]                                                      5%|▌         | 25/492 [48:03<14:51:29, 114.54s/it]  5%|▌         | 26/492 [49:57<14:49:23, 114.51s/it]  5%|▌         | 27/492 [51:52<14:48:05, 114.59s/it]  6%|▌         | 28/492 [53:46<14:45:40, 114.53s/it]  6%|▌         | 29/492 [55:41<14:43:58, 114.55s/it]  6%|▌         | 30/492 [57:36<14:42:03, 114.55s/it]                                                      6%|▌         | 30/492 [57:36<14:42:03, 114.55s/it]  6%|▋         | 31/492 [59:31<14:41:43, 114.76s/it]  7%|▋         | 32/492 [1:01:26<14:40:04, 114.79s/it]  7%|▋         | 33/492 [1:03:20<14:37:35, 114.72s/it]  7%|▋         | 34/492 [1:05:15<14:35:41, 114.72s/it]  7%|▋         | 35/492 [1:07:09<14:33:07, 114.63s/it]                                                        7%|▋         | 35/492 [1:07:09<14:33:07, 114.63s/it]  7%|▋         | 36/492 [1:09:04<14:31:47, 114.71s/it]  8%|▊         | 37/492 [1:10:59<14:30:34, 114.80s/it]  8%|▊         | 38/492 [1:12:54<14:28:52, 114.83s/it]  8%|▊         | 39/492 [1:14:48<14:25:14, 114.60s/it]  8%|▊         | 40/492 [1:16:43<14:22:54, 114.55s/it]                                                        8%|▊         | 40/492 [1:16:43<14:22:54, 114.55s/it]  8%|▊         | 41/492 [1:18:37<14:21:25, 114.60s/it]  9%|▊         | 42/492 [1:20:32<14:19:13, 114.56s/it]  9%|▊         | 43/492 [1:22:26<14:16:58, 114.52s/it]  9%|▉         | 44/492 [1:24:21<14:16:01, 114.65s/it]  9%|▉         | 45/492 [1:26:16<14:13:34, 114.57s/it]                                                        9%|▉         | 45/492 [1:26:16<14:13:34, 114.57s/it]  9%|▉         | 46/492 [1:28:10<14:10:52, 114.47s/it] 10%|▉         | 47/492 [1:30:05<14:10:46, 114.71s/it] 10%|▉         | 48/492 [1:32:00<14:09:21, 114.78s/it] 10%|▉         | 49/492 [1:33:55<14:07:38, 114.80s/it] 10%|█         | 50/492 [1:35:50<14:05:32, 114.78s/it]                                                       10%|█         | 50/492 [1:35:50<14:05:32, 114.78s/it]{'loss': 12.8904, 'grad_norm': 95.18575286865234, 'learning_rate': 1e-05, 'epoch': 0.04}
{'loss': 9.6717, 'grad_norm': 60.47364044189453, 'learning_rate': 2e-05, 'epoch': 0.08}
{'loss': 4.9122, 'grad_norm': 69.353759765625, 'learning_rate': 3e-05, 'epoch': 0.12}
{'loss': 0.6982, 'grad_norm': 0.35820522904396057, 'learning_rate': 4e-05, 'epoch': 0.16}
{'loss': 0.1738, 'grad_norm': 0.3532850742340088, 'learning_rate': 5e-05, 'epoch': 0.2}
{'loss': 0.1606, 'grad_norm': 8.06154727935791, 'learning_rate': 6e-05, 'epoch': 0.24}
{'loss': 0.1632, 'grad_norm': 0.33542144298553467, 'learning_rate': 7e-05, 'epoch': 0.28}
{'loss': 0.141, 'grad_norm': 0.2429077923297882, 'learning_rate': 8e-05, 'epoch': 0.32}
{'loss': 0.132, 'grad_norm': 0.17707887291908264, 'learning_rate': 9e-05, 'epoch': 0.37}
{'loss': 0.1388, 'grad_norm': 0.5356423258781433, 'learning_rate': 0.0001, 'epoch': 0.41}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:20,  2.11s/it][A
  2%|▏         | 3/125 [00:08<06:26,  3.17s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.70s/it][A
  4%|▍         | 5/125 [00:18<08:05,  4.04s/it][A
  5%|▍         | 6/125 [00:22<08:23,  4.23s/it][A
  6%|▌         | 7/125 [00:27<08:34,  4.36s/it][A
  6%|▋         | 8/125 [00:32<08:39,  4.44s/it][A
  7%|▋         | 9/125 [00:36<08:39,  4.48s/it][A
  8%|▊         | 10/125 [00:41<08:41,  4.53s/it][A
  9%|▉         | 11/125 [00:45<08:40,  4.57s/it][A
 10%|▉         | 12/125 [00:50<08:37,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.57s/it][A
 11%|█         | 14/125 [00:59<08:29,  4.59s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.58s/it][A
 13%|█▎        | 16/125 [01:08<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:14,  4.62s/it][A
 15%|█▌        | 19/125 [01:22<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:31<07:58,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:48,  4.59s/it][A
 19%|█▉        | 24/125 [01:45<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.64s/it][A
 21%|██        | 26/125 [01:55<07:40,  4.66s/it][A
 22%|██▏       | 27/125 [01:59<07:34,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.61s/it][A
 23%|██▎       | 29/125 [02:08<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:17,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:22<07:08,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.60s/it][A
 27%|██▋       | 34/125 [02:31<06:58,  4.59s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.60s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:45<06:44,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.59s/it][A
 31%|███       | 39/125 [02:54<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.60s/it][A
 33%|███▎      | 41/125 [03:04<06:29,  4.63s/it][A
 34%|███▎      | 42/125 [03:08<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.62s/it][A
 36%|███▌      | 45/125 [03:22<06:10,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:04,  4.62s/it][A
 38%|███▊      | 47/125 [03:31<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:45<05:45,  4.61s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:54<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:59<05:32,  4.61s/it][A
 43%|████▎     | 54/125 [04:04<05:27,  4.62s/it][A
 44%|████▍     | 55/125 [04:08<05:23,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:13,  4.62s/it][A
 46%|████▋     | 58/125 [04:22<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:31<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:49,  4.60s/it][A
 50%|█████     | 63/125 [04:45<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:54<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [04:59<04:33,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:08<04:23,  4.61s/it][A
 55%|█████▌    | 69/125 [05:13<04:17,  4.61s/it][A
 56%|█████▌    | 70/125 [05:18<04:13,  4.62s/it][A
 57%|█████▋    | 71/125 [05:22<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:31<04:01,  4.64s/it][A
 59%|█████▉    | 74/125 [05:36<03:58,  4.68s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:45<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:50<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [05:59<03:31,  4.61s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:13<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:22<03:08,  4.61s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.61s/it][A
 69%|██████▉   | 86/125 [06:32<03:00,  4.62s/it][A
 70%|██████▉   | 87/125 [06:36<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:50,  4.62s/it][A
 71%|███████   | 89/125 [06:45<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:50<02:41,  4.60s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [06:59<02:31,  4.58s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:08<02:22,  4.60s/it][A
 76%|███████▌  | 95/125 [07:13<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:22<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:31<01:59,  4.60s/it][A
 80%|████████  | 100/125 [07:36<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:45<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:50<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [07:59<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.61s/it][A
 86%|████████▌ | 107/125 [08:08<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.61s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:22<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:31<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.60s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:45<00:46,  4.64s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.63s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [08:59<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.62s/it][A
 96%|█████████▌| 120/125 [09:08<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:13<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.62s/it][A
 98%|█████████▊| 123/125 [09:22<00:09,  4.64s/it][A
 99%|█████████▉| 124/125 [09:27<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A                                                      
                                                 [A 10%|█         | 50/492 [1:45:27<14:05:32, 114.78s/it]
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-50)... Done. 9.4s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 10%|█         | 51/492 [1:47:41<35:59:44, 293.84s/it] 11%|█         | 52/492 [1:49:36<29:21:19, 240.18s/it] 11%|█         | 53/492 [1:51:31<24:40:52, 202.40s/it] 11%|█         | 54/492 [1:53:25<21:25:14, 176.06s/it] 11%|█         | 55/492 [1:55:20<19:08:07, 157.64s/it]                                                       11%|█         | 55/492 [1:55:20<19:08:07, 157.64s/it] 11%|█▏        | 56/492 [1:57:14<17:30:54, 144.62s/it] 12%|█▏        | 57/492 [1:59:09<16:23:34, 135.67s/it] 12%|█▏        | 58/492 [2:01:04<15:35:59, 129.40s/it] 12%|█▏        | 59/492 [2:02:58<15:00:42, 124.81s/it] 12%|█▏        | 60/492 [2:04:52<14:36:18, 121.71s/it]                                                       12%|█▏        | 60/492 [2:04:52<14:36:18, 121.71s/it] 12%|█▏        | 61/492 [2:06:47<14:19:45, 119.69s/it] 13%|█▎        | 62/492 [2:08:42<14:07:44, 118.29s/it] 13%|█▎        | 63/492 [2:10:37<13:57:14, 117.10s/it] 13%|█▎        | 64/492 [2:12:31<13:49:59, 116.35s/it] 13%|█▎        | 65/492 [2:14:26<13:44:08, 115.81s/it]                                                       13%|█▎        | 65/492 [2:14:26<13:44:08, 115.81s/it] 13%|█▎        | 66/492 [2:16:21<13:40:40, 115.59s/it] 14%|█▎        | 67/492 [2:18:15<13:35:59, 115.20s/it] 14%|█▍        | 68/492 [2:20:10<13:33:18, 115.09s/it] 14%|█▍        | 69/492 [2:22:04<13:30:10, 114.92s/it] 14%|█▍        | 70/492 [2:23:59<13:27:23, 114.80s/it]                                                       14%|█▍        | 70/492 [2:23:59<13:27:23, 114.80s/it] 14%|█▍        | 71/492 [2:25:53<13:24:50, 114.70s/it] 15%|█▍        | 72/492 [2:27:47<13:21:27, 114.49s/it] 15%|█▍        | 73/492 [2:29:41<13:18:42, 114.37s/it] 15%|█▌        | 74/492 [2:31:36<13:17:57, 114.54s/it] 15%|█▌        | 75/492 [2:33:31<13:16:17, 114.57s/it]                                                       15%|█▌        | 75/492 [2:33:31<13:16:17, 114.57s/it] 15%|█▌        | 76/492 [2:35:26<13:14:49, 114.64s/it] 16%|█▌        | 77/492 [2:37:21<13:13:19, 114.70s/it] 16%|█▌        | 78/492 [2:39:16<13:12:15, 114.82s/it] 16%|█▌        | 79/492 [2:41:11<13:10:33, 114.85s/it] 16%|█▋        | 80/492 [2:43:06<13:08:40, 114.85s/it]                                                       16%|█▋        | 80/492 [2:43:06<13:08:40, 114.85s/it] 16%|█▋        | 81/492 [2:45:00<13:05:23, 114.66s/it] 17%|█▋        | 82/492 [2:46:55<13:05:22, 114.93s/it] 17%|█▋        | 83/492 [2:48:50<13:02:16, 114.76s/it] 17%|█▋        | 84/492 [2:50:44<12:59:33, 114.64s/it] 17%|█▋        | 85/492 [2:52:39<12:58:03, 114.70s/it]                                                       17%|█▋        | 85/492 [2:52:39<12:58:03, 114.70s/it] 17%|█▋        | 86/492 [2:54:33<12:55:32, 114.61s/it] 18%|█▊        | 87/492 [2:56:28<12:53:01, 114.52s/it] 18%|█▊        | 88/492 [2:58:22<12:50:47, 114.47s/it] 18%|█▊        | 89/492 [3:00:17<12:50:25, 114.70s/it] 18%|█▊        | 90/492 [3:02:12<12:48:42, 114.73s/it]                                                       18%|█▊        | 90/492 [3:02:12<12:48:42, 114.73s/it] 18%|█▊        | 91/492 [3:04:07<12:47:22, 114.82s/it] 19%|█▊        | 92/492 [3:06:02<12:45:12, 114.78s/it] 19%|█▉        | 93/492 [3:07:56<12:42:50, 114.71s/it] 19%|█▉        | 94/492 [3:09:51<12:41:31, 114.80s/it] 19%|█▉        | 95/492 [3:11:46<12:38:42, 114.67s/it]                                                       19%|█▉        | 95/492 [3:11:46<12:38:42, 114.67s/it] 20%|█▉        | 96/492 [3:13:40<12:36:20, 114.60s/it] 20%|█▉        | 97/492 [3:15:34<12:33:09, 114.40s/it] 20%|█▉        | 98/492 [3:17:29<12:32:18, 114.56s/it] 20%|██        | 99/492 [3:19:24<12:31:15, 114.70s/it] 20%|██        | 100/492 [3:21:19<12:29:32, 114.73s/it]                                                        20%|██        | 100/492 [3:21:19<12:29:32, 114.73s/it]{'eval_loss': 0.13083037734031677, 'eval_runtime': 577.2624, 'eval_samples_per_second': 1.732, 'eval_steps_per_second': 0.217, 'epoch': 0.41}
{'loss': 0.1288, 'grad_norm': 0.0570620633661747, 'learning_rate': 9.996842891446092e-05, 'epoch': 0.45}
{'loss': 0.1179, 'grad_norm': 0.07483270764350891, 'learning_rate': 9.987375552718133e-05, 'epoch': 0.49}
{'loss': 0.1245, 'grad_norm': 0.04857001453638077, 'learning_rate': 9.971609939582557e-05, 'epoch': 0.53}
{'loss': 0.121, 'grad_norm': 0.06141730025410652, 'learning_rate': 9.9495659615402e-05, 'epoch': 0.57}
{'loss': 0.1082, 'grad_norm': 0.07013677060604095, 'learning_rate': 9.921271456683715e-05, 'epoch': 0.61}
{'loss': 0.1338, 'grad_norm': 0.027853988111019135, 'learning_rate': 9.886762156542428e-05, 'epoch': 0.65}
{'loss': 0.1161, 'grad_norm': 0.039150092750787735, 'learning_rate': 9.846081640959007e-05, 'epoch': 0.69}
{'loss': 0.1151, 'grad_norm': 0.029366208240389824, 'learning_rate': 9.79928128305494e-05, 'epoch': 0.73}
{'loss': 0.1192, 'grad_norm': 0.02762170508503914, 'learning_rate': 9.746420184354334e-05, 'epoch': 0.77}
{'loss': 0.1137, 'grad_norm': 0.025405680760741234, 'learning_rate': 9.687565100147939e-05, 'epoch': 0.81}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:43,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:40,  3.28s/it][A
  3%|▎         | 4/125 [00:13<07:36,  3.77s/it][A
  4%|▍         | 5/125 [00:18<08:10,  4.09s/it][A
  5%|▍         | 6/125 [00:23<08:27,  4.26s/it][A
  6%|▌         | 7/125 [00:27<08:37,  4.38s/it][A
  6%|▋         | 8/125 [00:32<08:41,  4.45s/it][A
  7%|▋         | 9/125 [00:36<08:40,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:41,  4.54s/it][A
  9%|▉         | 11/125 [00:46<08:41,  4.57s/it][A
 10%|▉         | 12/125 [00:50<08:37,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [01:00<08:29,  4.59s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.59s/it][A
 13%|█▎        | 16/125 [01:09<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:14,  4.62s/it][A
 15%|█▌        | 19/125 [01:23<08:08,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:48,  4.59s/it][A
 19%|█▉        | 24/125 [01:46<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.64s/it][A
 21%|██        | 26/125 [01:55<07:41,  4.66s/it][A
 22%|██▏       | 27/125 [02:00<07:34,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:17,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.60s/it][A
 27%|██▋       | 34/125 [02:32<06:57,  4.59s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.59s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:46<06:43,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.59s/it][A
 31%|███       | 39/125 [02:55<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.60s/it][A
 33%|███▎      | 41/125 [03:04<06:29,  4.63s/it][A
 34%|███▎      | 42/125 [03:09<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.62s/it][A
 36%|███▌      | 45/125 [03:23<06:10,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:05,  4.62s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:54,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:46<05:45,  4.61s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:55<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:59<05:32,  4.61s/it][A
 43%|████▎     | 54/125 [04:04<05:27,  4.62s/it][A
 44%|████▍     | 55/125 [04:09<05:23,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:13,  4.62s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:49,  4.60s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [04:59<04:33,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:09<04:22,  4.61s/it][A
 55%|█████▌    | 69/125 [05:13<04:17,  4.61s/it][A
 56%|█████▌    | 70/125 [05:18<04:13,  4.62s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:32<04:01,  4.64s/it][A
 59%|█████▉    | 74/125 [05:37<03:58,  4.68s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:50<03:42,  4.63s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [06:00<03:31,  4.61s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:13<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.61s/it][A
 69%|██████▉   | 86/125 [06:32<03:00,  4.62s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:50,  4.62s/it][A
 71%|███████   | 89/125 [06:46<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:50<02:41,  4.60s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [06:59<02:31,  4.58s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:22,  4.60s/it][A
 76%|███████▌  | 95/125 [07:13<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<01:59,  4.60s/it][A
 80%|████████  | 100/125 [07:36<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:50<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [08:00<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.61s/it][A
 86%|████████▌ | 107/125 [08:09<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.61s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.59s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.64s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.63s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.62s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:13<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.62s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.64s/it][A
 99%|█████████▉| 124/125 [09:27<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A                                                       
                                                 [A 20%|██        | 100/492 [3:30:56<12:29:32, 114.73s/it]
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-100)... Done. 9.9s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 21%|██        | 101/492 [3:33:08<31:49:57, 293.09s/it] 21%|██        | 102/492 [3:35:02<25:56:36, 239.48s/it] 21%|██        | 103/492 [3:36:57<21:50:18, 202.10s/it] 21%|██        | 104/492 [3:38:52<18:57:39, 175.93s/it] 21%|██▏       | 105/492 [3:40:47<16:56:06, 157.54s/it]                                                        21%|██▏       | 105/492 [3:40:47<16:56:06, 157.54s/it] 22%|██▏       | 106/492 [3:42:42<15:30:51, 144.69s/it] 22%|██▏       | 107/492 [3:44:36<14:29:49, 135.56s/it] 22%|██▏       | 108/492 [3:46:31<13:47:56, 129.37s/it] 22%|██▏       | 109/492 [3:48:25<13:17:08, 124.88s/it] 22%|██▏       | 110/492 [3:50:20<12:55:47, 121.85s/it]                                                        22%|██▏       | 110/492 [3:50:20<12:55:47, 121.85s/it] 23%|██▎       | 111/492 [3:52:15<12:40:20, 119.74s/it] 23%|██▎       | 112/492 [3:54:09<12:28:44, 118.22s/it] 23%|██▎       | 113/492 [3:56:04<12:20:36, 117.25s/it] 23%|██▎       | 114/492 [3:57:59<12:13:54, 116.49s/it] 23%|██▎       | 115/492 [3:59:54<12:08:55, 116.01s/it]                                                        23%|██▎       | 115/492 [3:59:54<12:08:55, 116.01s/it] 24%|██▎       | 116/492 [4:01:48<12:03:53, 115.51s/it] 24%|██▍       | 117/492 [4:03:43<12:00:43, 115.32s/it] 24%|██▍       | 118/492 [4:05:38<11:57:37, 115.13s/it] 24%|██▍       | 119/492 [4:07:32<11:54:10, 114.88s/it] 24%|██▍       | 120/492 [4:09:27<11:51:43, 114.80s/it]                                                        24%|██▍       | 120/492 [4:09:27<11:51:43, 114.80s/it] 25%|██▍       | 121/492 [4:11:21<11:49:29, 114.74s/it] 25%|██▍       | 122/492 [4:13:16<11:47:56, 114.80s/it] 25%|██▌       | 123/492 [4:15:11<11:46:41, 114.91s/it]/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 25%|██▌       | 124/492 [4:17:13<11:56:12, 116.77s/it] 25%|██▌       | 125/492 [4:19:07<11:50:20, 116.13s/it]                                                        25%|██▌       | 125/492 [4:19:07<11:50:20, 116.13s/it] 26%|██▌       | 126/492 [4:21:02<11:46:06, 115.75s/it] 26%|██▌       | 127/492 [4:22:57<11:41:55, 115.39s/it] 26%|██▌       | 128/492 [4:24:51<11:38:22, 115.12s/it] 26%|██▌       | 129/492 [4:26:46<11:35:59, 115.04s/it] 26%|██▋       | 130/492 [4:28:41<11:33:18, 114.91s/it]                                                        26%|██▋       | 130/492 [4:28:41<11:33:18, 114.91s/it] 27%|██▋       | 131/492 [4:30:36<11:32:00, 115.02s/it] 27%|██▋       | 132/492 [4:32:32<11:31:40, 115.28s/it] 27%|██▋       | 133/492 [4:34:27<11:28:50, 115.13s/it] 27%|██▋       | 134/492 [4:36:21<11:26:22, 115.03s/it] 27%|██▋       | 135/492 [4:38:16<11:23:57, 114.95s/it]                                                        27%|██▋       | 135/492 [4:38:16<11:23:57, 114.95s/it] 28%|██▊       | 136/492 [4:40:10<11:20:48, 114.74s/it] 28%|██▊       | 137/492 [4:42:05<11:18:46, 114.72s/it] 28%|██▊       | 138/492 [4:44:00<11:17:01, 114.75s/it] 28%|██▊       | 139/492 [4:45:54<11:14:45, 114.69s/it] 28%|██▊       | 140/492 [4:47:49<11:12:58, 114.71s/it]                                                        28%|██▊       | 140/492 [4:47:49<11:12:58, 114.71s/it] 29%|██▊       | 141/492 [4:49:44<11:10:54, 114.69s/it] 29%|██▉       | 142/492 [4:51:38<11:08:39, 114.63s/it] 29%|██▉       | 143/492 [4:53:33<11:06:56, 114.66s/it] 29%|██▉       | 144/492 [4:55:28<11:05:09, 114.68s/it] 29%|██▉       | 145/492 [4:57:22<11:02:48, 114.61s/it]                                                        29%|██▉       | 145/492 [4:57:22<11:02:48, 114.61s/it] 30%|██▉       | 146/492 [4:59:17<11:01:03, 114.63s/it] 30%|██▉       | 147/492 [5:01:11<10:58:35, 114.54s/it] 30%|███       | 148/492 [5:03:06<10:56:43, 114.54s/it] 30%|███       | 149/492 [5:05:00<10:54:44, 114.53s/it] 30%|███       | 150/492 [5:06:54<10:52:20, 114.44s/it]                                                        30%|███       | 150/492 [5:06:54<10:52:20, 114.44s/it]{'eval_loss': 0.11551322042942047, 'eval_runtime': 577.0742, 'eval_samples_per_second': 1.733, 'eval_steps_per_second': 0.217, 'epoch': 0.81}
{'loss': 0.1067, 'grad_norm': 0.02768566645681858, 'learning_rate': 9.622790355191672e-05, 'epoch': 0.85}
{'loss': 0.1103, 'grad_norm': 0.028063081204891205, 'learning_rate': 9.552177749846083e-05, 'epoch': 0.89}
{'loss': 0.1173, 'grad_norm': 0.028980253264307976, 'learning_rate': 9.475816456775313e-05, 'epoch': 0.93}
{'loss': 0.1089, 'grad_norm': 0.025315387174487114, 'learning_rate': 9.393802908335977e-05, 'epoch': 0.97}
{'loss': 0.1137, 'grad_norm': 0.026901153847575188, 'learning_rate': 9.306240674798203e-05, 'epoch': 1.02}
{'loss': 0.1054, 'grad_norm': 0.025451259687542915, 'learning_rate': 9.213240333552589e-05, 'epoch': 1.06}
{'loss': 0.1299, 'grad_norm': 0.0280075091868639, 'learning_rate': 9.114919329468282e-05, 'epoch': 1.1}
{'loss': 0.1009, 'grad_norm': 0.029911836609244347, 'learning_rate': 9.011401826578492e-05, 'epoch': 1.14}
{'loss': 0.1016, 'grad_norm': 0.029297418892383575, 'learning_rate': 8.902818551280758e-05, 'epoch': 1.18}
{'loss': 0.0949, 'grad_norm': 0.0310602355748415, 'learning_rate': 8.789306627249985e-05, 'epoch': 1.22}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:40,  3.28s/it][A
  3%|▎         | 4/125 [00:13<07:36,  3.78s/it][A
  4%|▍         | 5/125 [00:18<08:10,  4.09s/it][A
  5%|▍         | 6/125 [00:23<08:27,  4.27s/it][A
  6%|▌         | 7/125 [00:27<08:37,  4.39s/it][A
  6%|▋         | 8/125 [00:32<08:41,  4.46s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:42,  4.54s/it][A
  9%|▉         | 11/125 [00:46<08:41,  4.58s/it][A
 10%|▉         | 12/125 [00:50<08:38,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:33,  4.58s/it][A
 11%|█         | 14/125 [01:00<08:30,  4.60s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.59s/it][A
 13%|█▎        | 16/125 [01:09<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:14,  4.62s/it][A
 15%|█▌        | 19/125 [01:23<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:48,  4.59s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.64s/it][A
 21%|██        | 26/125 [01:55<07:41,  4.66s/it][A
 22%|██▏       | 27/125 [02:00<07:34,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:17,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.61s/it][A
 27%|██▋       | 34/125 [02:32<06:58,  4.59s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.60s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:46<06:44,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.59s/it][A
 31%|███       | 39/125 [02:55<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:29,  4.63s/it][A
 34%|███▎      | 42/125 [03:09<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.62s/it][A
 36%|███▌      | 45/125 [03:23<06:11,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:05,  4.62s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:46<05:45,  4.61s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:55<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [04:00<05:32,  4.61s/it][A
 43%|████▎     | 54/125 [04:04<05:27,  4.62s/it][A
 44%|████▍     | 55/125 [04:09<05:23,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:19,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:49,  4.60s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.63s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [05:00<04:33,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:09<04:23,  4.61s/it][A
 55%|█████▌    | 69/125 [05:13<04:17,  4.61s/it][A
 56%|█████▌    | 70/125 [05:18<04:13,  4.62s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:32<04:01,  4.64s/it][A
 59%|█████▉    | 74/125 [05:37<03:58,  4.68s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:51<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [06:00<03:31,  4.61s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:14<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.61s/it][A
 69%|██████▉   | 86/125 [06:32<03:00,  4.62s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:50,  4.62s/it][A
 71%|███████   | 89/125 [06:46<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:50<02:41,  4.60s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [07:00<02:31,  4.58s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:22,  4.60s/it][A
 76%|███████▌  | 95/125 [07:13<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<01:59,  4.60s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:50<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [08:00<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.61s/it][A
 86%|████████▌ | 107/125 [08:09<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.61s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.60s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.64s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.63s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.62s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.62s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.64s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.64s/it][A                                                       
                                                 [A 30%|███       | 150/492 [5:16:32<10:52:20, 114.44s/it]
100%|██████████| 125/125 [09:33<00:00,  4.64s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-150)... Done. 9.8s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 31%|███       | 151/492 [5:18:46<27:48:58, 293.66s/it] 31%|███       | 152/492 [5:20:41<22:39:48, 239.97s/it] 31%|███       | 153/492 [5:22:35<19:03:06, 202.32s/it] 31%|███▏      | 154/492 [5:24:30<16:31:40, 176.04s/it] 32%|███▏      | 155/492 [5:26:24<14:44:23, 157.46s/it]                                                        32%|███▏      | 155/492 [5:26:24<14:44:23, 157.46s/it] 32%|███▏      | 156/492 [5:28:19<13:30:18, 144.70s/it] 32%|███▏      | 157/492 [5:30:14<12:37:37, 135.69s/it] 32%|███▏      | 158/492 [5:32:08<11:59:43, 129.29s/it] 32%|███▏      | 159/492 [5:34:03<11:33:09, 124.89s/it] 33%|███▎      | 160/492 [5:35:58<11:14:09, 121.84s/it]                                                        33%|███▎      | 160/492 [5:35:58<11:14:09, 121.84s/it] 33%|███▎      | 161/492 [5:37:52<10:59:57, 119.63s/it] 33%|███▎      | 162/492 [5:39:47<10:50:09, 118.21s/it] 33%|███▎      | 163/492 [5:41:42<10:42:55, 117.25s/it] 33%|███▎      | 164/492 [5:43:37<10:37:14, 116.57s/it] 34%|███▎      | 165/492 [5:45:32<10:32:35, 116.07s/it]                                                        34%|███▎      | 165/492 [5:45:32<10:32:35, 116.07s/it] 34%|███▎      | 166/492 [5:47:26<10:28:13, 115.62s/it] 34%|███▍      | 167/492 [5:49:22<10:25:20, 115.45s/it] 34%|███▍      | 168/492 [5:51:16<10:22:14, 115.23s/it] 34%|███▍      | 169/492 [5:53:11<10:19:11, 115.02s/it] 35%|███▍      | 170/492 [5:55:06<10:17:03, 114.98s/it]                                                        35%|███▍      | 170/492 [5:55:06<10:17:03, 114.98s/it] 35%|███▍      | 171/492 [5:57:01<10:15:23, 115.03s/it] 35%|███▍      | 172/492 [5:58:55<10:12:59, 114.94s/it] 35%|███▌      | 173/492 [6:00:50<10:10:11, 114.77s/it] 35%|███▌      | 174/492 [6:02:44<10:07:57, 114.71s/it] 36%|███▌      | 175/492 [6:04:39<10:06:08, 114.73s/it]                                                        36%|███▌      | 175/492 [6:04:39<10:06:08, 114.73s/it] 36%|███▌      | 176/492 [6:06:34<10:03:47, 114.64s/it] 36%|███▌      | 177/492 [6:08:28<10:01:22, 114.55s/it] 36%|███▌      | 178/492 [6:10:23<9:59:54, 114.63s/it]  36%|███▋      | 179/492 [6:12:18<9:58:41, 114.76s/it] 37%|███▋      | 180/492 [6:14:12<9:56:23, 114.69s/it]                                                       37%|███▋      | 180/492 [6:14:12<9:56:23, 114.69s/it] 37%|███▋      | 181/492 [6:16:07<9:54:28, 114.69s/it] 37%|███▋      | 182/492 [6:18:02<9:52:29, 114.68s/it] 37%|███▋      | 183/492 [6:19:56<9:49:51, 114.54s/it] 37%|███▋      | 184/492 [6:21:51<9:48:31, 114.65s/it] 38%|███▊      | 185/492 [6:23:45<9:46:21, 114.60s/it]                                                       38%|███▊      | 185/492 [6:23:45<9:46:21, 114.60s/it] 38%|███▊      | 186/492 [6:25:40<9:44:27, 114.60s/it] 38%|███▊      | 187/492 [6:27:34<9:42:09, 114.52s/it] 38%|███▊      | 188/492 [6:29:28<9:39:34, 114.39s/it] 38%|███▊      | 189/492 [6:31:23<9:37:34, 114.37s/it] 39%|███▊      | 190/492 [6:33:17<9:35:46, 114.39s/it]                                                       39%|███▊      | 190/492 [6:33:17<9:35:46, 114.39s/it] 39%|███▉      | 191/492 [6:35:12<9:34:26, 114.51s/it] 39%|███▉      | 192/492 [6:37:06<9:32:07, 114.43s/it] 39%|███▉      | 193/492 [6:39:02<9:31:50, 114.75s/it] 39%|███▉      | 194/492 [6:40:56<9:29:02, 114.57s/it] 40%|███▉      | 195/492 [6:42:50<9:26:58, 114.54s/it]                                                       40%|███▉      | 195/492 [6:42:50<9:26:58, 114.54s/it] 40%|███▉      | 196/492 [6:44:45<9:25:31, 114.63s/it] 40%|████      | 197/492 [6:46:40<9:23:49, 114.68s/it] 40%|████      | 198/492 [6:48:34<9:21:36, 114.61s/it] 40%|████      | 199/492 [6:50:30<9:20:35, 114.80s/it] 41%|████      | 200/492 [6:52:24<9:18:27, 114.75s/it]                                                       41%|████      | 200/492 [6:52:24<9:18:27, 114.75s/it]{'eval_loss': 0.10870195180177689, 'eval_runtime': 577.2383, 'eval_samples_per_second': 1.732, 'eval_steps_per_second': 0.217, 'epoch': 1.22}
{'loss': 0.0996, 'grad_norm': 0.030549369752407074, 'learning_rate': 8.6710094022727e-05, 'epoch': 1.26}
{'loss': 0.106, 'grad_norm': 0.033894069492816925, 'learning_rate': 8.548076267221256e-05, 'epoch': 1.3}
{'loss': 0.1162, 'grad_norm': 0.034311868250370026, 'learning_rate': 8.420662467396547e-05, 'epoch': 1.34}
{'loss': 0.1058, 'grad_norm': 0.040043774992227554, 'learning_rate': 8.288928906477496e-05, 'epoch': 1.38}
{'loss': 0.101, 'grad_norm': 0.0440133698284626, 'learning_rate': 8.15304194332491e-05, 'epoch': 1.42}
{'loss': 0.0981, 'grad_norm': 0.03563845902681351, 'learning_rate': 8.013173181896283e-05, 'epoch': 1.46}
{'loss': 0.1002, 'grad_norm': 0.039490845054388046, 'learning_rate': 7.869499254536865e-05, 'epoch': 1.5}
{'loss': 0.0897, 'grad_norm': 0.044993579387664795, 'learning_rate': 7.722201598920673e-05, 'epoch': 1.54}
{'loss': 0.0996, 'grad_norm': 0.04990144819021225, 'learning_rate': 7.571466228923115e-05, 'epoch': 1.58}
{'loss': 0.1103, 'grad_norm': 0.04168887436389923, 'learning_rate': 7.417483499714589e-05, 'epoch': 1.62}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:43,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:40,  3.28s/it][A
  3%|▎         | 4/125 [00:13<07:36,  3.78s/it][A
  4%|▍         | 5/125 [00:18<08:11,  4.09s/it][A
  5%|▍         | 6/125 [00:23<08:27,  4.27s/it][A
  6%|▌         | 7/125 [00:27<08:37,  4.39s/it][A
  6%|▋         | 8/125 [00:32<08:41,  4.46s/it][A
  7%|▋         | 9/125 [00:37<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:42,  4.54s/it][A
  9%|▉         | 11/125 [00:46<08:41,  4.58s/it][A
 10%|▉         | 12/125 [00:50<08:37,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [01:00<08:30,  4.60s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.59s/it][A
 13%|█▎        | 16/125 [01:09<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:14,  4.62s/it][A
 15%|█▌        | 19/125 [01:23<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:48,  4.59s/it][A
 19%|█▉        | 24/125 [01:46<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.64s/it][A
 21%|██        | 26/125 [01:55<07:41,  4.66s/it][A
 22%|██▏       | 27/125 [02:00<07:35,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:16,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.60s/it][A
 27%|██▋       | 34/125 [02:32<06:58,  4.60s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.60s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:46<06:44,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.60s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:29,  4.63s/it][A
 34%|███▎      | 42/125 [03:09<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:14,  4.62s/it][A
 36%|███▌      | 45/125 [03:23<06:11,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:05,  4.62s/it][A
 38%|███▊      | 47/125 [03:32<05:59,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:46<05:46,  4.62s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:55<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [04:00<05:32,  4.62s/it][A
 43%|████▎     | 54/125 [04:04<05:28,  4.62s/it][A
 44%|████▍     | 55/125 [04:09<05:23,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:19,  4.63s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:50,  4.60s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.63s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [05:00<04:33,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:09<04:23,  4.62s/it][A
 55%|█████▌    | 69/125 [05:13<04:18,  4.61s/it][A
 56%|█████▌    | 70/125 [05:18<04:14,  4.62s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:32<04:01,  4.64s/it][A
 59%|█████▉    | 74/125 [05:37<03:58,  4.68s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.66s/it][A
 61%|██████    | 76/125 [05:46<03:47,  4.65s/it][A
 62%|██████▏   | 77/125 [05:51<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [06:00<03:32,  4.61s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.62s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:14<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.61s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.62s/it][A
 69%|██████▉   | 86/125 [06:32<03:00,  4.62s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:50,  4.62s/it][A
 71%|███████   | 89/125 [06:46<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:51<02:41,  4.60s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [07:00<02:31,  4.58s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:22,  4.60s/it][A
 76%|███████▌  | 95/125 [07:14<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<01:59,  4.60s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:51<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.64s/it][A
 84%|████████▍ | 105/125 [08:00<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.61s/it][A
 86%|████████▌ | 107/125 [08:09<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:14<01:18,  4.61s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.60s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.64s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.63s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.62s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.64s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.64s/it][A                                                      
                                                 [A 41%|████      | 200/492 [7:02:02<9:18:27, 114.75s/it]
100%|██████████| 125/125 [09:33<00:00,  4.64s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-200)... Done. 9.6s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
wandb: WARNING Failed to cache /root/.local/share/wandb/artifacts/staging/tmp_gvyib5y, ignoring [Errno 28] Insufficient free space in /root/.cache/wandb/artifacts
 41%|████      | 201/492 [7:04:17<23:46:14, 294.07s/it] 41%|████      | 202/492 [7:06:11<19:20:46, 240.16s/it] 41%|████▏     | 203/492 [7:08:06<16:15:45, 202.58s/it] 41%|████▏     | 204/492 [7:10:01<14:05:43, 176.19s/it] 42%|████▏     | 205/492 [7:11:55<12:34:17, 157.69s/it]                                                        42%|████▏     | 205/492 [7:11:55<12:34:17, 157.69s/it] 42%|████▏     | 206/492 [7:13:50<11:30:18, 144.82s/it] 42%|████▏     | 207/492 [7:15:44<10:44:42, 135.73s/it] 42%|████▏     | 208/492 [7:17:40<10:13:11, 129.55s/it] 42%|████▏     | 209/492 [7:19:34<9:49:43, 125.03s/it]  43%|████▎     | 210/492 [7:21:28<9:32:37, 121.83s/it]                                                       43%|████▎     | 210/492 [7:21:28<9:32:37, 121.83s/it] 43%|████▎     | 211/492 [7:23:23<9:19:54, 119.55s/it] 43%|████▎     | 212/492 [7:25:17<9:11:17, 118.14s/it] 43%|████▎     | 213/492 [7:27:12<9:04:36, 117.12s/it] 43%|████▎     | 214/492 [7:29:07<8:59:49, 116.51s/it] 44%|████▎     | 215/492 [7:31:02<8:55:29, 115.99s/it]                                                       44%|████▎     | 215/492 [7:31:02<8:55:29, 115.99s/it] 44%|████▍     | 216/492 [7:32:57<8:51:32, 115.55s/it] 44%|████▍     | 217/492 [7:34:52<8:49:14, 115.47s/it] 44%|████▍     | 218/492 [7:36:47<8:46:19, 115.25s/it] 45%|████▍     | 219/492 [7:38:41<8:43:16, 115.01s/it] 45%|████▍     | 220/492 [7:40:36<8:41:18, 114.99s/it]                                                       45%|████▍     | 220/492 [7:40:36<8:41:18, 114.99s/it] 45%|████▍     | 221/492 [7:42:31<8:39:38, 115.05s/it] 45%|████▌     | 222/492 [7:44:26<8:37:09, 114.92s/it] 45%|████▌     | 223/492 [7:46:20<8:34:41, 114.80s/it] 46%|████▌     | 224/492 [7:48:15<8:32:28, 114.73s/it] 46%|████▌     | 225/492 [7:50:09<8:30:01, 114.61s/it]                                                       46%|████▌     | 225/492 [7:50:09<8:30:01, 114.61s/it] 46%|████▌     | 226/492 [7:52:04<8:28:35, 114.72s/it] 46%|████▌     | 227/492 [7:53:59<8:26:28, 114.67s/it] 46%|████▋     | 228/492 [7:55:54<8:25:20, 114.85s/it] 47%|████▋     | 229/492 [7:57:49<8:23:36, 114.89s/it] 47%|████▋     | 230/492 [7:59:44<8:21:42, 114.90s/it]                                                       47%|████▋     | 230/492 [7:59:44<8:21:42, 114.90s/it] 47%|████▋     | 231/492 [8:01:39<8:20:12, 114.99s/it] 47%|████▋     | 232/492 [8:03:34<8:18:24, 115.02s/it] 47%|████▋     | 233/492 [8:05:29<8:16:27, 115.01s/it] 48%|████▊     | 234/492 [8:07:24<8:14:46, 115.06s/it] 48%|████▊     | 235/492 [8:09:19<8:12:00, 114.86s/it]                                                       48%|████▊     | 235/492 [8:09:19<8:12:00, 114.86s/it] 48%|████▊     | 236/492 [8:11:14<8:09:53, 114.82s/it] 48%|████▊     | 237/492 [8:13:08<8:07:50, 114.79s/it] 48%|████▊     | 238/492 [8:15:03<8:05:24, 114.66s/it] 49%|████▊     | 239/492 [8:16:57<8:03:29, 114.66s/it] 49%|████▉     | 240/492 [8:18:52<8:01:37, 114.67s/it]                                                       49%|████▉     | 240/492 [8:18:52<8:01:37, 114.67s/it] 49%|████▉     | 241/492 [8:20:47<7:59:49, 114.70s/it] 49%|████▉     | 242/492 [8:22:41<7:57:15, 114.54s/it] 49%|████▉     | 243/492 [8:24:36<7:55:56, 114.68s/it] 50%|████▉     | 244/492 [8:26:31<7:54:20, 114.76s/it] 50%|████▉     | 245/492 [8:28:26<7:52:25, 114.76s/it]                                                       50%|████▉     | 245/492 [8:28:26<7:52:25, 114.76s/it] 50%|█████     | 246/492 [8:30:20<7:49:44, 114.57s/it] 50%|█████     | 247/492 [8:32:08<7:39:49, 112.61s/it] 50%|█████     | 248/492 [8:34:03<7:40:39, 113.28s/it] 51%|█████     | 249/492 [8:35:58<7:40:49, 113.78s/it] 51%|█████     | 250/492 [8:37:52<7:40:11, 114.10s/it]                                                       51%|█████     | 250/492 [8:37:52<7:40:11, 114.10s/it]{'eval_loss': 0.10267892479896545, 'eval_runtime': 577.34, 'eval_samples_per_second': 1.732, 'eval_steps_per_second': 0.217, 'epoch': 1.62}
{'loss': 0.0978, 'grad_norm': 0.04457447677850723, 'learning_rate': 7.260447867371709e-05, 'epoch': 1.66}
{'loss': 0.0963, 'grad_norm': 0.0444829948246479, 'learning_rate': 7.100557643309732e-05, 'epoch': 1.71}
{'loss': 0.096, 'grad_norm': 0.04889954626560211, 'learning_rate': 6.938014743846285e-05, 'epoch': 1.75}
{'loss': 0.098, 'grad_norm': 0.05787263438105583, 'learning_rate': 6.773024435212678e-05, 'epoch': 1.79}
{'loss': 0.0944, 'grad_norm': 0.047007594257593155, 'learning_rate': 6.605795074334794e-05, 'epoch': 1.83}
{'loss': 0.0985, 'grad_norm': 0.06226496770977974, 'learning_rate': 6.436537845710903e-05, 'epoch': 1.87}
{'loss': 0.1104, 'grad_norm': 0.04688010737299919, 'learning_rate': 6.265466494718732e-05, 'epoch': 1.91}
{'loss': 0.0879, 'grad_norm': 0.04706396162509918, 'learning_rate': 6.092797057688495e-05, 'epoch': 1.95}
{'loss': 0.0918, 'grad_norm': 0.05411742627620697, 'learning_rate': 5.918747589082853e-05, 'epoch': 1.99}
{'loss': 0.0896, 'grad_norm': 0.046843238174915314, 'learning_rate': 5.7435378861282585e-05, 'epoch': 2.03}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:40,  3.28s/it][A
  3%|▎         | 4/125 [00:13<07:37,  3.78s/it][A
  4%|▍         | 5/125 [00:18<08:10,  4.09s/it][A
  5%|▍         | 6/125 [00:23<08:27,  4.27s/it][A
  6%|▌         | 7/125 [00:27<08:37,  4.39s/it][A
  6%|▋         | 8/125 [00:32<08:41,  4.46s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:42,  4.54s/it][A
  9%|▉         | 11/125 [00:46<08:41,  4.58s/it][A
 10%|▉         | 12/125 [00:50<08:37,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:33,  4.58s/it][A
 11%|█         | 14/125 [01:00<08:30,  4.60s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.59s/it][A
 13%|█▎        | 16/125 [01:09<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:14,  4.62s/it][A
 15%|█▌        | 19/125 [01:23<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:48,  4.59s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.65s/it][A
 21%|██        | 26/125 [01:55<07:41,  4.66s/it][A
 22%|██▏       | 27/125 [02:00<07:35,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:28,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:17,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.61s/it][A
 27%|██▋       | 34/125 [02:32<06:58,  4.60s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.60s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:46<06:44,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.60s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [03:00<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:29,  4.63s/it][A
 34%|███▎      | 42/125 [03:09<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:14,  4.62s/it][A
 36%|███▌      | 45/125 [03:23<06:11,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:05,  4.62s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:46<05:46,  4.62s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:55<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [04:00<05:32,  4.62s/it][A
 43%|████▎     | 54/125 [04:04<05:28,  4.62s/it][A
 44%|████▍     | 55/125 [04:09<05:23,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:19,  4.63s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:37<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:49,  4.60s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.63s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [05:00<04:33,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:09<04:23,  4.61s/it][A
 55%|█████▌    | 69/125 [05:13<04:17,  4.61s/it][A
 56%|█████▌    | 70/125 [05:18<04:13,  4.62s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:32<04:01,  4.64s/it][A
 59%|█████▉    | 74/125 [05:37<03:58,  4.68s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.66s/it][A
 61%|██████    | 76/125 [05:46<03:47,  4.65s/it][A
 62%|██████▏   | 77/125 [05:51<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [06:00<03:31,  4.61s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:14<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.61s/it][A
 68%|██████▊   | 85/125 [06:28<03:04,  4.62s/it][A
 69%|██████▉   | 86/125 [06:32<03:00,  4.62s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:51,  4.62s/it][A
 71%|███████   | 89/125 [06:46<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:51<02:41,  4.61s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.60s/it][A
 74%|███████▎  | 92/125 [07:00<02:31,  4.59s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:22,  4.61s/it][A
 76%|███████▌  | 95/125 [07:14<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<01:59,  4.60s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.61s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.63s/it][A
 82%|████████▏ | 103/125 [07:51<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.64s/it][A
 84%|████████▍ | 105/125 [08:00<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.62s/it][A
 86%|████████▌ | 107/125 [08:09<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:14<01:18,  4.61s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.60s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.64s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.64s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.63s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.63s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.65s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.64s/it][A                                                      
                                                 [A 51%|█████     | 250/492 [8:47:30<7:40:11, 114.10s/it]
100%|██████████| 125/125 [09:33<00:00,  4.64s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-250)... Done. 9.7s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
wandb: WARNING Failed to cache /root/.local/share/wandb/artifacts/staging/tmpyu8ji5kl, ignoring [Errno 28] Insufficient free space in /root/.cache/wandb/artifacts
 51%|█████     | 251/492 [8:49:44<19:37:42, 293.20s/it] 51%|█████     | 252/492 [8:51:38<15:58:14, 239.56s/it] 51%|█████▏    | 253/492 [8:53:33<13:25:06, 202.12s/it] 52%|█████▏    | 254/492 [8:55:28<11:38:06, 175.99s/it] 52%|█████▏    | 255/492 [8:57:22<10:22:26, 157.58s/it]                                                        52%|█████▏    | 255/492 [8:57:22<10:22:26, 157.58s/it] 52%|█████▏    | 256/492 [8:59:17<9:29:22, 144.76s/it]  52%|█████▏    | 257/492 [9:01:12<8:51:35, 135.72s/it] 52%|█████▏    | 258/492 [9:03:06<8:24:39, 129.40s/it] 53%|█████▎    | 259/492 [9:05:01<8:05:03, 124.91s/it] 53%|█████▎    | 260/492 [9:06:56<7:51:10, 121.86s/it]                                                       53%|█████▎    | 260/492 [9:06:56<7:51:10, 121.86s/it] 53%|█████▎    | 261/492 [9:08:51<7:41:25, 119.85s/it] 53%|█████▎    | 262/492 [9:10:46<7:33:47, 118.38s/it] 53%|█████▎    | 263/492 [9:12:40<7:27:36, 117.28s/it] 54%|█████▎    | 264/492 [9:14:35<7:22:41, 116.50s/it] 54%|█████▍    | 265/492 [9:16:29<7:18:13, 115.83s/it]                                                       54%|█████▍    | 265/492 [9:16:29<7:18:13, 115.83s/it] 54%|█████▍    | 266/492 [9:18:24<7:15:07, 115.52s/it] 54%|█████▍    | 267/492 [9:20:19<7:12:26, 115.32s/it] 54%|█████▍    | 268/492 [9:22:14<7:09:38, 115.08s/it] 55%|█████▍    | 269/492 [9:24:08<7:07:29, 115.02s/it] 55%|█████▍    | 270/492 [9:26:03<7:05:25, 114.98s/it]                                                       55%|█████▍    | 270/492 [9:26:03<7:05:25, 114.98s/it] 55%|█████▌    | 271/492 [9:27:58<7:03:40, 115.03s/it] 55%|█████▌    | 272/492 [9:29:53<7:01:05, 114.84s/it] 55%|█████▌    | 273/492 [9:31:48<6:59:24, 114.91s/it] 56%|█████▌    | 274/492 [9:33:42<6:57:01, 114.78s/it] 56%|█████▌    | 275/492 [9:35:37<6:54:40, 114.66s/it]                                                       56%|█████▌    | 275/492 [9:35:37<6:54:40, 114.66s/it] 56%|█████▌    | 276/492 [9:37:32<6:52:52, 114.69s/it] 56%|█████▋    | 277/492 [9:39:26<6:50:47, 114.64s/it] 57%|█████▋    | 278/492 [9:41:20<6:48:35, 114.56s/it] 57%|█████▋    | 279/492 [9:43:15<6:46:28, 114.50s/it] 57%|█████▋    | 280/492 [9:45:09<6:44:39, 114.52s/it]                                                       57%|█████▋    | 280/492 [9:45:09<6:44:39, 114.52s/it] 57%|█████▋    | 281/492 [9:47:04<6:42:27, 114.44s/it] 57%|█████▋    | 282/492 [9:48:58<6:40:43, 114.49s/it] 58%|█████▊    | 283/492 [9:50:53<6:38:40, 114.45s/it] 58%|█████▊    | 284/492 [9:52:47<6:36:36, 114.41s/it] 58%|█████▊    | 285/492 [9:54:42<6:35:17, 114.58s/it]                                                       58%|█████▊    | 285/492 [9:54:42<6:35:17, 114.58s/it] 58%|█████▊    | 286/492 [9:56:36<6:32:55, 114.44s/it] 58%|█████▊    | 287/492 [9:58:31<6:31:11, 114.49s/it] 59%|█████▊    | 288/492 [10:00:25<6:29:33, 114.58s/it] 59%|█████▊    | 289/492 [10:02:19<6:27:05, 114.41s/it] 59%|█████▉    | 290/492 [10:04:14<6:25:48, 114.59s/it]                                                        59%|█████▉    | 290/492 [10:04:14<6:25:48, 114.59s/it] 59%|█████▉    | 291/492 [10:06:09<6:23:54, 114.60s/it] 59%|█████▉    | 292/492 [10:08:04<6:22:06, 114.63s/it] 60%|█████▉    | 293/492 [10:09:58<6:19:55, 114.55s/it] 60%|█████▉    | 294/492 [10:11:53<6:17:51, 114.50s/it] 60%|█████▉    | 295/492 [10:13:47<6:15:51, 114.48s/it]                                                        60%|█████▉    | 295/492 [10:13:47<6:15:51, 114.48s/it] 60%|██████    | 296/492 [10:15:42<6:14:40, 114.70s/it] 60%|██████    | 297/492 [10:17:36<6:12:06, 114.50s/it] 61%|██████    | 298/492 [10:19:31<6:10:15, 114.51s/it] 61%|██████    | 299/492 [10:21:26<6:08:49, 114.66s/it] 61%|██████    | 300/492 [10:23:20<6:06:32, 114.55s/it]                                                        61%|██████    | 300/492 [10:23:20<6:06:32, 114.55s/it]{'eval_loss': 0.09781802445650101, 'eval_runtime': 577.4371, 'eval_samples_per_second': 1.732, 'eval_steps_per_second': 0.216, 'epoch': 2.03}
{'loss': 0.0915, 'grad_norm': 0.04870203882455826, 'learning_rate': 5.567389211245485e-05, 'epoch': 2.07}
{'loss': 0.0863, 'grad_norm': 0.05594008415937424, 'learning_rate': 5.390524012629824e-05, 'epoch': 2.11}
{'loss': 0.0931, 'grad_norm': 0.06335064023733139, 'learning_rate': 5.2131656433338506e-05, 'epoch': 2.15}
{'loss': 0.1013, 'grad_norm': 0.06813333183526993, 'learning_rate': 5.035538079207488e-05, 'epoch': 2.19}
{'loss': 0.0889, 'grad_norm': 0.054481592029333115, 'learning_rate': 4.857865636051585e-05, 'epoch': 2.23}
{'loss': 0.0873, 'grad_norm': 0.06014859676361084, 'learning_rate': 4.6803726863421725e-05, 'epoch': 2.27}
{'loss': 0.0825, 'grad_norm': 0.09669474512338638, 'learning_rate': 4.503283375883165e-05, 'epoch': 2.31}
{'loss': 0.0862, 'grad_norm': 0.0704524964094162, 'learning_rate': 4.326821340745304e-05, 'epoch': 2.36}
{'loss': 0.0835, 'grad_norm': 0.05738632380962372, 'learning_rate': 4.151209424848819e-05, 'epoch': 2.4}
{'loss': 0.0887, 'grad_norm': 0.06273756176233292, 'learning_rate': 3.976669398546451e-05, 'epoch': 2.44}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:43,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:40,  3.28s/it][A
  3%|▎         | 4/125 [00:13<07:36,  3.77s/it][A
  4%|▍         | 5/125 [00:18<08:10,  4.09s/it][A
  5%|▍         | 6/125 [00:23<08:27,  4.26s/it][A
  6%|▌         | 7/125 [00:28<08:37,  4.38s/it][A
  6%|▋         | 8/125 [00:32<08:40,  4.45s/it][A
  7%|▋         | 9/125 [00:36<08:40,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:41,  4.54s/it][A
  9%|▉         | 11/125 [00:46<08:41,  4.57s/it][A
 10%|▉         | 12/125 [00:50<08:37,  4.58s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [01:00<08:29,  4.59s/it][A
 12%|█▏        | 15/125 [01:04<08:24,  4.59s/it][A
 13%|█▎        | 16/125 [01:09<08:21,  4.60s/it][A
 14%|█▎        | 17/125 [01:13<08:17,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.62s/it][A
 15%|█▌        | 19/125 [01:23<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:04,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:58,  4.60s/it][A
 18%|█▊        | 22/125 [01:36<07:53,  4.59s/it][A
 18%|█▊        | 23/125 [01:41<07:47,  4.59s/it][A
 19%|█▉        | 24/125 [01:46<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:44,  4.64s/it][A
 21%|██        | 26/125 [01:55<07:41,  4.66s/it][A
 22%|██▏       | 27/125 [02:00<07:34,  4.64s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:23,  4.62s/it][A
 24%|██▍       | 30/125 [02:13<07:17,  4.60s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:03,  4.60s/it][A
 27%|██▋       | 34/125 [02:32<06:58,  4.59s/it][A
 28%|██▊       | 35/125 [02:36<06:53,  4.59s/it][A
 29%|██▉       | 36/125 [02:41<06:49,  4.60s/it][A
 30%|██▉       | 37/125 [02:46<06:44,  4.59s/it][A
 30%|███       | 38/125 [02:50<06:39,  4.59s/it][A
 31%|███       | 39/125 [02:55<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.60s/it][A
 33%|███▎      | 41/125 [03:04<06:28,  4.63s/it][A
 34%|███▎      | 42/125 [03:09<06:23,  4.62s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.61s/it][A
 36%|███▌      | 45/125 [03:23<06:10,  4.64s/it][A
 37%|███▋      | 46/125 [03:27<06:04,  4.62s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:54,  4.61s/it][A
 39%|███▉      | 49/125 [03:41<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:46<05:45,  4.61s/it][A
 41%|████      | 51/125 [03:50<05:41,  4.61s/it][A
 42%|████▏     | 52/125 [03:55<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:59<05:32,  4.61s/it][A
 43%|████▎     | 54/125 [04:04<05:27,  4.62s/it][A
 44%|████▍     | 55/125 [04:09<05:23,  4.62s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:13,  4.62s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.63s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:32<04:59,  4.61s/it][A
 49%|████▉     | 61/125 [04:36<04:54,  4.60s/it][A
 50%|████▉     | 62/125 [04:41<04:49,  4.60s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [04:59<04:32,  4.63s/it][A
 54%|█████▎    | 67/125 [05:04<04:27,  4.61s/it][A
 54%|█████▍    | 68/125 [05:09<04:22,  4.61s/it][A
 55%|█████▌    | 69/125 [05:13<04:17,  4.60s/it][A
 56%|█████▌    | 70/125 [05:18<04:13,  4.61s/it][A
 57%|█████▋    | 71/125 [05:22<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:05,  4.63s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.63s/it][A
 59%|█████▉    | 74/125 [05:37<03:58,  4.67s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:50<03:42,  4.63s/it][A
 62%|██████▏   | 78/125 [05:55<03:37,  4.62s/it][A
 63%|██████▎   | 79/125 [06:00<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:04<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:09<03:23,  4.62s/it][A
 66%|██████▌   | 82/125 [06:13<03:18,  4.61s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.60s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.61s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.61s/it][A
 70%|██████▉   | 87/125 [06:36<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:50,  4.62s/it][A
 71%|███████   | 89/125 [06:46<02:46,  4.62s/it][A
 72%|███████▏  | 90/125 [06:50<02:40,  4.60s/it][A
 73%|███████▎  | 91/125 [06:55<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [06:59<02:31,  4.58s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:22,  4.60s/it][A
 76%|███████▌  | 95/125 [07:13<02:18,  4.61s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.60s/it][A
 78%|███████▊  | 97/125 [07:22<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.60s/it][A
 79%|███████▉  | 99/125 [07:32<01:59,  4.59s/it][A
 80%|████████  | 100/125 [07:36<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:45<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:50<01:42,  4.64s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [07:59<01:32,  4.62s/it][A
 85%|████████▍ | 106/125 [08:04<01:27,  4.61s/it][A
 86%|████████▌ | 107/125 [08:09<01:22,  4.60s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.60s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.61s/it][A
 88%|████████▊ | 110/125 [08:22<01:09,  4.60s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.59s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.62s/it][A
 92%|█████████▏| 115/125 [08:45<00:46,  4.63s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.63s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [08:59<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.62s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.61s/it][A
 97%|█████████▋| 121/125 [09:13<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.62s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.64s/it][A
 99%|█████████▉| 124/125 [09:27<00:04,  4.64s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A                                                       
                                                 [A 61%|██████    | 300/492 [10:32:57<6:06:32, 114.55s/it]
100%|██████████| 125/125 [09:32<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-300)... {'eval_loss': 0.09393562376499176, 'eval_runtime': 576.8653, 'eval_samples_per_second': 1.734, 'eval_steps_per_second': 0.217, 'epoch': 2.44}
Traceback (most recent call last):
  File "/workspace/model_training/deepseek_prover_sft_no_err/main.py", line 294, in <module>
    finetune(train_split=args.train_split,
  File "/workspace/model_training/deepseek_prover_sft_no_err/main.py", line 176, in finetune
    trainer.train()
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 1948, in train
    return inner_training_loop(
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 2366, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 2818, in _maybe_log_save_evaluate
    self.control = self.callback_handler.on_save(self.args, self.state, self.control)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer_callback.py", line 496, in on_save
    return self.call_event("on_save", args, state, control)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer_callback.py", line 507, in call_event
    result = getattr(callback, event)(
  File "/workspace/venv/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 980, in on_save
    artifact.add_dir(artifact_path)
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1256, in add_dir
    pool.map(add_manifest_file, paths)
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1247, in add_manifest_file
    self._add_local_file(
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1461, in _add_local_file
    shutil.copyfile(path, staging_path)
  File "/usr/lib/python3.10/shutil.py", line 267, in copyfile
    _fastcopy_sendfile(fsrc, fdst)
  File "/usr/lib/python3.10/shutil.py", line 156, in _fastcopy_sendfile
    raise err from None
  File "/usr/lib/python3.10/shutil.py", line 142, in _fastcopy_sendfile
    sent = os.sendfile(outfd, infd, offset, blocksize)
OSError: [Errno 28] No space left on device: 'model_training/deepseek_prover_sft_no_err/checkpoints-random-09-07-09-00/checkpoint-300/adapter_model.safetensors' -> '/root/.local/share/wandb/artifacts/staging/tmpa952ljp9'
wandb: - 15956.146 MB of 15956.146 MB uploaded (17.633 MB deduped)wandb: \ 15956.146 MB of 15956.178 MB uploaded (17.633 MB deduped)wandb: | 15956.178 MB of 15956.178 MB uploaded (17.633 MB deduped)wandb: 
wandb: Run history:
wandb:               eval/loss █▅▄▃▂▁
wandb:            eval/runtime ▆▄▆▇█▁
wandb: eval/samples_per_second ▁▅▁▁▁█
wandb:   eval/steps_per_second ████▁█
wandb:             train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm █▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     train/learning_rate ▁▂▃▄▆▆██████████▇▇▇▇▇▇▇▇▆▆▆▆▆▅▅▅▅▅▄▄▄▄▄▃
wandb:              train/loss █▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:               eval/loss 0.09394
wandb:            eval/runtime 576.8653
wandb: eval/samples_per_second 1.734
wandb:   eval/steps_per_second 0.217
wandb:             train/epoch 2.43655
wandb:       train/global_step 300
wandb:         train/grad_norm 0.06274
wandb:     train/learning_rate 4e-05
wandb:              train/loss 0.0887
wandb: 
wandb: 🚀 View run deepseek_prover_sft_no_err-random-09-07-09-00 at: https://wandb.ai/tcwong/decoder/runs/exnotmv9
wandb: ⭐️ View project at: https://wandb.ai/tcwong/decoder
wandb: Synced 5 W&B file(s), 0 media file(s), 56 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240907_090055-exnotmv9/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x7efbfeb4bac0>
Traceback (most recent call last):
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
    fp16_matmul._update_autotune_table()
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    cache_manager.put(autotune_table)
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    with FileLock(self.lock_path):
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_api.py", line 376, in __enter__
    self.acquire()
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_api.py", line 332, in acquire
    self._acquire()
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_unix.py", line 42, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/tmp/torchinductor_root/triton/0/Fp16Matmul_2d_kernel.pickle.lock'
