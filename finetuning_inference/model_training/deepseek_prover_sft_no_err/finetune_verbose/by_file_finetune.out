nohup: ignoring input
Finetuning starting.
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]Downloading shards:  50%|█████     | 1/2 [01:22<01:22, 82.21s/it]Downloading shards: 100%|██████████| 2/2 [02:08<00:00, 61.04s/it]Downloading shards: 100%|██████████| 2/2 [02:08<00:00, 64.21s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.90s/it]
trainable params: 10,644,480 || all params: 6,901,373,952 || trainable%: 0.1542
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 7876 examples [00:00, 13538.56 examples/s]Generating train split: 7876 examples [00:00, 13368.62 examples/s]
Generating valid split: 0 examples [00:00, ? examples/s]Generating valid split: 1000 examples [00:00, 9544.68 examples/s]Generating valid split: 1000 examples [00:00, 9408.72 examples/s]
Map:   0%|          | 0/7876 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7876 [00:01<00:07, 972.24 examples/s]Map:  25%|██▌       | 2000/7876 [00:02<00:05, 989.56 examples/s]Map:  38%|███▊      | 3000/7876 [00:03<00:04, 1003.97 examples/s]Map:  51%|█████     | 4000/7876 [00:03<00:03, 1010.15 examples/s]Map:  63%|██████▎   | 5000/7876 [00:04<00:02, 1003.42 examples/s]Map:  76%|███████▌  | 6000/7876 [00:05<00:01, 1006.31 examples/s]Map:  89%|████████▉ | 7000/7876 [00:06<00:00, 1008.89 examples/s]Map: 100%|██████████| 7876/7876 [00:07<00:00, 989.31 examples/s] Map: 100%|██████████| 7876/7876 [00:07<00:00, 995.18 examples/s]
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1016.84 examples/s]Map: 100%|██████████| 1000/1000 [00:01<00:00, 994.03 examples/s] 
[2024-09-07 09:01:05,607] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
df: /root/.triton/autotune: No such file or directory
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
wandb: Currently logged in as: tcwong. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.7
wandb: Run data is saved locally in /workspace/wandb/run-20240907_090121-1zf05eyd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deepseek_prover_sft_no_err-by_file-09-07-09-00
wandb: ⭐️ View project at https://wandb.ai/tcwong/decoder
wandb: 🚀 View run at https://wandb.ai/tcwong/decoder/runs/1zf05eyd
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
  0%|          | 0/492 [00:00<?, ?it/s]W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0] Graph break from `Tensor.item()`, consider setting:
W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0]     torch._dynamo.config.capture_scalar_outputs = True
W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0] or:
W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0] to include these operations in the captured graph.
W0907 09:01:36.285000 130333982400512 torch/_dynamo/variables/tensor.py:715] [17/0] 
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/492 [02:27<20:08:04, 147.63s/it]  0%|          | 2/492 [04:17<17:05:15, 125.54s/it]  1%|          | 3/492 [06:12<16:22:24, 120.54s/it]  1%|          | 4/492 [08:06<16:00:08, 118.05s/it]  1%|          | 5/492 [10:00<15:46:44, 116.64s/it]                                                     1%|          | 5/492 [10:00<15:46:44, 116.64s/it]  1%|          | 6/492 [11:54<15:38:05, 115.81s/it]  1%|▏         | 7/492 [13:48<15:30:43, 115.14s/it]  2%|▏         | 8/492 [15:43<15:27:33, 114.99s/it]  2%|▏         | 9/492 [17:37<15:24:07, 114.80s/it]  2%|▏         | 10/492 [19:31<15:20:02, 114.53s/it]                                                      2%|▏         | 10/492 [19:31<15:20:02, 114.53s/it]  2%|▏         | 11/492 [21:26<15:19:49, 114.74s/it]  2%|▏         | 12/492 [23:20<15:15:47, 114.47s/it]  3%|▎         | 13/492 [25:15<15:13:46, 114.46s/it]  3%|▎         | 14/492 [27:09<15:12:26, 114.53s/it]  3%|▎         | 15/492 [29:03<15:08:40, 114.30s/it]                                                      3%|▎         | 15/492 [29:03<15:08:40, 114.30s/it]  3%|▎         | 16/492 [30:57<15:06:39, 114.28s/it]  3%|▎         | 17/492 [32:51<15:04:03, 114.20s/it]  4%|▎         | 18/492 [34:46<15:02:29, 114.24s/it]  4%|▍         | 19/492 [36:40<15:01:14, 114.32s/it]  4%|▍         | 20/492 [38:34<14:59:09, 114.30s/it]                                                      4%|▍         | 20/492 [38:34<14:59:09, 114.30s/it]  4%|▍         | 21/492 [40:29<14:57:35, 114.34s/it]  4%|▍         | 22/492 [42:23<14:55:26, 114.31s/it]  5%|▍         | 23/492 [44:17<14:53:18, 114.28s/it]  5%|▍         | 24/492 [46:12<14:52:10, 114.38s/it]  5%|▌         | 25/492 [48:06<14:50:05, 114.36s/it]                                                      5%|▌         | 25/492 [48:06<14:50:05, 114.36s/it]  5%|▌         | 26/492 [50:01<14:48:38, 114.42s/it]  5%|▌         | 27/492 [51:55<14:47:13, 114.48s/it]  6%|▌         | 28/492 [53:50<14:45:31, 114.51s/it]  6%|▌         | 29/492 [55:45<14:44:20, 114.60s/it]  6%|▌         | 30/492 [57:39<14:41:48, 114.52s/it]                                                      6%|▌         | 30/492 [57:39<14:41:48, 114.52s/it]  6%|▋         | 31/492 [59:33<14:38:26, 114.33s/it]  7%|▋         | 32/492 [1:01:27<14:36:29, 114.33s/it]  7%|▋         | 33/492 [1:03:22<14:35:17, 114.42s/it]  7%|▋         | 34/492 [1:05:16<14:33:20, 114.41s/it]  7%|▋         | 35/492 [1:07:11<14:31:15, 114.39s/it]                                                        7%|▋         | 35/492 [1:07:11<14:31:15, 114.39s/it]  7%|▋         | 36/492 [1:09:05<14:29:28, 114.41s/it]  8%|▊         | 37/492 [1:10:59<14:26:49, 114.31s/it]  8%|▊         | 38/492 [1:12:54<14:25:17, 114.36s/it]  8%|▊         | 39/492 [1:14:48<14:22:44, 114.27s/it]  8%|▊         | 40/492 [1:16:42<14:21:48, 114.40s/it]                                                        8%|▊         | 40/492 [1:16:42<14:21:48, 114.40s/it]  8%|▊         | 41/492 [1:18:37<14:19:18, 114.32s/it]  9%|▊         | 42/492 [1:20:31<14:16:55, 114.26s/it]  9%|▊         | 43/492 [1:22:25<14:15:41, 114.35s/it]  9%|▉         | 44/492 [1:24:20<14:13:58, 114.37s/it]  9%|▉         | 45/492 [1:26:14<14:11:55, 114.35s/it]                                                        9%|▉         | 45/492 [1:26:14<14:11:55, 114.35s/it]  9%|▉         | 46/492 [1:28:08<14:09:41, 114.31s/it] 10%|▉         | 47/492 [1:30:03<14:09:08, 114.49s/it] 10%|▉         | 48/492 [1:31:58<14:07:29, 114.53s/it] 10%|▉         | 49/492 [1:33:52<14:05:25, 114.50s/it] 10%|█         | 50/492 [1:35:46<14:02:53, 114.42s/it]                                                       10%|█         | 50/492 [1:35:46<14:02:53, 114.42s/it]{'loss': 12.7608, 'grad_norm': 90.72683715820312, 'learning_rate': 1e-05, 'epoch': 0.04}
{'loss': 9.7379, 'grad_norm': 64.71466827392578, 'learning_rate': 2e-05, 'epoch': 0.08}
{'loss': 4.8295, 'grad_norm': 72.4654312133789, 'learning_rate': 3e-05, 'epoch': 0.12}
{'loss': 0.7192, 'grad_norm': 0.33800482749938965, 'learning_rate': 4e-05, 'epoch': 0.16}
{'loss': 0.1739, 'grad_norm': 0.41024672985076904, 'learning_rate': 5e-05, 'epoch': 0.2}
{'loss': 0.1757, 'grad_norm': 7.3582916259765625, 'learning_rate': 6e-05, 'epoch': 0.24}
{'loss': 0.15, 'grad_norm': 0.308156818151474, 'learning_rate': 7e-05, 'epoch': 0.28}
{'loss': 0.1439, 'grad_norm': 0.22839659452438354, 'learning_rate': 8e-05, 'epoch': 0.32}
{'loss': 0.1336, 'grad_norm': 0.9331194162368774, 'learning_rate': 9e-05, 'epoch': 0.37}
{'loss': 0.1352, 'grad_norm': 0.13771598041057587, 'learning_rate': 0.0001, 'epoch': 0.41}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:23,  2.14s/it][A
  2%|▏         | 3/125 [00:08<06:23,  3.14s/it][A
  3%|▎         | 4/125 [00:13<07:23,  3.67s/it][A
  4%|▍         | 5/125 [00:17<07:56,  3.97s/it][A
  5%|▍         | 6/125 [00:22<08:17,  4.18s/it][A
  6%|▌         | 7/125 [00:27<08:28,  4.31s/it][A
  6%|▋         | 8/125 [00:31<08:33,  4.39s/it][A
  7%|▋         | 9/125 [00:36<08:38,  4.47s/it][A
  8%|▊         | 10/125 [00:40<08:37,  4.50s/it][A
  9%|▉         | 11/125 [00:45<08:36,  4.53s/it][A
 10%|▉         | 12/125 [00:50<08:33,  4.54s/it][A
 10%|█         | 13/125 [00:54<08:31,  4.56s/it][A
 11%|█         | 14/125 [00:59<08:31,  4.61s/it][A
 12%|█▏        | 15/125 [01:04<08:27,  4.61s/it][A
 13%|█▎        | 16/125 [01:08<08:22,  4.61s/it][A
 14%|█▎        | 17/125 [01:13<08:17,  4.60s/it][A
 14%|█▍        | 18/125 [01:17<08:12,  4.60s/it][A
 15%|█▌        | 19/125 [01:22<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:26<08:02,  4.59s/it][A
 17%|█▋        | 21/125 [01:31<07:58,  4.60s/it][A
 18%|█▊        | 22/125 [01:36<07:54,  4.60s/it][A
 18%|█▊        | 23/125 [01:40<07:49,  4.61s/it][A
 19%|█▉        | 24/125 [01:45<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:42,  4.62s/it][A
 21%|██        | 26/125 [01:54<07:35,  4.60s/it][A
 22%|██▏       | 27/125 [01:59<07:31,  4.61s/it][A
 22%|██▏       | 28/125 [02:03<07:26,  4.61s/it][A
 23%|██▎       | 29/125 [02:08<07:21,  4.60s/it][A
 24%|██▍       | 30/125 [02:13<07:18,  4.62s/it][A
 25%|██▍       | 31/125 [02:17<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:22<07:07,  4.60s/it][A
 26%|██▋       | 33/125 [02:26<07:04,  4.61s/it][A
 27%|██▋       | 34/125 [02:31<07:00,  4.62s/it][A
 28%|██▊       | 35/125 [02:36<06:54,  4.61s/it][A
 29%|██▉       | 36/125 [02:40<06:49,  4.61s/it][A
 30%|██▉       | 37/125 [02:45<06:45,  4.61s/it][A
 30%|███       | 38/125 [02:49<06:40,  4.60s/it][A
 31%|███       | 39/125 [02:54<06:35,  4.59s/it][A
 32%|███▏      | 40/125 [02:59<06:30,  4.60s/it][A
 33%|███▎      | 41/125 [03:03<06:25,  4.59s/it][A
 34%|███▎      | 42/125 [03:08<06:20,  4.58s/it][A
 34%|███▍      | 43/125 [03:12<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:17<06:12,  4.59s/it][A
 36%|███▌      | 45/125 [03:22<06:07,  4.59s/it][A
 37%|███▋      | 46/125 [03:26<06:02,  4.59s/it][A
 38%|███▊      | 47/125 [03:31<05:57,  4.59s/it][A
 38%|███▊      | 48/125 [03:35<05:54,  4.61s/it][A
 39%|███▉      | 49/125 [03:40<05:50,  4.61s/it][A
 40%|████      | 50/125 [03:45<05:46,  4.62s/it][A
 41%|████      | 51/125 [03:49<05:43,  4.64s/it][A
 42%|████▏     | 52/125 [03:54<05:40,  4.66s/it][A
 42%|████▏     | 53/125 [03:59<05:34,  4.64s/it][A
 43%|████▎     | 54/125 [04:03<05:28,  4.62s/it][A
 44%|████▍     | 55/125 [04:08<05:23,  4.62s/it][A
 45%|████▍     | 56/125 [04:12<05:18,  4.61s/it][A
 46%|████▌     | 57/125 [04:17<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:22<05:09,  4.62s/it][A
 47%|████▋     | 59/125 [04:26<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:31<04:59,  4.61s/it][A
 49%|████▉     | 61/125 [04:36<04:55,  4.62s/it][A
 50%|████▉     | 62/125 [04:40<04:50,  4.61s/it][A
 50%|█████     | 63/125 [04:45<04:45,  4.61s/it][A
 51%|█████     | 64/125 [04:49<04:41,  4.61s/it][A
 52%|█████▏    | 65/125 [04:54<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [04:58<04:30,  4.59s/it][A
 54%|█████▎    | 67/125 [05:03<04:25,  4.58s/it][A
 54%|█████▍    | 68/125 [05:08<04:21,  4.58s/it][A
 55%|█████▌    | 69/125 [05:12<04:16,  4.58s/it][A
 56%|█████▌    | 70/125 [05:17<04:11,  4.58s/it][A
 57%|█████▋    | 71/125 [05:21<04:08,  4.60s/it][A
 58%|█████▊    | 72/125 [05:26<04:03,  4.59s/it][A
 58%|█████▊    | 73/125 [05:31<03:59,  4.61s/it][A
 59%|█████▉    | 74/125 [05:35<03:55,  4.62s/it][A
 60%|██████    | 75/125 [05:40<03:52,  4.64s/it][A
 61%|██████    | 76/125 [05:45<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:49<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:54<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [05:59<03:33,  4.65s/it][A
 64%|██████▍   | 80/125 [06:03<03:29,  4.66s/it][A
 65%|██████▍   | 81/125 [06:08<03:24,  4.65s/it][A
 66%|██████▌   | 82/125 [06:12<03:19,  4.63s/it][A
 66%|██████▋   | 83/125 [06:17<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:22<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:26<03:03,  4.59s/it][A
 69%|██████▉   | 86/125 [06:31<02:58,  4.59s/it][A
 70%|██████▉   | 87/125 [06:35<02:54,  4.60s/it][A
 70%|███████   | 88/125 [06:40<02:51,  4.63s/it][A
 71%|███████   | 89/125 [06:45<02:46,  4.64s/it][A
 72%|███████▏  | 90/125 [06:49<02:41,  4.62s/it][A
 73%|███████▎  | 91/125 [06:54<02:37,  4.63s/it][A
 74%|███████▎  | 92/125 [06:59<02:32,  4.61s/it][A
 74%|███████▍  | 93/125 [07:03<02:26,  4.59s/it][A
 75%|███████▌  | 94/125 [07:08<02:23,  4.61s/it][A
 76%|███████▌  | 95/125 [07:12<02:19,  4.63s/it][A
 77%|███████▋  | 96/125 [07:17<02:13,  4.61s/it][A
 78%|███████▊  | 97/125 [07:22<02:08,  4.60s/it][A
 78%|███████▊  | 98/125 [07:26<02:04,  4.60s/it][A
 79%|███████▉  | 99/125 [07:31<01:59,  4.61s/it][A
 80%|████████  | 100/125 [07:35<01:54,  4.59s/it][A
 81%|████████  | 101/125 [07:40<01:50,  4.59s/it][A
 82%|████████▏ | 102/125 [07:45<01:45,  4.60s/it][A
 82%|████████▏ | 103/125 [07:49<01:41,  4.62s/it][A
 83%|████████▎ | 104/125 [07:54<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [07:59<01:32,  4.65s/it][A
 85%|████████▍ | 106/125 [08:03<01:28,  4.63s/it][A
 86%|████████▌ | 107/125 [08:08<01:23,  4.63s/it][A
 86%|████████▋ | 108/125 [08:12<01:18,  4.64s/it][A
 87%|████████▋ | 109/125 [08:17<01:13,  4.62s/it][A
 88%|████████▊ | 110/125 [08:22<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:26<01:04,  4.61s/it][A
 90%|████████▉ | 112/125 [08:31<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:35<00:55,  4.61s/it][A
 91%|█████████ | 114/125 [08:40<00:50,  4.59s/it][A
 92%|█████████▏| 115/125 [08:45<00:46,  4.60s/it][A
 93%|█████████▎| 116/125 [08:49<00:41,  4.60s/it][A
 94%|█████████▎| 117/125 [08:54<00:36,  4.62s/it][A
 94%|█████████▍| 118/125 [08:59<00:32,  4.62s/it][A
 95%|█████████▌| 119/125 [09:03<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:08<00:23,  4.61s/it][A
 97%|█████████▋| 121/125 [09:12<00:18,  4.61s/it][A
 98%|█████████▊| 122/125 [09:17<00:13,  4.59s/it][A
 98%|█████████▊| 123/125 [09:22<00:09,  4.61s/it][A
 99%|█████████▉| 124/125 [09:26<00:04,  4.62s/it][A
100%|██████████| 125/125 [09:31<00:00,  4.62s/it][A                                                      
                                                 [A 10%|█         | 50/492 [1:45:23<14:02:53, 114.42s/it]
100%|██████████| 125/125 [09:31<00:00,  4.62s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-50)... Done. 10.4s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 10%|█         | 51/492 [1:47:39<36:00:44, 293.98s/it] 11%|█         | 52/492 [1:49:33<29:20:02, 240.01s/it] 11%|█         | 53/492 [1:51:27<24:39:11, 202.17s/it] 11%|█         | 54/492 [1:53:22<21:23:43, 175.85s/it] 11%|█         | 55/492 [1:55:16<19:05:22, 157.26s/it]                                                       11%|█         | 55/492 [1:55:16<19:05:22, 157.26s/it] 11%|█▏        | 56/492 [1:57:10<17:29:06, 144.37s/it] 12%|█▏        | 57/492 [1:59:04<16:21:11, 135.34s/it] 12%|█▏        | 58/492 [2:00:58<15:33:07, 129.00s/it] 12%|█▏        | 59/492 [2:02:53<14:59:09, 124.59s/it] 12%|█▏        | 60/492 [2:04:47<14:34:26, 121.45s/it]                                                       12%|█▏        | 60/492 [2:04:47<14:34:26, 121.45s/it] 12%|█▏        | 61/492 [2:06:41<14:16:36, 119.25s/it] 13%|█▎        | 62/492 [2:08:35<14:03:20, 117.67s/it] 13%|█▎        | 63/492 [2:10:29<13:54:09, 116.67s/it] 13%|█▎        | 64/492 [2:12:24<13:47:24, 115.99s/it] 13%|█▎        | 65/492 [2:14:19<13:43:05, 115.66s/it]                                                       13%|█▎        | 65/492 [2:14:19<13:43:05, 115.66s/it] 13%|█▎        | 66/492 [2:16:13<13:38:50, 115.33s/it] 14%|█▎        | 67/492 [2:18:08<13:36:23, 115.26s/it] 14%|█▍        | 68/492 [2:20:03<13:32:33, 114.98s/it] 14%|█▍        | 69/492 [2:21:57<13:29:45, 114.86s/it] 14%|█▍        | 70/492 [2:23:51<13:26:48, 114.71s/it]                                                       14%|█▍        | 70/492 [2:23:51<13:26:48, 114.71s/it] 14%|█▍        | 71/492 [2:25:46<13:24:04, 114.60s/it] 15%|█▍        | 72/492 [2:27:41<13:22:48, 114.69s/it] 15%|█▍        | 73/492 [2:29:35<13:20:06, 114.57s/it] 15%|█▌        | 74/492 [2:31:30<13:18:20, 114.59s/it] 15%|█▌        | 75/492 [2:33:24<13:15:41, 114.49s/it]                                                       15%|█▌        | 75/492 [2:33:24<13:15:41, 114.49s/it] 15%|█▌        | 76/492 [2:35:18<13:13:38, 114.47s/it] 16%|█▌        | 77/492 [2:37:12<13:10:35, 114.30s/it] 16%|█▌        | 78/492 [2:39:07<13:09:01, 114.35s/it] 16%|█▌        | 79/492 [2:41:01<13:06:52, 114.32s/it] 16%|█▋        | 80/492 [2:42:56<13:05:42, 114.42s/it]                                                       16%|█▋        | 80/492 [2:42:56<13:05:42, 114.42s/it] 16%|█▋        | 81/492 [2:44:49<13:02:27, 114.23s/it] 17%|█▋        | 82/492 [2:46:44<13:01:40, 114.39s/it] 17%|█▋        | 83/492 [2:48:38<12:58:57, 114.27s/it] 17%|█▋        | 84/492 [2:50:33<12:57:14, 114.30s/it] 17%|█▋        | 85/492 [2:52:27<12:55:45, 114.36s/it]                                                       17%|█▋        | 85/492 [2:52:27<12:55:45, 114.36s/it] 17%|█▋        | 86/492 [2:54:21<12:53:48, 114.36s/it] 18%|█▊        | 87/492 [2:56:16<12:52:12, 114.40s/it] 18%|█▊        | 88/492 [2:58:10<12:49:56, 114.35s/it] 18%|█▊        | 89/492 [3:00:04<12:47:15, 114.23s/it] 18%|█▊        | 90/492 [3:01:58<12:45:00, 114.18s/it]                                                       18%|█▊        | 90/492 [3:01:58<12:45:00, 114.18s/it] 18%|█▊        | 91/492 [3:03:52<12:42:28, 114.09s/it] 19%|█▊        | 92/492 [3:05:46<12:40:56, 114.14s/it] 19%|█▉        | 93/492 [3:07:41<12:40:09, 114.31s/it] 19%|█▉        | 94/492 [3:09:35<12:37:12, 114.15s/it] 19%|█▉        | 95/492 [3:11:29<12:35:12, 114.14s/it]                                                       19%|█▉        | 95/492 [3:11:29<12:35:12, 114.14s/it] 20%|█▉        | 96/492 [3:13:23<12:34:01, 114.25s/it] 20%|█▉        | 97/492 [3:15:17<12:31:38, 114.17s/it] 20%|█▉        | 98/492 [3:17:11<12:29:23, 114.12s/it] 20%|██        | 99/492 [3:19:05<12:27:25, 114.11s/it] 20%|██        | 100/492 [3:21:00<12:26:29, 114.26s/it]                                                        20%|██        | 100/492 [3:21:00<12:26:29, 114.26s/it]{'eval_loss': 0.14033491909503937, 'eval_runtime': 576.5709, 'eval_samples_per_second': 1.734, 'eval_steps_per_second': 0.217, 'epoch': 0.41}
{'loss': 0.1245, 'grad_norm': 0.04095697030425072, 'learning_rate': 9.996842891446092e-05, 'epoch': 0.45}
{'loss': 0.1208, 'grad_norm': 0.11559335142374039, 'learning_rate': 9.987375552718133e-05, 'epoch': 0.49}
{'loss': 0.1201, 'grad_norm': 0.10437008738517761, 'learning_rate': 9.971609939582557e-05, 'epoch': 0.53}
{'loss': 0.1317, 'grad_norm': 0.05311759188771248, 'learning_rate': 9.9495659615402e-05, 'epoch': 0.57}
{'loss': 0.1221, 'grad_norm': 0.07723415642976761, 'learning_rate': 9.921271456683715e-05, 'epoch': 0.61}
{'loss': 0.112, 'grad_norm': 0.040255699306726456, 'learning_rate': 9.886762156542428e-05, 'epoch': 0.65}
{'loss': 0.1086, 'grad_norm': 0.028574412688612938, 'learning_rate': 9.846081640959007e-05, 'epoch': 0.69}
{'loss': 0.1129, 'grad_norm': 0.041674137115478516, 'learning_rate': 9.79928128305494e-05, 'epoch': 0.73}
{'loss': 0.1096, 'grad_norm': 0.04879468306899071, 'learning_rate': 9.746420184354334e-05, 'epoch': 0.77}
{'loss': 0.1114, 'grad_norm': 0.03487968072295189, 'learning_rate': 9.687565100147939e-05, 'epoch': 0.81}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:47,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:36,  3.25s/it][A
  3%|▎         | 4/125 [00:13<07:32,  3.74s/it][A
  4%|▍         | 5/125 [00:18<08:02,  4.02s/it][A
  5%|▍         | 6/125 [00:22<08:21,  4.21s/it][A
  6%|▌         | 7/125 [00:27<08:30,  4.33s/it][A
  6%|▋         | 8/125 [00:32<08:35,  4.41s/it][A
  7%|▋         | 9/125 [00:36<08:39,  4.48s/it][A
  8%|▊         | 10/125 [00:41<08:38,  4.51s/it][A
  9%|▉         | 11/125 [00:45<08:36,  4.53s/it][A
 10%|▉         | 12/125 [00:50<08:33,  4.54s/it][A
 10%|█         | 13/125 [00:55<08:31,  4.57s/it][A
 11%|█         | 14/125 [00:59<08:31,  4.61s/it][A
 12%|█▏        | 15/125 [01:04<08:27,  4.61s/it][A
 13%|█▎        | 16/125 [01:08<08:22,  4.61s/it][A
 14%|█▎        | 17/125 [01:13<08:17,  4.60s/it][A
 14%|█▍        | 18/125 [01:18<08:12,  4.60s/it][A
 15%|█▌        | 19/125 [01:22<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:02,  4.59s/it][A
 17%|█▋        | 21/125 [01:31<07:58,  4.60s/it][A
 18%|█▊        | 22/125 [01:36<07:54,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:49,  4.61s/it][A
 19%|█▉        | 24/125 [01:45<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:41,  4.62s/it][A
 21%|██        | 26/125 [01:54<07:35,  4.60s/it][A
 22%|██▏       | 27/125 [01:59<07:31,  4.60s/it][A
 22%|██▏       | 28/125 [02:04<07:26,  4.60s/it][A
 23%|██▎       | 29/125 [02:08<07:21,  4.60s/it][A
 24%|██▍       | 30/125 [02:13<07:18,  4.62s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:22<07:07,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:04,  4.61s/it][A
 27%|██▋       | 34/125 [02:31<07:00,  4.62s/it][A
 28%|██▊       | 35/125 [02:36<06:55,  4.61s/it][A
 29%|██▉       | 36/125 [02:41<06:50,  4.61s/it][A
 30%|██▉       | 37/125 [02:45<06:45,  4.61s/it][A
 30%|███       | 38/125 [02:50<06:40,  4.60s/it][A
 31%|███       | 39/125 [02:54<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:30,  4.60s/it][A
 33%|███▎      | 41/125 [03:04<06:25,  4.59s/it][A
 34%|███▎      | 42/125 [03:08<06:20,  4.59s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.61s/it][A
 35%|███▌      | 44/125 [03:17<06:12,  4.60s/it][A
 36%|███▌      | 45/125 [03:22<06:07,  4.59s/it][A
 37%|███▋      | 46/125 [03:27<06:02,  4.59s/it][A
 38%|███▊      | 47/125 [03:31<05:58,  4.59s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.61s/it][A
 39%|███▉      | 49/125 [03:40<05:50,  4.62s/it][A
 40%|████      | 50/125 [03:45<05:46,  4.62s/it][A
 41%|████      | 51/125 [03:50<05:43,  4.64s/it][A
 42%|████▏     | 52/125 [03:54<05:40,  4.66s/it][A
 42%|████▏     | 53/125 [03:59<05:34,  4.65s/it][A
 43%|████▎     | 54/125 [04:04<05:28,  4.63s/it][A
 44%|████▍     | 55/125 [04:08<05:23,  4.62s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:22<05:09,  4.62s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:31<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:55,  4.62s/it][A
 50%|████▉     | 62/125 [04:41<04:50,  4.61s/it][A
 50%|█████     | 63/125 [04:45<04:45,  4.61s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.61s/it][A
 52%|█████▏    | 65/125 [04:54<04:36,  4.62s/it][A
 53%|█████▎    | 66/125 [04:59<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:25,  4.58s/it][A
 54%|█████▍    | 68/125 [05:08<04:21,  4.59s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.58s/it][A
 56%|█████▌    | 70/125 [05:17<04:12,  4.58s/it][A
 57%|█████▋    | 71/125 [05:22<04:08,  4.61s/it][A
 58%|█████▊    | 72/125 [05:26<04:03,  4.59s/it][A
 58%|█████▊    | 73/125 [05:31<03:59,  4.61s/it][A
 59%|█████▉    | 74/125 [05:36<03:55,  4.62s/it][A
 60%|██████    | 75/125 [05:40<03:52,  4.64s/it][A
 61%|██████    | 76/125 [05:45<03:47,  4.64s/it][A
 62%|██████▏   | 77/125 [05:50<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:54<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [05:59<03:33,  4.65s/it][A
 64%|██████▍   | 80/125 [06:04<03:29,  4.66s/it][A
 65%|██████▍   | 81/125 [06:08<03:24,  4.65s/it][A
 66%|██████▌   | 82/125 [06:13<03:19,  4.64s/it][A
 66%|██████▋   | 83/125 [06:18<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:22<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:27<03:03,  4.59s/it][A
 69%|██████▉   | 86/125 [06:31<02:58,  4.59s/it][A
 70%|██████▉   | 87/125 [06:36<02:55,  4.61s/it][A
 70%|███████   | 88/125 [06:41<02:51,  4.63s/it][A
 71%|███████   | 89/125 [06:45<02:46,  4.64s/it][A
 72%|███████▏  | 90/125 [06:50<02:41,  4.62s/it][A
 73%|███████▎  | 91/125 [06:54<02:37,  4.63s/it][A
 74%|███████▎  | 92/125 [06:59<02:32,  4.61s/it][A
 74%|███████▍  | 93/125 [07:04<02:26,  4.59s/it][A
 75%|███████▌  | 94/125 [07:08<02:23,  4.61s/it][A
 76%|███████▌  | 95/125 [07:13<02:19,  4.63s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.62s/it][A
 78%|███████▊  | 97/125 [07:22<02:08,  4.60s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.60s/it][A
 79%|███████▉  | 99/125 [07:31<01:59,  4.61s/it][A
 80%|████████  | 100/125 [07:36<01:54,  4.59s/it][A
 81%|████████  | 101/125 [07:40<01:50,  4.59s/it][A
 82%|████████▏ | 102/125 [07:45<01:45,  4.60s/it][A
 82%|████████▏ | 103/125 [07:50<01:41,  4.62s/it][A
 83%|████████▎ | 104/125 [07:54<01:37,  4.63s/it][A
 84%|████████▍ | 105/125 [07:59<01:32,  4.65s/it][A
 85%|████████▍ | 106/125 [08:04<01:28,  4.63s/it][A
 86%|████████▌ | 107/125 [08:08<01:23,  4.63s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.64s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.62s/it][A
 88%|████████▊ | 110/125 [08:22<01:09,  4.61s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.61s/it][A
 90%|████████▉ | 112/125 [08:31<00:59,  4.61s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.61s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.59s/it][A
 92%|█████████▏| 115/125 [08:45<00:46,  4.61s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.61s/it][A
 94%|█████████▎| 117/125 [08:54<00:36,  4.62s/it][A
 94%|█████████▍| 118/125 [08:59<00:32,  4.62s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:08<00:23,  4.61s/it][A
 97%|█████████▋| 121/125 [09:13<00:18,  4.61s/it][A
 98%|█████████▊| 122/125 [09:17<00:13,  4.59s/it][A
 98%|█████████▊| 123/125 [09:22<00:09,  4.61s/it][A
 99%|█████████▉| 124/125 [09:27<00:04,  4.62s/it][A
100%|██████████| 125/125 [09:31<00:00,  4.62s/it][A                                                       
                                                 [A 20%|██        | 100/492 [3:30:37<12:26:29, 114.26s/it]
100%|██████████| 125/125 [09:32<00:00,  4.62s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-100)... Done. 11.3s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 21%|██        | 101/492 [3:32:55<31:58:01, 294.33s/it] 21%|██        | 102/492 [3:34:48<26:01:12, 240.19s/it] 21%|██        | 103/492 [3:36:43<21:52:38, 202.46s/it] 21%|██        | 104/492 [3:38:37<18:58:41, 176.09s/it] 21%|██▏       | 105/492 [3:40:32<16:55:58, 157.52s/it]                                                        21%|██▏       | 105/492 [3:40:32<16:55:58, 157.52s/it] 22%|██▏       | 106/492 [3:42:26<15:30:32, 144.64s/it] 22%|██▏       | 107/492 [3:44:21<14:29:53, 135.57s/it] 22%|██▏       | 108/492 [3:46:15<13:46:28, 129.14s/it] 22%|██▏       | 109/492 [3:48:09<13:15:18, 124.59s/it] 22%|██▏       | 110/492 [3:50:04<12:54:55, 121.71s/it]                                                        22%|██▏       | 110/492 [3:50:04<12:54:55, 121.71s/it] 23%|██▎       | 111/492 [3:51:58<12:38:24, 119.43s/it] 23%|██▎       | 112/492 [3:53:52<12:26:58, 117.94s/it] 23%|██▎       | 113/492 [3:55:47<12:18:42, 116.95s/it] 23%|██▎       | 114/492 [3:57:41<12:11:36, 116.13s/it] 23%|██▎       | 115/492 [3:59:36<12:07:53, 115.84s/it]                                                        23%|██▎       | 115/492 [3:59:36<12:07:53, 115.84s/it] 24%|██▎       | 116/492 [4:01:31<12:03:15, 115.41s/it] 24%|██▍       | 117/492 [4:03:25<11:59:37, 115.14s/it] 24%|██▍       | 118/492 [4:05:19<11:55:45, 114.83s/it] 24%|██▍       | 119/492 [4:07:13<11:52:03, 114.54s/it] 24%|██▍       | 120/492 [4:09:07<11:49:34, 114.45s/it]                                                        24%|██▍       | 120/492 [4:09:07<11:49:34, 114.45s/it] 25%|██▍       | 121/492 [4:11:02<11:47:19, 114.39s/it] 25%|██▍       | 122/492 [4:12:56<11:45:39, 114.43s/it] 25%|██▌       | 123/492 [4:14:50<11:43:35, 114.40s/it]/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 25%|██▌       | 124/492 [4:16:53<11:57:10, 116.93s/it] 25%|██▌       | 125/492 [4:18:47<11:50:04, 116.09s/it]                                                        25%|██▌       | 125/492 [4:18:47<11:50:04, 116.09s/it] 26%|██▌       | 126/492 [4:20:42<11:44:26, 115.48s/it] 26%|██▌       | 127/492 [4:22:36<11:40:26, 115.14s/it] 26%|██▌       | 128/492 [4:24:30<11:37:17, 114.94s/it] 26%|██▌       | 129/492 [4:26:24<11:33:39, 114.65s/it] 26%|██▋       | 130/492 [4:28:19<11:31:17, 114.58s/it]                                                        26%|██▋       | 130/492 [4:28:19<11:31:17, 114.58s/it] 27%|██▋       | 131/492 [4:30:13<11:29:11, 114.55s/it] 27%|██▋       | 132/492 [4:32:08<11:26:52, 114.48s/it] 27%|██▋       | 133/492 [4:34:02<11:24:25, 114.39s/it] 27%|██▋       | 134/492 [4:35:56<11:21:58, 114.30s/it] 27%|██▋       | 135/492 [4:37:50<11:20:01, 114.29s/it]                                                        27%|██▋       | 135/492 [4:37:50<11:20:01, 114.29s/it] 28%|██▊       | 136/492 [4:39:44<11:17:52, 114.25s/it] 28%|██▊       | 137/492 [4:41:39<11:16:49, 114.39s/it] 28%|██▊       | 138/492 [4:43:33<11:14:58, 114.40s/it] 28%|██▊       | 139/492 [4:45:28<11:13:53, 114.54s/it] 28%|██▊       | 140/492 [4:47:23<11:11:46, 114.51s/it]                                                        28%|██▊       | 140/492 [4:47:23<11:11:46, 114.51s/it] 29%|██▊       | 141/492 [4:49:17<11:09:36, 114.46s/it] 29%|██▉       | 142/492 [4:51:11<11:07:00, 114.35s/it] 29%|██▉       | 143/492 [4:53:05<11:04:05, 114.17s/it] 29%|██▉       | 144/492 [4:54:59<11:03:00, 114.31s/it] 29%|██▉       | 145/492 [4:56:54<11:00:53, 114.28s/it]                                                        29%|██▉       | 145/492 [4:56:54<11:00:53, 114.28s/it] 30%|██▉       | 146/492 [4:58:47<10:57:57, 114.10s/it] 30%|██▉       | 147/492 [5:00:41<10:55:20, 113.97s/it] 30%|███       | 148/492 [5:02:35<10:53:29, 113.98s/it] 30%|███       | 149/492 [5:04:29<10:52:14, 114.09s/it] 30%|███       | 150/492 [5:06:24<10:51:49, 114.35s/it]                                                        30%|███       | 150/492 [5:06:24<10:51:49, 114.35s/it]{'eval_loss': 0.12282345443964005, 'eval_runtime': 576.5189, 'eval_samples_per_second': 1.735, 'eval_steps_per_second': 0.217, 'epoch': 0.81}
{'loss': 0.1084, 'grad_norm': 0.022248243913054466, 'learning_rate': 9.622790355191672e-05, 'epoch': 0.85}
{'loss': 0.1137, 'grad_norm': 0.028482923284173012, 'learning_rate': 9.552177749846083e-05, 'epoch': 0.89}
{'loss': 0.1128, 'grad_norm': 0.030047094449400902, 'learning_rate': 9.475816456775313e-05, 'epoch': 0.93}
{'loss': 0.1065, 'grad_norm': 0.024480503052473068, 'learning_rate': 9.393802908335977e-05, 'epoch': 0.97}
{'loss': 0.1136, 'grad_norm': 0.023714397102594376, 'learning_rate': 9.306240674798203e-05, 'epoch': 1.02}
{'loss': 0.1074, 'grad_norm': 0.028829872608184814, 'learning_rate': 9.213240333552589e-05, 'epoch': 1.06}
{'loss': 0.106, 'grad_norm': 0.02569424733519554, 'learning_rate': 9.114919329468282e-05, 'epoch': 1.1}
{'loss': 0.1105, 'grad_norm': 0.030071981251239777, 'learning_rate': 9.011401826578492e-05, 'epoch': 1.14}
{'loss': 0.0967, 'grad_norm': 0.02678651362657547, 'learning_rate': 8.902818551280758e-05, 'epoch': 1.18}
{'loss': 0.095, 'grad_norm': 0.034579597413539886, 'learning_rate': 8.789306627249985e-05, 'epoch': 1.22}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:37,  3.26s/it][A
  3%|▎         | 4/125 [00:13<07:32,  3.74s/it][A
  4%|▍         | 5/125 [00:18<08:03,  4.03s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.22s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.33s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.41s/it][A
  7%|▋         | 9/125 [00:36<08:40,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:39,  4.51s/it][A
  9%|▉         | 11/125 [00:45<08:37,  4.54s/it][A
 10%|▉         | 12/125 [00:50<08:33,  4.55s/it][A
 10%|█         | 13/125 [00:55<08:31,  4.57s/it][A
 11%|█         | 14/125 [00:59<08:31,  4.61s/it][A
 12%|█▏        | 15/125 [01:04<08:27,  4.62s/it][A
 13%|█▎        | 16/125 [01:09<08:22,  4.61s/it][A
 14%|█▎        | 17/125 [01:13<08:17,  4.60s/it][A
 14%|█▍        | 18/125 [01:18<08:12,  4.60s/it][A
 15%|█▌        | 19/125 [01:22<08:07,  4.60s/it][A
 16%|█▌        | 20/125 [01:27<08:02,  4.59s/it][A
 17%|█▋        | 21/125 [01:32<07:58,  4.60s/it][A
 18%|█▊        | 22/125 [01:36<07:54,  4.60s/it][A
 18%|█▊        | 23/125 [01:41<07:49,  4.60s/it][A
 19%|█▉        | 24/125 [01:45<07:45,  4.61s/it][A
 20%|██        | 25/125 [01:50<07:41,  4.62s/it][A
 21%|██        | 26/125 [01:55<07:35,  4.60s/it][A
 22%|██▏       | 27/125 [01:59<07:31,  4.60s/it][A
 22%|██▏       | 28/125 [02:04<07:26,  4.60s/it][A
 23%|██▎       | 29/125 [02:08<07:21,  4.60s/it][A
 24%|██▍       | 30/125 [02:13<07:18,  4.62s/it][A
 25%|██▍       | 31/125 [02:18<07:13,  4.61s/it][A
 26%|██▌       | 32/125 [02:22<07:07,  4.60s/it][A
 26%|██▋       | 33/125 [02:27<07:04,  4.61s/it][A
 27%|██▋       | 34/125 [02:31<07:00,  4.62s/it][A
 28%|██▊       | 35/125 [02:36<06:55,  4.61s/it][A
 29%|██▉       | 36/125 [02:41<06:50,  4.61s/it][A
 30%|██▉       | 37/125 [02:45<06:45,  4.61s/it][A
 30%|███       | 38/125 [02:50<06:40,  4.60s/it][A
 31%|███       | 39/125 [02:54<06:35,  4.59s/it][A
 32%|███▏      | 40/125 [02:59<06:30,  4.60s/it][A
 33%|███▎      | 41/125 [03:04<06:25,  4.59s/it][A
 34%|███▎      | 42/125 [03:08<06:20,  4.58s/it][A
 34%|███▍      | 43/125 [03:13<06:17,  4.61s/it][A
 35%|███▌      | 44/125 [03:17<06:12,  4.59s/it][A
 36%|███▌      | 45/125 [03:22<06:07,  4.59s/it][A
 37%|███▋      | 46/125 [03:27<06:02,  4.59s/it][A
 38%|███▊      | 47/125 [03:31<05:57,  4.59s/it][A
 38%|███▊      | 48/125 [03:36<05:54,  4.61s/it][A
 39%|███▉      | 49/125 [03:40<05:50,  4.62s/it][A
 40%|████      | 50/125 [03:45<05:46,  4.62s/it][A
 41%|████      | 51/125 [03:50<05:43,  4.64s/it][A
 42%|████▏     | 52/125 [03:54<05:40,  4.66s/it][A
 42%|████▏     | 53/125 [03:59<05:34,  4.64s/it][A
 43%|████▎     | 54/125 [04:04<05:28,  4.62s/it][A
 44%|████▍     | 55/125 [04:08<05:23,  4.62s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.61s/it][A
 46%|████▌     | 57/125 [04:17<05:14,  4.62s/it][A
 46%|████▋     | 58/125 [04:22<05:09,  4.62s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.61s/it][A
 48%|████▊     | 60/125 [04:31<04:59,  4.61s/it][A
 49%|████▉     | 61/125 [04:36<04:55,  4.62s/it][A
 50%|████▉     | 62/125 [04:41<04:50,  4.61s/it][A
 50%|█████     | 63/125 [04:45<04:45,  4.61s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.61s/it][A
 52%|█████▏    | 65/125 [04:54<04:36,  4.61s/it][A
 53%|█████▎    | 66/125 [04:59<04:30,  4.59s/it][A
 54%|█████▎    | 67/125 [05:03<04:25,  4.58s/it][A
 54%|█████▍    | 68/125 [05:08<04:21,  4.58s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.58s/it][A
 56%|█████▌    | 70/125 [05:17<04:12,  4.58s/it][A
 57%|█████▋    | 71/125 [05:22<04:08,  4.60s/it][A
 58%|█████▊    | 72/125 [05:26<04:03,  4.59s/it][A
 58%|█████▊    | 73/125 [05:31<03:59,  4.61s/it][A
 59%|█████▉    | 74/125 [05:36<03:55,  4.62s/it][A
 60%|██████    | 75/125 [05:40<03:52,  4.64s/it][A
 61%|██████    | 76/125 [05:45<03:47,  4.65s/it][A
 62%|██████▏   | 77/125 [05:50<03:42,  4.64s/it][A
 62%|██████▏   | 78/125 [05:54<03:37,  4.63s/it][A
 63%|██████▎   | 79/125 [05:59<03:33,  4.65s/it][A
 64%|██████▍   | 80/125 [06:04<03:29,  4.67s/it][A
 65%|██████▍   | 81/125 [06:08<03:24,  4.66s/it][A
 66%|██████▌   | 82/125 [06:13<03:19,  4.64s/it][A
 66%|██████▋   | 83/125 [06:17<03:13,  4.61s/it][A
 67%|██████▋   | 84/125 [06:22<03:08,  4.60s/it][A
 68%|██████▊   | 85/125 [06:27<03:03,  4.59s/it][A
 69%|██████▉   | 86/125 [06:31<02:58,  4.59s/it][A
 70%|██████▉   | 87/125 [06:36<02:55,  4.61s/it][A
 70%|███████   | 88/125 [06:41<02:51,  4.64s/it][A
 71%|███████   | 89/125 [06:45<02:47,  4.64s/it][A
 72%|███████▏  | 90/125 [06:50<02:41,  4.62s/it][A
 73%|███████▎  | 91/125 [06:54<02:37,  4.64s/it][A
 74%|███████▎  | 92/125 [06:59<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:08<02:23,  4.62s/it][A
 76%|███████▌  | 95/125 [07:13<02:19,  4.64s/it][A
 77%|███████▋  | 96/125 [07:18<02:13,  4.62s/it][A
 78%|███████▊  | 97/125 [07:22<02:08,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.60s/it][A
 79%|███████▉  | 99/125 [07:31<01:59,  4.61s/it][A
 80%|████████  | 100/125 [07:36<01:54,  4.60s/it][A
 81%|████████  | 101/125 [07:40<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:45<01:45,  4.61s/it][A
 82%|████████▏ | 103/125 [07:50<01:41,  4.62s/it][A
 83%|████████▎ | 104/125 [07:54<01:37,  4.64s/it][A
 84%|████████▍ | 105/125 [07:59<01:33,  4.65s/it][A
 85%|████████▍ | 106/125 [08:04<01:28,  4.64s/it][A
 86%|████████▌ | 107/125 [08:08<01:23,  4.63s/it][A
 86%|████████▋ | 108/125 [08:13<01:18,  4.65s/it][A
 87%|████████▋ | 109/125 [08:18<01:13,  4.62s/it][A
 88%|████████▊ | 110/125 [08:22<01:09,  4.62s/it][A
 89%|████████▉ | 111/125 [08:27<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:31<01:00,  4.62s/it][A
 90%|█████████ | 113/125 [08:36<00:55,  4.62s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:45<00:46,  4.61s/it][A
 93%|█████████▎| 116/125 [08:50<00:41,  4.61s/it][A
 94%|█████████▎| 117/125 [08:54<00:36,  4.62s/it][A
 94%|█████████▍| 118/125 [08:59<00:32,  4.62s/it][A
 95%|█████████▌| 119/125 [09:04<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:08<00:23,  4.61s/it][A
 97%|█████████▋| 121/125 [09:13<00:18,  4.60s/it][A
 98%|█████████▊| 122/125 [09:17<00:13,  4.59s/it][A
 98%|█████████▊| 123/125 [09:22<00:09,  4.61s/it][A
 99%|█████████▉| 124/125 [09:27<00:04,  4.62s/it][A
100%|██████████| 125/125 [09:31<00:00,  4.62s/it][A                                                       
                                                 [A 30%|███       | 150/492 [5:16:01<10:51:49, 114.35s/it]
100%|██████████| 125/125 [09:32<00:00,  4.62s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-150)... Done. 11.7s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 31%|███       | 151/492 [5:18:21<27:57:10, 295.10s/it] 31%|███       | 152/492 [5:20:16<22:45:35, 240.99s/it] 31%|███       | 153/492 [5:22:10<19:06:42, 202.96s/it] 31%|███▏      | 154/492 [5:24:05<16:33:48, 176.42s/it] 32%|███▏      | 155/492 [5:25:59<14:46:58, 157.92s/it]                                                        32%|███▏      | 155/492 [5:25:59<14:46:58, 157.92s/it] 32%|███▏      | 156/492 [5:27:54<13:31:09, 144.85s/it] 32%|███▏      | 157/492 [5:29:48<12:37:40, 135.70s/it] 32%|███▏      | 158/492 [5:31:43<12:00:09, 129.37s/it] 32%|███▏      | 159/492 [5:33:37<11:33:05, 124.88s/it] 33%|███▎      | 160/492 [5:35:32<11:13:37, 121.74s/it]                                                        33%|███▎      | 160/492 [5:35:32<11:13:37, 121.74s/it] 33%|███▎      | 161/492 [5:37:26<10:59:56, 119.63s/it] 33%|███▎      | 162/492 [5:39:21<10:50:41, 118.31s/it] 33%|███▎      | 163/492 [5:41:17<10:43:36, 117.38s/it] 33%|███▎      | 164/492 [5:43:11<10:37:27, 116.61s/it] 34%|███▎      | 165/492 [5:45:06<10:31:53, 115.94s/it]                                                        34%|███▎      | 165/492 [5:45:06<10:31:53, 115.94s/it] 34%|███▎      | 166/492 [5:47:00<10:27:28, 115.49s/it] 34%|███▍      | 167/492 [5:48:55<10:23:52, 115.18s/it] 34%|███▍      | 168/492 [5:50:49<10:20:11, 114.85s/it] 34%|███▍      | 169/492 [5:52:44<10:18:10, 114.83s/it] 35%|███▍      | 170/492 [5:54:38<10:15:51, 114.76s/it]                                                        35%|███▍      | 170/492 [5:54:38<10:15:51, 114.76s/it] 35%|███▍      | 171/492 [5:56:33<10:13:58, 114.76s/it] 35%|███▍      | 172/492 [5:58:27<10:11:37, 114.68s/it] 35%|███▌      | 173/492 [6:00:22<10:09:05, 114.56s/it] 35%|███▌      | 174/492 [6:02:17<10:07:46, 114.68s/it] 36%|███▌      | 175/492 [6:04:12<10:06:36, 114.81s/it]                                                        36%|███▌      | 175/492 [6:04:12<10:06:36, 114.81s/it] 36%|███▌      | 176/492 [6:06:07<10:04:38, 114.81s/it] 36%|███▌      | 177/492 [6:08:01<10:02:23, 114.74s/it] 36%|███▌      | 178/492 [6:09:56<10:01:05, 114.86s/it] 36%|███▋      | 179/492 [6:11:51<9:58:31, 114.73s/it]  37%|███▋      | 180/492 [6:13:45<9:55:38, 114.55s/it]                                                       37%|███▋      | 180/492 [6:13:45<9:55:38, 114.55s/it] 37%|███▋      | 181/492 [6:15:39<9:53:30, 114.50s/it] 37%|███▋      | 182/492 [6:17:34<9:52:06, 114.60s/it] 37%|███▋      | 183/492 [6:19:28<9:49:49, 114.53s/it] 37%|███▋      | 184/492 [6:21:24<9:48:49, 114.70s/it] 38%|███▊      | 185/492 [6:23:18<9:47:04, 114.74s/it]                                                       38%|███▊      | 185/492 [6:23:18<9:47:04, 114.74s/it] 38%|███▊      | 186/492 [6:25:13<9:45:11, 114.74s/it] 38%|███▊      | 187/492 [6:27:07<9:42:31, 114.60s/it] 38%|███▊      | 188/492 [6:29:02<9:40:33, 114.58s/it] 38%|███▊      | 189/492 [6:30:57<9:38:41, 114.59s/it] 39%|███▊      | 190/492 [6:32:51<9:37:02, 114.65s/it]                                                       39%|███▊      | 190/492 [6:32:51<9:37:02, 114.65s/it] 39%|███▉      | 191/492 [6:34:47<9:36:15, 114.87s/it] 39%|███▉      | 192/492 [6:36:41<9:33:57, 114.79s/it] 39%|███▉      | 193/492 [6:38:36<9:32:18, 114.84s/it] 39%|███▉      | 194/492 [6:40:31<9:29:26, 114.65s/it] 40%|███▉      | 195/492 [6:42:25<9:27:15, 114.60s/it]                                                       40%|███▉      | 195/492 [6:42:25<9:27:15, 114.60s/it] 40%|███▉      | 196/492 [6:44:20<9:26:08, 114.76s/it] 40%|████      | 197/492 [6:46:15<9:24:30, 114.82s/it] 40%|████      | 198/492 [6:48:10<9:22:21, 114.77s/it] 40%|████      | 199/492 [6:50:04<9:20:07, 114.70s/it] 41%|████      | 200/492 [6:51:59<9:17:42, 114.60s/it]                                                       41%|████      | 200/492 [6:51:59<9:17:42, 114.60s/it]{'eval_loss': 0.11852660775184631, 'eval_runtime': 576.5584, 'eval_samples_per_second': 1.734, 'eval_steps_per_second': 0.217, 'epoch': 1.22}
{'loss': 0.1047, 'grad_norm': 0.03252468258142471, 'learning_rate': 8.6710094022727e-05, 'epoch': 1.26}
{'loss': 0.0952, 'grad_norm': 0.031006837263703346, 'learning_rate': 8.548076267221256e-05, 'epoch': 1.3}
{'loss': 0.1088, 'grad_norm': 0.03085142932832241, 'learning_rate': 8.420662467396547e-05, 'epoch': 1.34}
{'loss': 0.0935, 'grad_norm': 0.03295427933335304, 'learning_rate': 8.288928906477496e-05, 'epoch': 1.38}
{'loss': 0.1052, 'grad_norm': 0.04264140501618385, 'learning_rate': 8.15304194332491e-05, 'epoch': 1.42}
{'loss': 0.1026, 'grad_norm': 0.034094925969839096, 'learning_rate': 8.013173181896283e-05, 'epoch': 1.46}
{'loss': 0.1113, 'grad_norm': 0.042117953300476074, 'learning_rate': 7.869499254536865e-05, 'epoch': 1.5}
{'loss': 0.0962, 'grad_norm': 0.036028943955898285, 'learning_rate': 7.722201598920673e-05, 'epoch': 1.54}
{'loss': 0.1029, 'grad_norm': 0.039681848138570786, 'learning_rate': 7.571466228923115e-05, 'epoch': 1.58}
{'loss': 0.1017, 'grad_norm': 0.03896370530128479, 'learning_rate': 7.417483499714589e-05, 'epoch': 1.62}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:38,  3.26s/it][A
  3%|▎         | 4/125 [00:13<07:33,  3.75s/it][A
  4%|▍         | 5/125 [00:18<08:03,  4.03s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.23s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.34s/it][A
  6%|▋         | 8/125 [00:32<08:37,  4.42s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:40,  4.52s/it][A
  9%|▉         | 11/125 [00:46<08:38,  4.55s/it][A
 10%|▉         | 12/125 [00:50<08:35,  4.56s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.63s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.62s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.62s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.60s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:55,  4.61s/it][A
 18%|█▊        | 23/125 [01:41<07:51,  4.62s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:43,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.62s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.63s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.62s/it][A
 27%|██▋       | 34/125 [02:32<07:01,  4.63s/it][A
 28%|██▊       | 35/125 [02:36<06:56,  4.63s/it][A
 29%|██▉       | 36/125 [02:41<06:51,  4.62s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:41,  4.61s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:26,  4.61s/it][A
 34%|███▎      | 42/125 [03:09<06:21,  4.60s/it][A
 34%|███▍      | 43/125 [03:13<06:19,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.61s/it][A
 36%|███▌      | 45/125 [03:23<06:08,  4.60s/it][A
 37%|███▋      | 46/125 [03:27<06:03,  4.60s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.62s/it][A
 39%|███▉      | 49/125 [03:41<05:51,  4.63s/it][A
 40%|████      | 50/125 [03:46<05:47,  4.63s/it][A
 41%|████      | 51/125 [03:50<05:44,  4.65s/it][A
 42%|████▏     | 52/125 [03:55<05:41,  4.67s/it][A
 42%|████▏     | 53/125 [04:00<05:35,  4.66s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.64s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.64s/it][A
 45%|████▍     | 56/125 [04:14<05:19,  4.63s/it][A
 46%|████▌     | 57/125 [04:18<05:15,  4.64s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:27<05:05,  4.63s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.63s/it][A
 49%|████▉     | 61/125 [04:37<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:51,  4.63s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:51<04:42,  4.63s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.63s/it][A
 53%|█████▎    | 66/125 [05:00<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:26,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:21,  4.60s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.59s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.60s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:04,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:37<03:56,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.66s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.66s/it][A
 62%|██████▏   | 77/125 [05:51<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:05<03:30,  4.68s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.67s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:19<03:14,  4.63s/it][A
 67%|██████▋   | 84/125 [06:23<03:09,  4.62s/it][A
 68%|██████▊   | 85/125 [06:28<03:04,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:42<02:51,  4.65s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.64s/it][A
 73%|███████▎  | 91/125 [06:56<02:38,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:05<02:27,  4.61s/it][A
 75%|███████▌  | 94/125 [07:09<02:23,  4.63s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.65s/it][A
 77%|███████▋  | 96/125 [07:19<02:14,  4.63s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.62s/it][A
 78%|███████▊  | 98/125 [07:28<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:33<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.61s/it][A
 81%|████████  | 101/125 [07:42<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.61s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.63s/it][A
 83%|████████▎ | 104/125 [07:56<01:37,  4.65s/it][A
 84%|████████▍ | 105/125 [08:00<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.65s/it][A
 86%|████████▌ | 107/125 [08:10<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.66s/it][A
 87%|████████▋ | 109/125 [08:19<01:14,  4.63s/it][A
 88%|████████▊ | 110/125 [08:24<01:09,  4.62s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:33<01:00,  4.63s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.63s/it][A
 91%|█████████ | 114/125 [08:42<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:47<00:46,  4.62s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.62s/it][A
 94%|█████████▎| 117/125 [08:56<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:10<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:19<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:24<00:09,  4.62s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.63s/it][A
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A                                                      
                                                 [A 41%|████      | 200/492 [7:01:37<9:17:42, 114.60s/it]
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-200)... Done. 10.7s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 41%|████      | 201/492 [7:03:53<23:49:05, 294.66s/it] 41%|████      | 202/492 [7:05:48<19:23:46, 240.78s/it] 41%|████▏     | 203/492 [7:07:43<16:17:40, 202.98s/it] 41%|████▏     | 204/492 [7:09:38<14:07:10, 176.49s/it] 42%|████▏     | 205/492 [7:11:33<12:35:41, 157.98s/it]                                                        42%|████▏     | 205/492 [7:11:33<12:35:41, 157.98s/it] 42%|████▏     | 206/492 [7:13:27<11:30:52, 144.94s/it] 42%|████▏     | 207/492 [7:15:22<10:45:44, 135.95s/it] 42%|████▏     | 208/492 [7:17:16<10:12:42, 129.44s/it] 42%|████▏     | 209/492 [7:19:11<9:49:57, 125.08s/it]  43%|████▎     | 210/492 [7:21:06<9:33:03, 121.93s/it]                                                       43%|████▎     | 210/492 [7:21:06<9:33:03, 121.93s/it] 43%|████▎     | 211/492 [7:23:01<9:21:47, 119.96s/it] 43%|████▎     | 212/492 [7:24:55<9:11:37, 118.21s/it] 43%|████▎     | 213/492 [7:26:51<9:05:18, 117.27s/it] 43%|████▎     | 214/492 [7:28:45<8:59:40, 116.48s/it] 44%|████▎     | 215/492 [7:30:40<8:55:31, 116.00s/it]                                                       44%|████▎     | 215/492 [7:30:40<8:55:31, 116.00s/it] 44%|████▍     | 216/492 [7:32:35<8:52:11, 115.69s/it] 44%|████▍     | 217/492 [7:34:30<8:48:50, 115.38s/it] 44%|████▍     | 218/492 [7:36:24<8:46:04, 115.20s/it] 45%|████▍     | 219/492 [7:38:19<8:43:53, 115.14s/it] 45%|████▍     | 220/492 [7:40:15<8:41:52, 115.12s/it]                                                       45%|████▍     | 220/492 [7:40:15<8:41:52, 115.12s/it] 45%|████▍     | 221/492 [7:42:09<8:39:38, 115.05s/it] 45%|████▌     | 222/492 [7:44:05<8:37:52, 115.08s/it] 45%|████▌     | 223/492 [7:45:59<8:35:34, 115.00s/it] 46%|████▌     | 224/492 [7:47:54<8:32:57, 114.84s/it] 46%|████▌     | 225/492 [7:49:49<8:31:00, 114.83s/it]                                                       46%|████▌     | 225/492 [7:49:49<8:31:00, 114.83s/it] 46%|████▌     | 226/492 [7:51:43<8:29:02, 114.82s/it] 46%|████▌     | 227/492 [7:53:38<8:27:20, 114.87s/it] 46%|████▋     | 228/492 [7:55:34<8:25:48, 114.95s/it] 47%|████▋     | 229/492 [7:57:28<8:23:18, 114.82s/it] 47%|████▋     | 230/492 [7:59:22<8:20:45, 114.68s/it]                                                       47%|████▋     | 230/492 [7:59:22<8:20:45, 114.68s/it] 47%|████▋     | 231/492 [8:01:17<8:18:13, 114.53s/it] 47%|████▋     | 232/492 [8:03:11<8:16:24, 114.56s/it] 47%|████▋     | 233/492 [8:05:06<8:15:03, 114.68s/it] 48%|████▊     | 234/492 [8:07:01<8:12:45, 114.60s/it] 48%|████▊     | 235/492 [8:08:55<8:10:13, 114.45s/it]                                                       48%|████▊     | 235/492 [8:08:55<8:10:13, 114.45s/it] 48%|████▊     | 236/492 [8:10:49<8:08:10, 114.42s/it] 48%|████▊     | 237/492 [8:12:43<8:06:15, 114.41s/it] 48%|████▊     | 238/492 [8:14:38<8:04:54, 114.54s/it] 49%|████▊     | 239/492 [8:16:33<8:02:51, 114.51s/it] 49%|████▉     | 240/492 [8:18:27<8:01:02, 114.53s/it]                                                       49%|████▉     | 240/492 [8:18:27<8:01:02, 114.53s/it] 49%|████▉     | 241/492 [8:20:22<7:58:55, 114.48s/it] 49%|████▉     | 242/492 [8:22:16<7:57:02, 114.49s/it] 49%|████▉     | 243/492 [8:24:11<7:55:09, 114.50s/it] 50%|████▉     | 244/492 [8:26:06<7:53:38, 114.59s/it] 50%|████▉     | 245/492 [8:28:01<7:52:25, 114.76s/it]                                                       50%|████▉     | 245/492 [8:28:01<7:52:25, 114.76s/it] 50%|█████     | 246/492 [8:29:56<7:50:57, 114.87s/it] 50%|█████     | 247/492 [8:31:44<7:41:03, 112.91s/it] 50%|█████     | 248/492 [8:33:40<7:42:18, 113.68s/it] 51%|█████     | 249/492 [8:35:34<7:41:44, 114.01s/it] 51%|█████     | 250/492 [8:37:29<7:40:20, 114.13s/it]                                                       51%|█████     | 250/492 [8:37:29<7:40:20, 114.13s/it]{'eval_loss': 0.11510748416185379, 'eval_runtime': 578.0426, 'eval_samples_per_second': 1.73, 'eval_steps_per_second': 0.216, 'epoch': 1.62}
{'loss': 0.1042, 'grad_norm': 0.04175429046154022, 'learning_rate': 7.260447867371709e-05, 'epoch': 1.66}
{'loss': 0.0961, 'grad_norm': 0.041212454438209534, 'learning_rate': 7.100557643309732e-05, 'epoch': 1.71}
{'loss': 0.0982, 'grad_norm': 0.04984848201274872, 'learning_rate': 6.938014743846285e-05, 'epoch': 1.75}
{'loss': 0.1042, 'grad_norm': 0.04844158887863159, 'learning_rate': 6.773024435212678e-05, 'epoch': 1.79}
{'loss': 0.101, 'grad_norm': 0.04398966580629349, 'learning_rate': 6.605795074334794e-05, 'epoch': 1.83}
{'loss': 0.1006, 'grad_norm': 0.04412737116217613, 'learning_rate': 6.436537845710903e-05, 'epoch': 1.87}
{'loss': 0.0883, 'grad_norm': 0.04369115084409714, 'learning_rate': 6.265466494718732e-05, 'epoch': 1.91}
{'loss': 0.0854, 'grad_norm': 0.0569264255464077, 'learning_rate': 6.092797057688495e-05, 'epoch': 1.95}
{'loss': 0.0931, 'grad_norm': 0.0520426370203495, 'learning_rate': 5.918747589082853e-05, 'epoch': 1.99}
{'loss': 0.0997, 'grad_norm': 0.04745051637291908, 'learning_rate': 5.7435378861282585e-05, 'epoch': 2.03}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:38,  3.26s/it][A
  3%|▎         | 4/125 [00:13<07:33,  3.75s/it][A
  4%|▍         | 5/125 [00:18<08:03,  4.03s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.22s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.33s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.42s/it][A
  7%|▋         | 9/125 [00:36<08:40,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:40,  4.52s/it][A
  9%|▉         | 11/125 [00:45<08:38,  4.55s/it][A
 10%|▉         | 12/125 [00:50<08:34,  4.56s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.63s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.62s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.61s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.60s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:55,  4.62s/it][A
 18%|█▊        | 23/125 [01:41<07:51,  4.62s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:43,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.62s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.63s/it][A
 26%|██▌       | 32/125 [02:23<07:09,  4.62s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.63s/it][A
 27%|██▋       | 34/125 [02:32<07:02,  4.64s/it][A
 28%|██▊       | 35/125 [02:36<06:56,  4.63s/it][A
 29%|██▉       | 36/125 [02:41<06:51,  4.63s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:41,  4.62s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [03:00<06:32,  4.62s/it][A
 33%|███▎      | 41/125 [03:04<06:27,  4.61s/it][A
 34%|███▎      | 42/125 [03:09<06:22,  4.60s/it][A
 34%|███▍      | 43/125 [03:13<06:19,  4.63s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.61s/it][A
 36%|███▌      | 45/125 [03:23<06:08,  4.61s/it][A
 37%|███▋      | 46/125 [03:27<06:03,  4.60s/it][A
 38%|███▊      | 47/125 [03:32<05:59,  4.61s/it][A
 38%|███▊      | 48/125 [03:36<05:56,  4.63s/it][A
 39%|███▉      | 49/125 [03:41<05:52,  4.64s/it][A
 40%|████      | 50/125 [03:46<05:47,  4.64s/it][A
 41%|████      | 51/125 [03:50<05:44,  4.66s/it][A
 42%|████▏     | 52/125 [03:55<05:41,  4.68s/it][A
 42%|████▏     | 53/125 [04:00<05:35,  4.66s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.64s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.64s/it][A
 45%|████▍     | 56/125 [04:14<05:19,  4.63s/it][A
 46%|████▌     | 57/125 [04:18<05:15,  4.64s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.64s/it][A
 47%|████▋     | 59/125 [04:28<05:05,  4.63s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.63s/it][A
 49%|████▉     | 61/125 [04:37<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:51,  4.62s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:51<04:42,  4.62s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.63s/it][A
 53%|█████▎    | 66/125 [05:00<04:31,  4.61s/it][A
 54%|█████▎    | 67/125 [05:04<04:26,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:22,  4.60s/it][A
 55%|█████▌    | 69/125 [05:14<04:17,  4.59s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.60s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:04,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:37<03:56,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.66s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.66s/it][A
 62%|██████▏   | 77/125 [05:51<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:05<03:30,  4.68s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.67s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:19<03:14,  4.63s/it][A
 67%|██████▋   | 84/125 [06:23<03:09,  4.62s/it][A
 68%|██████▊   | 85/125 [06:28<03:04,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:42<02:51,  4.65s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.64s/it][A
 73%|███████▎  | 91/125 [06:56<02:38,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.63s/it][A
 74%|███████▍  | 93/125 [07:05<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:10<02:23,  4.63s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.65s/it][A
 77%|███████▋  | 96/125 [07:19<02:14,  4.63s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.62s/it][A
 78%|███████▊  | 98/125 [07:28<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:33<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.61s/it][A
 81%|████████  | 101/125 [07:42<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.61s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.63s/it][A
 83%|████████▎ | 104/125 [07:56<01:37,  4.65s/it][A
 84%|████████▍ | 105/125 [08:01<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.64s/it][A
 86%|████████▌ | 107/125 [08:10<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.66s/it][A
 87%|████████▋ | 109/125 [08:19<01:14,  4.64s/it][A
 88%|████████▊ | 110/125 [08:24<01:09,  4.63s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.63s/it][A
 90%|████████▉ | 112/125 [08:33<01:00,  4.63s/it][A
 90%|█████████ | 113/125 [08:38<00:55,  4.63s/it][A
 91%|█████████ | 114/125 [08:42<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:47<00:46,  4.62s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.62s/it][A
 94%|█████████▎| 117/125 [08:56<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [09:01<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:10<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:19<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:24<00:09,  4.62s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.63s/it][A
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A                                                      
                                                 [A 51%|█████     | 250/492 [8:47:07<7:40:20, 114.13s/it]
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-250)... Done. 10.4s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 51%|█████     | 251/492 [8:49:26<19:44:34, 294.92s/it] 51%|█████     | 252/492 [8:51:20<16:03:04, 240.77s/it] 51%|█████▏    | 253/492 [8:53:14<13:28:01, 202.85s/it] 52%|█████▏    | 254/492 [8:55:09<11:39:13, 176.28s/it] 52%|█████▏    | 255/492 [8:57:03<10:23:19, 157.80s/it]                                                        52%|█████▏    | 255/492 [8:57:03<10:23:19, 157.80s/it] 52%|█████▏    | 256/492 [8:58:58<9:29:47, 144.86s/it]  52%|█████▏    | 257/492 [9:00:53<8:51:41, 135.75s/it] 52%|█████▏    | 258/492 [9:02:48<8:25:24, 129.59s/it] 53%|█████▎    | 259/492 [9:04:42<8:05:37, 125.05s/it] 53%|█████▎    | 260/492 [9:06:37<7:51:59, 122.07s/it]                                                       53%|█████▎    | 260/492 [9:06:37<7:51:59, 122.07s/it] 53%|█████▎    | 261/492 [9:08:32<7:41:44, 119.93s/it] 53%|█████▎    | 262/492 [9:10:27<7:33:50, 118.39s/it] 53%|█████▎    | 263/492 [9:12:21<7:27:12, 117.17s/it] 54%|█████▎    | 264/492 [9:14:16<7:22:24, 116.42s/it] 54%|█████▍    | 265/492 [9:16:11<7:18:23, 115.87s/it]                                                       54%|█████▍    | 265/492 [9:16:11<7:18:23, 115.87s/it] 54%|█████▍    | 266/492 [9:18:05<7:15:10, 115.53s/it] 54%|█████▍    | 267/492 [9:20:00<7:11:55, 115.18s/it] 54%|█████▍    | 268/492 [9:21:55<7:10:01, 115.19s/it] 55%|█████▍    | 269/492 [9:23:49<7:07:02, 114.90s/it] 55%|█████▍    | 270/492 [9:25:43<7:04:20, 114.69s/it]                                                       55%|█████▍    | 270/492 [9:25:43<7:04:20, 114.69s/it] 55%|█████▌    | 271/492 [9:27:38<7:02:17, 114.65s/it] 55%|█████▌    | 272/492 [9:29:32<6:59:57, 114.53s/it] 55%|█████▌    | 273/492 [9:31:27<6:58:05, 114.54s/it] 56%|█████▌    | 274/492 [9:33:22<6:56:38, 114.67s/it] 56%|█████▌    | 275/492 [9:35:16<6:54:35, 114.63s/it]                                                       56%|█████▌    | 275/492 [9:35:16<6:54:35, 114.63s/it] 56%|█████▌    | 276/492 [9:37:11<6:52:41, 114.64s/it] 56%|█████▋    | 277/492 [9:39:06<6:50:52, 114.66s/it] 57%|█████▋    | 278/492 [9:41:01<6:49:15, 114.75s/it] 57%|█████▋    | 279/492 [9:42:55<6:47:18, 114.73s/it] 57%|█████▋    | 280/492 [9:44:50<6:44:58, 114.62s/it]                                                       57%|█████▋    | 280/492 [9:44:50<6:44:58, 114.62s/it] 57%|█████▋    | 281/492 [9:46:44<6:43:13, 114.66s/it] 57%|█████▋    | 282/492 [9:48:39<6:41:06, 114.60s/it] 58%|█████▊    | 283/492 [9:50:34<6:39:40, 114.74s/it] 58%|█████▊    | 284/492 [9:52:29<6:37:42, 114.72s/it] 58%|█████▊    | 285/492 [9:54:23<6:35:23, 114.60s/it]                                                       58%|█████▊    | 285/492 [9:54:23<6:35:23, 114.60s/it] 58%|█████▊    | 286/492 [9:56:17<6:33:02, 114.48s/it] 58%|█████▊    | 287/492 [9:58:12<6:31:14, 114.51s/it] 59%|█████▊    | 288/492 [10:00:07<6:29:44, 114.63s/it] 59%|█████▊    | 289/492 [10:02:01<6:27:26, 114.52s/it] 59%|█████▉    | 290/492 [10:03:55<6:25:23, 114.47s/it]                                                        59%|█████▉    | 290/492 [10:03:55<6:25:23, 114.47s/it] 59%|█████▉    | 291/492 [10:05:49<6:23:00, 114.33s/it] 59%|█████▉    | 292/492 [10:07:44<6:21:21, 114.41s/it] 60%|█████▉    | 293/492 [10:09:38<6:19:01, 114.28s/it] 60%|█████▉    | 294/492 [10:11:33<6:17:40, 114.45s/it] 60%|█████▉    | 295/492 [10:13:28<6:16:16, 114.60s/it]                                                        60%|█████▉    | 295/492 [10:13:28<6:16:16, 114.60s/it] 60%|██████    | 296/492 [10:15:22<6:14:30, 114.65s/it] 60%|██████    | 297/492 [10:17:17<6:12:47, 114.71s/it] 61%|██████    | 298/492 [10:19:12<6:11:10, 114.80s/it] 61%|██████    | 299/492 [10:21:07<6:08:58, 114.71s/it] 61%|██████    | 300/492 [10:23:01<6:06:54, 114.66s/it]                                                        61%|██████    | 300/492 [10:23:01<6:06:54, 114.66s/it]{'eval_loss': 0.11357399076223373, 'eval_runtime': 578.1803, 'eval_samples_per_second': 1.73, 'eval_steps_per_second': 0.216, 'epoch': 2.03}
{'loss': 0.0869, 'grad_norm': 0.04727412760257721, 'learning_rate': 5.567389211245485e-05, 'epoch': 2.07}
{'loss': 0.0967, 'grad_norm': 0.05797808617353439, 'learning_rate': 5.390524012629824e-05, 'epoch': 2.11}
{'loss': 0.0915, 'grad_norm': 0.05673275515437126, 'learning_rate': 5.2131656433338506e-05, 'epoch': 2.15}
{'loss': 0.0872, 'grad_norm': 0.06083540990948677, 'learning_rate': 5.035538079207488e-05, 'epoch': 2.19}
{'loss': 0.0891, 'grad_norm': 0.05403359234333038, 'learning_rate': 4.857865636051585e-05, 'epoch': 2.23}
{'loss': 0.0879, 'grad_norm': 0.06568802893161774, 'learning_rate': 4.6803726863421725e-05, 'epoch': 2.27}
{'loss': 0.0868, 'grad_norm': 0.05751260742545128, 'learning_rate': 4.503283375883165e-05, 'epoch': 2.31}
{'loss': 0.0807, 'grad_norm': 0.05319669097661972, 'learning_rate': 4.326821340745304e-05, 'epoch': 2.36}
{'loss': 0.0842, 'grad_norm': 0.06429895013570786, 'learning_rate': 4.151209424848819e-05, 'epoch': 2.4}
{'loss': 0.0891, 'grad_norm': 0.05513699725270271, 'learning_rate': 3.976669398546451e-05, 'epoch': 2.44}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:45,  2.32s/it][A
  2%|▏         | 3/125 [00:09<06:36,  3.25s/it][A
  3%|▎         | 4/125 [00:13<07:31,  3.74s/it][A
  4%|▍         | 5/125 [00:18<08:02,  4.02s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.22s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.33s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.42s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:40,  4.52s/it][A
  9%|▉         | 11/125 [00:45<08:38,  4.55s/it][A
 10%|▉         | 12/125 [00:50<08:34,  4.56s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.63s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.62s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.62s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.61s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.62s/it][A
 18%|█▊        | 22/125 [01:36<07:55,  4.62s/it][A
 18%|█▊        | 23/125 [01:41<07:50,  4.62s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:42,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.61s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.61s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.62s/it][A
 26%|██▌       | 32/125 [02:22<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.62s/it][A
 27%|██▋       | 34/125 [02:32<07:01,  4.63s/it][A
 28%|██▊       | 35/125 [02:36<06:55,  4.62s/it][A
 29%|██▉       | 36/125 [02:41<06:51,  4.62s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:41,  4.61s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:26,  4.61s/it][A
 34%|███▎      | 42/125 [03:09<06:21,  4.60s/it][A
 34%|███▍      | 43/125 [03:13<06:19,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:12,  4.60s/it][A
 36%|███▌      | 45/125 [03:22<06:08,  4.60s/it][A
 37%|███▋      | 46/125 [03:27<06:03,  4.60s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.62s/it][A
 39%|███▉      | 49/125 [03:41<05:51,  4.63s/it][A
 40%|████      | 50/125 [03:46<05:47,  4.63s/it][A
 41%|████      | 51/125 [03:50<05:44,  4.65s/it][A
 42%|████▏     | 52/125 [03:55<05:40,  4.67s/it][A
 42%|████▏     | 53/125 [04:00<05:35,  4.66s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.63s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.63s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.63s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.62s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:37<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:51,  4.62s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.62s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.62s/it][A
 53%|█████▎    | 66/125 [05:00<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:25,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:21,  4.59s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.59s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.59s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:03,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:36<03:55,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.66s/it][A
 62%|██████▏   | 77/125 [05:50<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:04<03:30,  4.67s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.66s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:18<03:14,  4.62s/it][A
 67%|██████▋   | 84/125 [06:23<03:08,  4.61s/it][A
 68%|██████▊   | 85/125 [06:27<03:03,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:51,  4.65s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.63s/it][A
 73%|███████▎  | 91/125 [06:55<02:37,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:09<02:23,  4.62s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.64s/it][A
 77%|███████▋  | 96/125 [07:18<02:14,  4.62s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:28<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.61s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.63s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.65s/it][A
 84%|████████▍ | 105/125 [08:00<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.65s/it][A
 86%|████████▌ | 107/125 [08:09<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.66s/it][A
 87%|████████▋ | 109/125 [08:19<01:14,  4.63s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.62s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<01:00,  4.63s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.63s/it][A
 91%|█████████ | 114/125 [08:42<00:50,  4.61s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.62s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.62s/it][A
 94%|█████████▎| 117/125 [08:56<00:37,  4.64s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.62s/it][A
 98%|█████████▊| 122/125 [09:19<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.62s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.63s/it][A
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A                                                       
                                                 [A 61%|██████    | 300/492 [10:32:39<6:06:54, 114.66s/it]
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-300)... Done. 11.1s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 61%|██████    | 301/492 [10:34:58<15:40:18, 295.39s/it] 61%|██████▏   | 302/492 [10:36:53<12:43:36, 241.14s/it] 62%|██████▏   | 303/492 [10:38:48<10:40:27, 203.32s/it] 62%|██████▏   | 304/492 [10:40:43<9:13:55, 176.79s/it]  62%|██████▏   | 305/492 [10:42:38<8:13:13, 158.26s/it]                                                        62%|██████▏   | 305/492 [10:42:38<8:13:13, 158.26s/it] 62%|██████▏   | 306/492 [10:44:32<7:29:41, 145.06s/it] 62%|██████▏   | 307/492 [10:46:27<6:59:15, 135.98s/it] 63%|██████▎   | 308/492 [10:48:22<6:37:46, 129.71s/it] 63%|██████▎   | 309/492 [10:50:16<6:21:42, 125.15s/it] 63%|██████▎   | 310/492 [10:52:11<6:09:35, 121.84s/it]                                                        63%|██████▎   | 310/492 [10:52:11<6:09:35, 121.84s/it] 63%|██████▎   | 311/492 [10:54:05<6:00:53, 119.63s/it] 63%|██████▎   | 312/492 [10:55:59<5:54:03, 118.02s/it] 64%|██████▎   | 313/492 [10:57:54<5:49:10, 117.04s/it] 64%|██████▍   | 314/492 [10:59:49<5:45:19, 116.40s/it] 64%|██████▍   | 315/492 [11:01:43<5:41:21, 115.71s/it]                                                        64%|██████▍   | 315/492 [11:01:43<5:41:21, 115.71s/it] 64%|██████▍   | 316/492 [11:03:39<5:39:23, 115.70s/it] 64%|██████▍   | 317/492 [11:05:33<5:36:11, 115.26s/it] 65%|██████▍   | 318/492 [11:07:28<5:33:52, 115.13s/it] 65%|██████▍   | 319/492 [11:09:23<5:31:43, 115.05s/it] 65%|██████▌   | 320/492 [11:11:17<5:29:14, 114.85s/it]                                                        65%|██████▌   | 320/492 [11:11:17<5:29:14, 114.85s/it] 65%|██████▌   | 321/492 [11:13:12<5:26:59, 114.73s/it] 65%|██████▌   | 322/492 [11:15:06<5:24:36, 114.57s/it] 66%|██████▌   | 323/492 [11:17:00<5:22:27, 114.48s/it] 66%|██████▌   | 324/492 [11:18:55<5:20:37, 114.51s/it] 66%|██████▌   | 325/492 [11:20:50<5:19:04, 114.64s/it]                                                        66%|██████▌   | 325/492 [11:20:50<5:19:04, 114.64s/it] 66%|██████▋   | 326/492 [11:22:44<5:17:20, 114.70s/it] 66%|██████▋   | 327/492 [11:24:38<5:14:55, 114.52s/it] 67%|██████▋   | 328/492 [11:26:33<5:12:55, 114.48s/it] 67%|██████▋   | 329/492 [11:28:27<5:10:35, 114.33s/it] 67%|██████▋   | 330/492 [11:30:22<5:09:18, 114.56s/it]                                                        67%|██████▋   | 330/492 [11:30:22<5:09:18, 114.56s/it] 67%|██████▋   | 331/492 [11:32:17<5:07:29, 114.60s/it] 67%|██████▋   | 332/492 [11:34:11<5:05:45, 114.66s/it] 68%|██████▊   | 333/492 [11:36:06<5:03:54, 114.68s/it] 68%|██████▊   | 334/492 [11:38:01<5:01:46, 114.60s/it] 68%|██████▊   | 335/492 [11:39:56<5:00:08, 114.70s/it]                                                        68%|██████▊   | 335/492 [11:39:56<5:00:08, 114.70s/it] 68%|██████▊   | 336/492 [11:41:50<4:58:00, 114.62s/it] 68%|██████▊   | 337/492 [11:43:45<4:56:25, 114.74s/it] 69%|██████▊   | 338/492 [11:45:40<4:54:30, 114.74s/it] 69%|██████▉   | 339/492 [11:47:34<4:52:28, 114.69s/it] 69%|██████▉   | 340/492 [11:49:29<4:50:33, 114.70s/it]                                                        69%|██████▉   | 340/492 [11:49:29<4:50:33, 114.70s/it] 69%|██████▉   | 341/492 [11:51:24<4:48:39, 114.70s/it] 70%|██████▉   | 342/492 [11:53:18<4:46:36, 114.64s/it] 70%|██████▉   | 343/492 [11:55:13<4:44:36, 114.61s/it] 70%|██████▉   | 344/492 [11:57:08<4:42:48, 114.65s/it] 70%|███████   | 345/492 [11:59:01<4:40:21, 114.43s/it]                                                        70%|███████   | 345/492 [11:59:01<4:40:21, 114.43s/it] 70%|███████   | 346/492 [12:00:56<4:38:35, 114.49s/it] 71%|███████   | 347/492 [12:02:50<4:36:33, 114.44s/it] 71%|███████   | 348/492 [12:04:45<4:34:56, 114.56s/it] 71%|███████   | 349/492 [12:06:40<4:33:05, 114.58s/it] 71%|███████   | 350/492 [12:08:34<4:31:02, 114.52s/it]                                                        71%|███████   | 350/492 [12:08:34<4:31:02, 114.52s/it]{'eval_loss': 0.1108972504734993, 'eval_runtime': 577.9422, 'eval_samples_per_second': 1.73, 'eval_steps_per_second': 0.216, 'epoch': 2.44}
{'loss': 0.0911, 'grad_norm': 0.059542689472436905, 'learning_rate': 3.803421678562213e-05, 'epoch': 2.48}
{'loss': 0.0815, 'grad_norm': 0.054820574820041656, 'learning_rate': 3.631685049639586e-05, 'epoch': 2.52}
{'loss': 0.083, 'grad_norm': 0.060525231063365936, 'learning_rate': 3.461676388250651e-05, 'epoch': 2.56}
{'loss': 0.0853, 'grad_norm': 0.07101233303546906, 'learning_rate': 3.293610388715048e-05, 'epoch': 2.6}
{'loss': 0.088, 'grad_norm': 0.0710340216755867, 'learning_rate': 3.127699292074683e-05, 'epoch': 2.64}
{'loss': 0.0775, 'grad_norm': 0.0659579485654831, 'learning_rate': 2.964152618066508e-05, 'epoch': 2.68}
{'loss': 0.0808, 'grad_norm': 0.07411176711320877, 'learning_rate': 2.8031769005319147e-05, 'epoch': 2.72}
{'loss': 0.0842, 'grad_norm': 0.06739082932472229, 'learning_rate': 2.6449754265968264e-05, 'epoch': 2.76}
{'loss': 0.0806, 'grad_norm': 0.0516592413187027, 'learning_rate': 2.4897479799518796e-05, 'epoch': 2.8}
{'loss': 0.0794, 'grad_norm': 0.06238855794072151, 'learning_rate': 2.3376905885569182e-05, 'epoch': 2.84}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:38,  3.26s/it][A
  3%|▎         | 4/125 [00:13<07:33,  3.75s/it][A
  4%|▍         | 5/125 [00:18<08:03,  4.03s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.23s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.34s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.42s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:39,  4.52s/it][A
  9%|▉         | 11/125 [00:45<08:38,  4.54s/it][A
 10%|▉         | 12/125 [00:50<08:34,  4.55s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.62s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.61s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.60s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:54,  4.61s/it][A
 18%|█▊        | 23/125 [01:41<07:50,  4.61s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:42,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.62s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.62s/it][A
 26%|██▌       | 32/125 [02:22<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.62s/it][A
 27%|██▋       | 34/125 [02:32<07:01,  4.63s/it][A
 28%|██▊       | 35/125 [02:36<06:56,  4.62s/it][A
 29%|██▉       | 36/125 [02:41<06:51,  4.62s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:41,  4.61s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:26,  4.61s/it][A
 34%|███▎      | 42/125 [03:09<06:21,  4.59s/it][A
 34%|███▍      | 43/125 [03:13<06:19,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.61s/it][A
 36%|███▌      | 45/125 [03:22<06:08,  4.61s/it][A
 37%|███▋      | 46/125 [03:27<06:03,  4.60s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:56,  4.62s/it][A
 39%|███▉      | 49/125 [03:41<05:51,  4.63s/it][A
 40%|████      | 50/125 [03:46<05:47,  4.63s/it][A
 41%|████      | 51/125 [03:50<05:44,  4.65s/it][A
 42%|████▏     | 52/125 [03:55<05:41,  4.67s/it][A
 42%|████▏     | 53/125 [04:00<05:35,  4.66s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.64s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:19,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:15,  4.63s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.63s/it][A
 47%|████▋     | 59/125 [04:27<05:05,  4.63s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.63s/it][A
 49%|████▉     | 61/125 [04:37<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:51,  4.62s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.62s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.62s/it][A
 53%|█████▎    | 66/125 [05:00<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:26,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:21,  4.59s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.59s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.59s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:03,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:37<03:56,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.66s/it][A
 62%|██████▏   | 77/125 [05:51<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:05<03:30,  4.68s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.67s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:18<03:14,  4.62s/it][A
 67%|██████▋   | 84/125 [06:23<03:09,  4.61s/it][A
 68%|██████▊   | 85/125 [06:28<03:03,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:42<02:51,  4.64s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.63s/it][A
 73%|███████▎  | 91/125 [06:55<02:37,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:05<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:09<02:23,  4.62s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.64s/it][A
 77%|███████▋  | 96/125 [07:19<02:14,  4.62s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:28<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.61s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.63s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.64s/it][A
 84%|████████▍ | 105/125 [08:00<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.64s/it][A
 86%|████████▌ | 107/125 [08:09<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.65s/it][A
 87%|████████▋ | 109/125 [08:19<01:14,  4.63s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.63s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:33<01:00,  4.63s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.62s/it][A
 91%|█████████ | 114/125 [08:42<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.61s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.61s/it][A
 94%|█████████▎| 117/125 [08:56<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:10<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.61s/it][A
 98%|█████████▊| 122/125 [09:19<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.62s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.62s/it][A
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A                                                       
                                                 [A 71%|███████   | 350/492 [12:18:12<4:31:02, 114.52s/it]
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-350)... Done. 10.2s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 71%|███████▏  | 351/492 [12:20:29<11:32:27, 294.66s/it] 72%|███████▏  | 352/492 [12:22:25<9:22:18, 240.99s/it]  72%|███████▏  | 353/492 [12:24:20<7:50:40, 203.17s/it] 72%|███████▏  | 354/492 [12:26:15<6:46:14, 176.62s/it] 72%|███████▏  | 355/492 [12:28:09<6:00:43, 157.98s/it]                                                        72%|███████▏  | 355/492 [12:28:09<6:00:43, 157.98s/it] 72%|███████▏  | 356/492 [12:30:03<5:28:23, 144.88s/it] 73%|███████▎  | 357/492 [12:31:58<5:05:41, 135.86s/it] 73%|███████▎  | 358/492 [12:33:53<4:49:07, 129.46s/it] 73%|███████▎  | 359/492 [12:35:47<4:36:46, 124.86s/it] 73%|███████▎  | 360/492 [12:37:42<4:27:58, 121.80s/it]                                                        73%|███████▎  | 360/492 [12:37:42<4:27:58, 121.80s/it] 73%|███████▎  | 361/492 [12:39:36<4:21:12, 119.63s/it] 74%|███████▎  | 362/492 [12:41:30<4:15:46, 118.05s/it] 74%|███████▍  | 363/492 [12:43:25<4:11:21, 116.91s/it] 74%|███████▍  | 364/492 [12:45:20<4:08:08, 116.32s/it] 74%|███████▍  | 365/492 [12:47:15<4:05:26, 115.96s/it]                                                        74%|███████▍  | 365/492 [12:47:15<4:05:26, 115.96s/it] 74%|███████▍  | 366/492 [12:49:09<4:02:23, 115.43s/it] 75%|███████▍  | 367/492 [12:51:03<3:59:45, 115.08s/it] 75%|███████▍  | 368/492 [12:52:58<3:57:32, 114.94s/it] 75%|███████▌  | 369/492 [12:54:53<3:55:29, 114.87s/it] 75%|███████▌  | 370/492 [12:56:41<3:49:26, 112.84s/it]                                                        75%|███████▌  | 370/492 [12:56:41<3:49:26, 112.84s/it] 75%|███████▌  | 371/492 [12:58:35<3:48:33, 113.33s/it] 76%|███████▌  | 372/492 [13:00:30<3:47:30, 113.76s/it] 76%|███████▌  | 373/492 [13:02:24<3:46:02, 113.97s/it] 76%|███████▌  | 374/492 [13:04:19<3:44:28, 114.14s/it] 76%|███████▌  | 375/492 [13:06:14<3:43:11, 114.46s/it]                                                        76%|███████▌  | 375/492 [13:06:14<3:43:11, 114.46s/it] 76%|███████▋  | 376/492 [13:08:09<3:41:20, 114.49s/it] 77%|███████▋  | 377/492 [13:10:03<3:39:18, 114.42s/it] 77%|███████▋  | 378/492 [13:11:57<3:37:16, 114.35s/it] 77%|███████▋  | 379/492 [13:13:51<3:35:12, 114.27s/it] 77%|███████▋  | 380/492 [13:15:46<3:33:26, 114.34s/it]                                                        77%|███████▋  | 380/492 [13:15:46<3:33:26, 114.34s/it] 77%|███████▋  | 381/492 [13:17:41<3:32:02, 114.62s/it] 78%|███████▊  | 382/492 [13:19:35<3:30:05, 114.59s/it] 78%|███████▊  | 383/492 [13:21:30<3:28:19, 114.67s/it] 78%|███████▊  | 384/492 [13:23:25<3:26:28, 114.71s/it] 78%|███████▊  | 385/492 [13:25:20<3:24:37, 114.74s/it]                                                        78%|███████▊  | 385/492 [13:25:20<3:24:37, 114.74s/it] 78%|███████▊  | 386/492 [13:27:14<3:22:25, 114.58s/it] 79%|███████▊  | 387/492 [13:29:09<3:20:35, 114.62s/it] 79%|███████▉  | 388/492 [13:31:04<3:19:05, 114.86s/it] 79%|███████▉  | 389/492 [13:32:59<3:16:59, 114.76s/it] 79%|███████▉  | 390/492 [13:34:54<3:15:12, 114.83s/it]                                                        79%|███████▉  | 390/492 [13:34:54<3:15:12, 114.83s/it] 79%|███████▉  | 391/492 [13:36:49<3:13:22, 114.88s/it] 80%|███████▉  | 392/492 [13:38:43<3:11:19, 114.80s/it] 80%|███████▉  | 393/492 [13:40:38<3:09:17, 114.72s/it] 80%|████████  | 394/492 [13:42:32<3:07:01, 114.50s/it] 80%|████████  | 395/492 [13:44:27<3:05:13, 114.57s/it]                                                        80%|████████  | 395/492 [13:44:27<3:05:13, 114.57s/it] 80%|████████  | 396/492 [13:46:21<3:03:03, 114.42s/it] 81%|████████  | 397/492 [13:48:15<3:01:06, 114.39s/it] 81%|████████  | 398/492 [13:50:09<2:59:10, 114.37s/it] 81%|████████  | 399/492 [13:52:04<2:57:18, 114.39s/it] 81%|████████▏ | 400/492 [13:53:58<2:55:14, 114.29s/it]                                                        81%|████████▏ | 400/492 [13:53:58<2:55:14, 114.29s/it]{'eval_loss': 0.11036123335361481, 'eval_runtime': 577.777, 'eval_samples_per_second': 1.731, 'eval_steps_per_second': 0.216, 'epoch': 2.84}
{'loss': 0.0921, 'grad_norm': 0.06635326892137527, 'learning_rate': 2.1889952770883643e-05, 'epoch': 2.88}
{'loss': 0.0785, 'grad_norm': 0.06318895518779755, 'learning_rate': 2.043849824442124e-05, 'epoch': 2.92}
{'loss': 0.0868, 'grad_norm': 0.09163162112236023, 'learning_rate': 1.9024375265982384e-05, 'epoch': 2.96}
{'loss': 0.0842, 'grad_norm': 0.07665061205625534, 'learning_rate': 1.764936965146773e-05, 'epoch': 3.01}
{'loss': 0.0819, 'grad_norm': 0.06518320739269257, 'learning_rate': 1.631521781767214e-05, 'epoch': 3.05}
{'loss': 0.0729, 'grad_norm': 0.06743030995130539, 'learning_rate': 1.502360458946232e-05, 'epoch': 3.09}
{'loss': 0.0903, 'grad_norm': 0.07401350885629654, 'learning_rate': 1.3776161072106702e-05, 'epoch': 3.13}
{'loss': 0.0867, 'grad_norm': 0.07385122030973434, 'learning_rate': 1.257446259144494e-05, 'epoch': 3.17}
{'loss': 0.0815, 'grad_norm': 0.06651349365711212, 'learning_rate': 1.1420026704498077e-05, 'epoch': 3.21}
{'loss': 0.0702, 'grad_norm': 0.06250081211328506, 'learning_rate': 1.031431128303153e-05, 'epoch': 3.25}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.34s/it][A
  2%|▏         | 3/125 [00:09<06:37,  3.26s/it][A
  3%|▎         | 4/125 [00:13<07:32,  3.74s/it][A
  4%|▍         | 5/125 [00:18<08:02,  4.02s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.22s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.33s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.41s/it][A
  7%|▋         | 9/125 [00:36<08:40,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:39,  4.52s/it][A
  9%|▉         | 11/125 [00:45<08:37,  4.54s/it][A
 10%|▉         | 12/125 [00:50<08:34,  4.55s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.63s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.61s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.60s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:55,  4.61s/it][A
 18%|█▊        | 23/125 [01:41<07:50,  4.62s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:42,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.61s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.61s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.62s/it][A
 26%|██▌       | 32/125 [02:22<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.62s/it][A
 27%|██▋       | 34/125 [02:32<07:01,  4.63s/it][A
 28%|██▊       | 35/125 [02:36<06:55,  4.62s/it][A
 29%|██▉       | 36/125 [02:41<06:50,  4.62s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:40,  4.61s/it][A
 31%|███       | 39/125 [02:55<06:35,  4.60s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:26,  4.60s/it][A
 34%|███▎      | 42/125 [03:09<06:21,  4.59s/it][A
 34%|███▍      | 43/125 [03:13<06:18,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:12,  4.60s/it][A
 36%|███▌      | 45/125 [03:22<06:08,  4.60s/it][A
 37%|███▋      | 46/125 [03:27<06:02,  4.59s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.62s/it][A
 39%|███▉      | 49/125 [03:41<05:51,  4.62s/it][A
 40%|████      | 50/125 [03:45<05:46,  4.63s/it][A
 41%|████      | 51/125 [03:50<05:43,  4.65s/it][A
 42%|████▏     | 52/125 [03:55<05:40,  4.67s/it][A
 42%|████▏     | 53/125 [03:59<05:35,  4.65s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.63s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:18,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:14,  4.63s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.63s/it][A
 47%|████▋     | 59/125 [04:27<05:04,  4.62s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:36<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:50,  4.62s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.62s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.62s/it][A
 53%|█████▎    | 66/125 [04:59<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:25,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:21,  4.59s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.58s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.59s/it][A
 57%|█████▋    | 71/125 [05:22<04:09,  4.61s/it][A
 58%|█████▊    | 72/125 [05:27<04:03,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:36<03:55,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.65s/it][A
 62%|██████▏   | 77/125 [05:50<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:04<03:30,  4.67s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.66s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:18<03:14,  4.62s/it][A
 67%|██████▋   | 84/125 [06:23<03:09,  4.61s/it][A
 68%|██████▊   | 85/125 [06:27<03:04,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:41<02:51,  4.65s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.63s/it][A
 73%|███████▎  | 91/125 [06:55<02:37,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:04<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:09<02:23,  4.62s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.64s/it][A
 77%|███████▋  | 96/125 [07:18<02:14,  4.62s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.61s/it][A
 78%|███████▊  | 98/125 [07:27<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.60s/it][A
 81%|████████  | 101/125 [07:41<01:50,  4.60s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.61s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.62s/it][A
 83%|████████▎ | 104/125 [07:55<01:37,  4.64s/it][A
 84%|████████▍ | 105/125 [08:00<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.64s/it][A
 86%|████████▌ | 107/125 [08:09<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.65s/it][A
 87%|████████▋ | 109/125 [08:18<01:14,  4.63s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.62s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.62s/it][A
 90%|████████▉ | 112/125 [08:32<01:00,  4.62s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.62s/it][A
 91%|█████████ | 114/125 [08:41<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.61s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.61s/it][A
 94%|█████████▎| 117/125 [08:55<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:09<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.61s/it][A
 98%|█████████▊| 122/125 [09:18<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.61s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.62s/it][A
100%|██████████| 125/125 [09:32<00:00,  4.62s/it][A                                                       
                                                 [A 81%|████████▏ | 400/492 [14:03:35<2:55:14, 114.29s/it]
100%|██████████| 125/125 [09:33<00:00,  4.62s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-400)... Done. 10.9s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 82%|████████▏ | 401/492 [14:05:53<7:26:30, 294.40s/it] 82%|████████▏ | 402/492 [14:07:47<6:00:36, 240.40s/it] 82%|████████▏ | 403/492 [14:09:42<5:00:50, 202.82s/it] 82%|████████▏ | 404/492 [14:11:36<4:18:25, 176.20s/it] 82%|████████▏ | 405/492 [14:13:31<3:48:44, 157.75s/it]                                                        82%|████████▏ | 405/492 [14:13:31<3:48:44, 157.75s/it] 83%|████████▎ | 406/492 [14:15:26<3:27:40, 144.89s/it] 83%|████████▎ | 407/492 [14:17:20<3:12:17, 135.73s/it] 83%|████████▎ | 408/492 [14:19:14<3:01:02, 129.32s/it] 83%|████████▎ | 409/492 [14:21:09<2:52:55, 125.00s/it] 83%|████████▎ | 410/492 [14:23:04<2:46:30, 121.83s/it]                                                        83%|████████▎ | 410/492 [14:23:04<2:46:30, 121.83s/it] 84%|████████▎ | 411/492 [14:24:59<2:41:47, 119.84s/it] 84%|████████▎ | 412/492 [14:26:53<2:37:39, 118.24s/it] 84%|████████▍ | 413/492 [14:28:48<2:34:19, 117.21s/it] 84%|████████▍ | 414/492 [14:30:43<2:31:14, 116.34s/it] 84%|████████▍ | 415/492 [14:32:37<2:28:42, 115.87s/it]                                                        84%|████████▍ | 415/492 [14:32:37<2:28:42, 115.87s/it] 85%|████████▍ | 416/492 [14:34:32<2:26:18, 115.51s/it] 85%|████████▍ | 417/492 [14:36:27<2:24:04, 115.26s/it] 85%|████████▍ | 418/492 [14:38:21<2:21:44, 114.93s/it] 85%|████████▌ | 419/492 [14:40:16<2:19:49, 114.92s/it] 85%|████████▌ | 420/492 [14:42:10<2:17:39, 114.71s/it]                                                        85%|████████▌ | 420/492 [14:42:10<2:17:39, 114.71s/it] 86%|████████▌ | 421/492 [14:44:04<2:15:31, 114.53s/it] 86%|████████▌ | 422/492 [14:45:58<2:13:23, 114.33s/it] 86%|████████▌ | 423/492 [14:47:52<2:11:28, 114.33s/it] 86%|████████▌ | 424/492 [14:49:47<2:09:38, 114.39s/it] 86%|████████▋ | 425/492 [14:51:42<2:07:58, 114.61s/it]                                                        86%|████████▋ | 425/492 [14:51:42<2:07:58, 114.61s/it] 87%|████████▋ | 426/492 [14:53:37<2:06:11, 114.72s/it] 87%|████████▋ | 427/492 [14:55:32<2:04:14, 114.69s/it] 87%|████████▋ | 428/492 [14:57:26<2:02:10, 114.54s/it] 87%|████████▋ | 429/492 [14:59:20<2:00:18, 114.59s/it] 87%|████████▋ | 430/492 [15:01:15<1:58:20, 114.52s/it]                                                        87%|████████▋ | 430/492 [15:01:15<1:58:20, 114.52s/it] 88%|████████▊ | 431/492 [15:03:09<1:56:17, 114.39s/it] 88%|████████▊ | 432/492 [15:05:03<1:54:21, 114.36s/it] 88%|████████▊ | 433/492 [15:06:58<1:52:38, 114.55s/it] 88%|████████▊ | 434/492 [15:08:53<1:50:41, 114.50s/it] 88%|████████▊ | 435/492 [15:10:47<1:48:51, 114.58s/it]                                                        88%|████████▊ | 435/492 [15:10:47<1:48:51, 114.58s/it] 89%|████████▊ | 436/492 [15:12:42<1:46:51, 114.50s/it] 89%|████████▉ | 437/492 [15:14:36<1:44:58, 114.53s/it] 89%|████████▉ | 438/492 [15:16:31<1:43:03, 114.51s/it] 89%|████████▉ | 439/492 [15:18:25<1:41:00, 114.35s/it] 89%|████████▉ | 440/492 [15:20:19<1:39:06, 114.36s/it]                                                        89%|████████▉ | 440/492 [15:20:19<1:39:06, 114.36s/it] 90%|████████▉ | 441/492 [15:22:14<1:37:17, 114.47s/it] 90%|████████▉ | 442/492 [15:24:08<1:35:17, 114.34s/it] 90%|█████████ | 443/492 [15:26:02<1:33:23, 114.36s/it] 90%|█████████ | 444/492 [15:27:57<1:31:30, 114.38s/it] 90%|█████████ | 445/492 [15:29:51<1:29:40, 114.47s/it]                                                        90%|█████████ | 445/492 [15:29:51<1:29:40, 114.47s/it] 91%|█████████ | 446/492 [15:31:46<1:27:45, 114.47s/it] 91%|█████████ | 447/492 [15:33:40<1:25:50, 114.45s/it] 91%|█████████ | 448/492 [15:35:35<1:23:54, 114.41s/it] 91%|█████████▏| 449/492 [15:37:30<1:22:08, 114.62s/it] 91%|█████████▏| 450/492 [15:39:24<1:20:16, 114.69s/it]                                                        91%|█████████▏| 450/492 [15:39:24<1:20:16, 114.69s/it]{'eval_loss': 0.11043216288089752, 'eval_runtime': 577.4688, 'eval_samples_per_second': 1.732, 'eval_steps_per_second': 0.216, 'epoch': 3.25}
{'loss': 0.0826, 'grad_norm': 0.0696023628115654, 'learning_rate': 9.258712672491415e-06, 'epoch': 3.29}
{'loss': 0.0775, 'grad_norm': 0.06600358337163925, 'learning_rate': 8.254563928638893e-06, 'epoch': 3.33}
{'loss': 0.0875, 'grad_norm': 0.06653475761413574, 'learning_rate': 7.3031331341093915e-06, 'epoch': 3.37}
{'loss': 0.0793, 'grad_norm': 0.05932833254337311, 'learning_rate': 6.405621797022848e-06, 'epoch': 3.41}
{'loss': 0.0759, 'grad_norm': 0.06918617337942123, 'learning_rate': 5.563163333667099e-06, 'epoch': 3.45}
{'loss': 0.0821, 'grad_norm': 0.07110767066478729, 'learning_rate': 4.776821637170526e-06, 'epoch': 3.49}
{'loss': 0.0778, 'grad_norm': 0.061374176293611526, 'learning_rate': 4.047589733971646e-06, 'epoch': 3.53}
{'loss': 0.0741, 'grad_norm': 0.06456020474433899, 'learning_rate': 3.376388529782215e-06, 'epoch': 3.57}
{'loss': 0.0753, 'grad_norm': 0.07185477763414383, 'learning_rate': 2.7640656466274782e-06, 'epoch': 3.61}
{'loss': 0.0775, 'grad_norm': 0.06696159392595291, 'learning_rate': 2.2113943524323167e-06, 'epoch': 3.65}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:48,  2.35s/it][A
  2%|▏         | 3/125 [00:09<06:38,  3.27s/it][A
  3%|▎         | 4/125 [00:13<07:33,  3.75s/it][A
  4%|▍         | 5/125 [00:18<08:03,  4.03s/it][A
  5%|▍         | 6/125 [00:22<08:22,  4.23s/it][A
  6%|▌         | 7/125 [00:27<08:31,  4.34s/it][A
  6%|▋         | 8/125 [00:32<08:36,  4.42s/it][A
  7%|▋         | 9/125 [00:36<08:41,  4.49s/it][A
  8%|▊         | 10/125 [00:41<08:40,  4.52s/it][A
  9%|▉         | 11/125 [00:46<08:38,  4.55s/it][A
 10%|▉         | 12/125 [00:50<08:34,  4.56s/it][A
 10%|█         | 13/125 [00:55<08:32,  4.58s/it][A
 11%|█         | 14/125 [00:59<08:32,  4.62s/it][A
 12%|█▏        | 15/125 [01:04<08:28,  4.62s/it][A
 13%|█▎        | 16/125 [01:09<08:23,  4.62s/it][A
 14%|█▎        | 17/125 [01:13<08:18,  4.61s/it][A
 14%|█▍        | 18/125 [01:18<08:13,  4.61s/it][A
 15%|█▌        | 19/125 [01:22<08:08,  4.61s/it][A
 16%|█▌        | 20/125 [01:27<08:03,  4.60s/it][A
 17%|█▋        | 21/125 [01:32<07:59,  4.61s/it][A
 18%|█▊        | 22/125 [01:36<07:55,  4.61s/it][A
 18%|█▊        | 23/125 [01:41<07:50,  4.62s/it][A
 19%|█▉        | 24/125 [01:46<07:46,  4.62s/it][A
 20%|██        | 25/125 [01:50<07:43,  4.63s/it][A
 21%|██        | 26/125 [01:55<07:36,  4.61s/it][A
 22%|██▏       | 27/125 [01:59<07:32,  4.62s/it][A
 22%|██▏       | 28/125 [02:04<07:27,  4.62s/it][A
 23%|██▎       | 29/125 [02:09<07:22,  4.61s/it][A
 24%|██▍       | 30/125 [02:13<07:19,  4.63s/it][A
 25%|██▍       | 31/125 [02:18<07:14,  4.62s/it][A
 26%|██▌       | 32/125 [02:23<07:08,  4.61s/it][A
 26%|██▋       | 33/125 [02:27<07:05,  4.62s/it][A
 27%|██▋       | 34/125 [02:32<07:01,  4.63s/it][A
 28%|██▊       | 35/125 [02:36<06:55,  4.62s/it][A
 29%|██▉       | 36/125 [02:41<06:51,  4.62s/it][A
 30%|██▉       | 37/125 [02:46<06:46,  4.62s/it][A
 30%|███       | 38/125 [02:50<06:41,  4.61s/it][A
 31%|███       | 39/125 [02:55<06:36,  4.61s/it][A
 32%|███▏      | 40/125 [02:59<06:31,  4.61s/it][A
 33%|███▎      | 41/125 [03:04<06:26,  4.61s/it][A
 34%|███▎      | 42/125 [03:09<06:21,  4.60s/it][A
 34%|███▍      | 43/125 [03:13<06:19,  4.62s/it][A
 35%|███▌      | 44/125 [03:18<06:13,  4.61s/it][A
 36%|███▌      | 45/125 [03:22<06:08,  4.61s/it][A
 37%|███▋      | 46/125 [03:27<06:03,  4.60s/it][A
 38%|███▊      | 47/125 [03:32<05:58,  4.60s/it][A
 38%|███▊      | 48/125 [03:36<05:55,  4.62s/it][A
 39%|███▉      | 49/125 [03:41<05:51,  4.63s/it][A
 40%|████      | 50/125 [03:46<05:47,  4.63s/it][A
 41%|████      | 51/125 [03:50<05:44,  4.65s/it][A
 42%|████▏     | 52/125 [03:55<05:41,  4.67s/it][A
 42%|████▏     | 53/125 [04:00<05:35,  4.66s/it][A
 43%|████▎     | 54/125 [04:04<05:29,  4.64s/it][A
 44%|████▍     | 55/125 [04:09<05:24,  4.63s/it][A
 45%|████▍     | 56/125 [04:13<05:19,  4.62s/it][A
 46%|████▌     | 57/125 [04:18<05:15,  4.63s/it][A
 46%|████▋     | 58/125 [04:23<05:10,  4.63s/it][A
 47%|████▋     | 59/125 [04:27<05:05,  4.62s/it][A
 48%|████▊     | 60/125 [04:32<05:00,  4.62s/it][A
 49%|████▉     | 61/125 [04:37<04:56,  4.63s/it][A
 50%|████▉     | 62/125 [04:41<04:51,  4.62s/it][A
 50%|█████     | 63/125 [04:46<04:46,  4.62s/it][A
 51%|█████     | 64/125 [04:50<04:41,  4.62s/it][A
 52%|█████▏    | 65/125 [04:55<04:37,  4.62s/it][A
 53%|█████▎    | 66/125 [05:00<04:31,  4.60s/it][A
 54%|█████▎    | 67/125 [05:04<04:25,  4.59s/it][A
 54%|█████▍    | 68/125 [05:09<04:21,  4.59s/it][A
 55%|█████▌    | 69/125 [05:13<04:16,  4.59s/it][A
 56%|█████▌    | 70/125 [05:18<04:12,  4.59s/it][A
 57%|█████▋    | 71/125 [05:23<04:09,  4.62s/it][A
 58%|█████▊    | 72/125 [05:27<04:03,  4.60s/it][A
 58%|█████▊    | 73/125 [05:32<04:00,  4.62s/it][A
 59%|█████▉    | 74/125 [05:37<03:56,  4.63s/it][A
 60%|██████    | 75/125 [05:41<03:52,  4.65s/it][A
 61%|██████    | 76/125 [05:46<03:48,  4.66s/it][A
 62%|██████▏   | 77/125 [05:51<03:43,  4.65s/it][A
 62%|██████▏   | 78/125 [05:55<03:38,  4.64s/it][A
 63%|██████▎   | 79/125 [06:00<03:34,  4.66s/it][A
 64%|██████▍   | 80/125 [06:05<03:30,  4.68s/it][A
 65%|██████▍   | 81/125 [06:09<03:25,  4.67s/it][A
 66%|██████▌   | 82/125 [06:14<03:19,  4.65s/it][A
 66%|██████▋   | 83/125 [06:18<03:14,  4.62s/it][A
 67%|██████▋   | 84/125 [06:23<03:09,  4.61s/it][A
 68%|██████▊   | 85/125 [06:28<03:04,  4.60s/it][A
 69%|██████▉   | 86/125 [06:32<02:59,  4.60s/it][A
 70%|██████▉   | 87/125 [06:37<02:55,  4.62s/it][A
 70%|███████   | 88/125 [06:42<02:51,  4.65s/it][A
 71%|███████   | 89/125 [06:46<02:47,  4.65s/it][A
 72%|███████▏  | 90/125 [06:51<02:42,  4.63s/it][A
 73%|███████▎  | 91/125 [06:55<02:37,  4.65s/it][A
 74%|███████▎  | 92/125 [07:00<02:32,  4.62s/it][A
 74%|███████▍  | 93/125 [07:05<02:27,  4.60s/it][A
 75%|███████▌  | 94/125 [07:09<02:23,  4.63s/it][A
 76%|███████▌  | 95/125 [07:14<02:19,  4.65s/it][A
 77%|███████▋  | 96/125 [07:19<02:14,  4.63s/it][A
 78%|███████▊  | 97/125 [07:23<02:09,  4.62s/it][A
 78%|███████▊  | 98/125 [07:28<02:04,  4.61s/it][A
 79%|███████▉  | 99/125 [07:32<02:00,  4.62s/it][A
 80%|████████  | 100/125 [07:37<01:55,  4.61s/it][A
 81%|████████  | 101/125 [07:42<01:50,  4.61s/it][A
 82%|████████▏ | 102/125 [07:46<01:46,  4.62s/it][A
 82%|████████▏ | 103/125 [07:51<01:41,  4.63s/it][A
 83%|████████▎ | 104/125 [07:56<01:37,  4.65s/it][A
 84%|████████▍ | 105/125 [08:00<01:33,  4.66s/it][A
 85%|████████▍ | 106/125 [08:05<01:28,  4.65s/it][A
 86%|████████▌ | 107/125 [08:10<01:23,  4.64s/it][A
 86%|████████▋ | 108/125 [08:14<01:19,  4.66s/it][A
 87%|████████▋ | 109/125 [08:19<01:14,  4.64s/it][A
 88%|████████▊ | 110/125 [08:23<01:09,  4.63s/it][A
 89%|████████▉ | 111/125 [08:28<01:04,  4.63s/it][A
 90%|████████▉ | 112/125 [08:33<01:00,  4.63s/it][A
 90%|█████████ | 113/125 [08:37<00:55,  4.63s/it][A
 91%|█████████ | 114/125 [08:42<00:50,  4.60s/it][A
 92%|█████████▏| 115/125 [08:46<00:46,  4.62s/it][A
 93%|█████████▎| 116/125 [08:51<00:41,  4.62s/it][A
 94%|█████████▎| 117/125 [08:56<00:37,  4.63s/it][A
 94%|█████████▍| 118/125 [09:00<00:32,  4.63s/it][A
 95%|█████████▌| 119/125 [09:05<00:27,  4.64s/it][A
 96%|█████████▌| 120/125 [09:10<00:23,  4.62s/it][A
 97%|█████████▋| 121/125 [09:14<00:18,  4.61s/it][A
 98%|█████████▊| 122/125 [09:19<00:13,  4.60s/it][A
 98%|█████████▊| 123/125 [09:23<00:09,  4.62s/it][A
 99%|█████████▉| 124/125 [09:28<00:04,  4.63s/it][A
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A                                                       
                                                 [A 91%|█████████▏| 450/492 [15:49:02<1:20:16, 114.69s/it]
100%|██████████| 125/125 [09:33<00:00,  4.63s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-450)... Done. 11.2s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 92%|█████████▏| 451/492 [15:51:20<3:21:34, 295.00s/it] 92%|█████████▏| 452/492 [15:53:15<2:40:34, 240.87s/it] 92%|█████████▏| 453/492 [15:55:09<2:11:48, 202.78s/it] 92%|█████████▏| 454/492 [15:57:03<1:51:37, 176.24s/it] 92%|█████████▏| 455/492 [15:58:57<1:37:10, 157.57s/it]                                                        92%|█████████▏| 455/492 [15:58:57<1:37:10, 157.57s/it] 93%|█████████▎| 456/492 [16:00:51<1:26:46, 144.61s/it] 93%|█████████▎| 457/492 [16:02:45<1:18:59, 135.42s/it] 93%|█████████▎| 458/492 [16:04:39<1:13:05, 128.97s/it] 93%|█████████▎| 459/492 [16:06:34<1:08:34, 124.68s/it] 93%|█████████▎| 460/492 [16:08:29<1:04:53, 121.66s/it]                                                        93%|█████████▎| 460/492 [16:08:29<1:04:53, 121.66s/it] 94%|█████████▎| 461/492 [16:10:23<1:01:45, 119.52s/it] 94%|█████████▍| 462/492 [16:12:17<58:58, 117.94s/it]   94%|█████████▍| 463/492 [16:14:11<56:26, 116.77s/it] 94%|█████████▍| 464/492 [16:16:06<54:13, 116.21s/it] 95%|█████████▍| 465/492 [16:18:01<52:01, 115.63s/it]                                                      95%|█████████▍| 465/492 [16:18:01<52:01, 115.63s/it] 95%|█████████▍| 466/492 [16:19:55<49:59, 115.35s/it] 95%|█████████▍| 467/492 [16:21:50<48:00, 115.20s/it] 95%|█████████▌| 468/492 [16:23:45<45:59, 114.97s/it] 95%|█████████▌| 469/492 [16:25:39<43:59, 114.76s/it] 96%|█████████▌| 470/492 [16:27:33<42:02, 114.64s/it]                                                      96%|█████████▌| 470/492 [16:27:33<42:02, 114.64s/it] 96%|█████████▌| 471/492 [16:29:28<40:07, 114.64s/it] 96%|█████████▌| 472/492 [16:31:22<38:11, 114.55s/it] 96%|█████████▌| 473/492 [16:33:17<36:17, 114.62s/it] 96%|█████████▋| 474/492 [16:35:12<34:23, 114.66s/it] 97%|█████████▋| 475/492 [16:37:06<32:26, 114.52s/it]                                                      97%|█████████▋| 475/492 [16:37:06<32:26, 114.52s/it] 97%|█████████▋| 476/492 [16:39:00<30:30, 114.39s/it] 97%|█████████▋| 477/492 [16:40:54<28:36, 114.44s/it] 97%|█████████▋| 478/492 [16:42:49<26:42, 114.44s/it] 97%|█████████▋| 479/492 [16:44:43<24:46, 114.32s/it] 98%|█████████▊| 480/492 [16:46:38<22:53, 114.46s/it]                                                      98%|█████████▊| 480/492 [16:46:38<22:53, 114.46s/it] 98%|█████████▊| 481/492 [16:48:33<21:00, 114.61s/it] 98%|█████████▊| 482/492 [16:50:27<19:06, 114.63s/it] 98%|█████████▊| 483/492 [16:52:22<17:10, 114.49s/it] 98%|█████████▊| 484/492 [16:54:16<15:14, 114.33s/it] 99%|█████████▊| 485/492 [16:56:10<13:20, 114.42s/it]                                                      99%|█████████▊| 485/492 [16:56:10<13:20, 114.42s/it] 99%|█████████▉| 486/492 [16:58:04<11:26, 114.38s/it] 99%|█████████▉| 487/492 [16:59:59<09:31, 114.32s/it] 99%|█████████▉| 488/492 [17:01:53<07:36, 114.23s/it] 99%|█████████▉| 489/492 [17:03:47<05:42, 114.19s/it]100%|█████████▉| 490/492 [17:05:41<03:48, 114.18s/it]                                                     100%|█████████▉| 490/492 [17:05:41<03:48, 114.18s/it]100%|█████████▉| 491/492 [17:07:35<01:54, 114.11s/it]100%|██████████| 492/492 [17:09:29<00:00, 114.16s/it]/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_sft_no_err/checkpoints-by_file-09-07-09-00/checkpoint-492)... Done. 10.9s
                                                     100%|██████████| 492/492 [17:09:58<00:00, 114.16s/it]/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
{'eval_loss': 0.10999426990747452, 'eval_runtime': 577.8937, 'eval_samples_per_second': 1.73, 'eval_steps_per_second': 0.216, 'epoch': 3.65}
{'loss': 0.0776, 'grad_norm': 0.0635673850774765, 'learning_rate': 1.7190725845048827e-06, 'epoch': 3.7}
{'loss': 0.0783, 'grad_norm': 0.0663626566529274, 'learning_rate': 1.2877220681510927e-06, 'epoch': 3.74}
{'loss': 0.0799, 'grad_norm': 0.06013369560241699, 'learning_rate': 9.178875315329183e-07, 'epoch': 3.78}
{'loss': 0.0812, 'grad_norm': 0.06789083778858185, 'learning_rate': 6.100360177619946e-07, 'epoch': 3.82}
{'loss': 0.0812, 'grad_norm': 0.061911556869745255, 'learning_rate': 3.6455629509730136e-07, 'epoch': 3.86}
{'loss': 0.0857, 'grad_norm': 0.07562973350286484, 'learning_rate': 1.8175836599173546e-07, 'epoch': 3.9}
{'loss': 0.0814, 'grad_norm': 0.07261495292186737, 'learning_rate': 6.187307560754363e-08, 'epoch': 3.94}
{'loss': 0.0747, 'grad_norm': 0.06521088629961014, 'learning_rate': 5.051820295032261e-09, 'epoch': 3.98}
{'train_runtime': 61805.4601, 'train_samples_per_second': 0.51, 'train_steps_per_second': 0.008, 'train_loss': 0.3780014820518048, 'epoch': 4.0}
Finetuning finished.
wandb: - 31912.322 MB of 31912.322 MB uploaded (39.675 MB deduped)wandb: \ 31912.322 MB of 31912.322 MB uploaded (39.675 MB deduped)wandb: | 31912.322 MB of 31912.322 MB uploaded (39.675 MB deduped)wandb: / 31912.322 MB of 31912.322 MB uploaded (39.675 MB deduped)wandb: - 31912.322 MB of 31912.361 MB uploaded (39.675 MB deduped)wandb: \ 31912.361 MB of 31912.361 MB uploaded (39.675 MB deduped)wandb: 
wandb: Run history:
wandb:               eval/loss █▄▃▂▂▁▁▁▁
wandb:            eval/runtime ▁▁▁▇█▇▆▅▇
wandb: eval/samples_per_second ▇█▇▁▁▁▂▄▁
wandb:   eval/steps_per_second ███▁▁▁▁▁▁
wandb:             train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:         train/grad_norm █▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     train/learning_rate ▂▃▄▇███████▇▇▇▇▆▆▆▆▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁
wandb:              train/loss █▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:                eval/loss 0.10999
wandb:             eval/runtime 577.8937
wandb:  eval/samples_per_second 1.73
wandb:    eval/steps_per_second 0.216
wandb:               total_flos 3.138580840489943e+18
wandb:              train/epoch 3.99594
wandb:        train/global_step 492
wandb:          train/grad_norm 0.06521
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.0747
wandb:               train_loss 0.378
wandb:            train_runtime 61805.4601
wandb: train_samples_per_second 0.51
wandb:   train_steps_per_second 0.008
wandb: 
wandb: 🚀 View run deepseek_prover_sft_no_err-by_file-09-07-09-00 at: https://wandb.ai/tcwong/decoder/runs/1zf05eyd
wandb: ⭐️ View project at: https://wandb.ai/tcwong/decoder
wandb: Synced 5 W&B file(s), 0 media file(s), 111 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240907_090121-1zf05eyd/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
