nohup: ignoring input
Finetuning starting.
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]Downloading shards:  50%|█████     | 1/2 [00:55<00:55, 55.74s/it]Downloading shards: 100%|██████████| 2/2 [01:29<00:00, 42.93s/it]Downloading shards: 100%|██████████| 2/2 [01:29<00:00, 44.85s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.15s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.23s/it]
trainable params: 10,644,480 || all params: 6,901,373,952 || trainable%: 0.1542
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 7876 examples [00:00, 14434.27 examples/s]Generating train split: 7876 examples [00:00, 14247.11 examples/s]
Generating valid split: 0 examples [00:00, ? examples/s]Generating valid split: 1000 examples [00:00, 8554.27 examples/s]Generating valid split: 1000 examples [00:00, 8443.00 examples/s]
Map:   0%|          | 0/7876 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7876 [00:00<00:05, 1210.52 examples/s]Map:  25%|██▌       | 2000/7876 [00:01<00:04, 1258.13 examples/s]Map:  38%|███▊      | 3000/7876 [00:02<00:03, 1291.35 examples/s]Map:  51%|█████     | 4000/7876 [00:03<00:02, 1304.70 examples/s]Map:  63%|██████▎   | 5000/7876 [00:03<00:02, 1333.37 examples/s]Map:  76%|███████▌  | 6000/7876 [00:04<00:01, 1352.64 examples/s]Map:  89%|████████▉ | 7000/7876 [00:05<00:00, 1358.42 examples/s]Map: 100%|██████████| 7876/7876 [00:05<00:00, 1332.38 examples/s]Map: 100%|██████████| 7876/7876 [00:05<00:00, 1317.98 examples/s]
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1351.60 examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1322.60 examples/s]
[2024-09-07 08:59:35,058] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
df: /root/.triton/autotune: No such file or directory
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
wandb: Currently logged in as: tcwong. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.7
wandb: Run data is saved locally in /workspace/wandb/run-20240907_085950-qzthc60s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deepseek_prover_base_no_err-by_file-09-07-08-59
wandb: ⭐️ View project at https://wandb.ai/tcwong/decoder
wandb: 🚀 View run at https://wandb.ai/tcwong/decoder/runs/qzthc60s
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
  0%|          | 0/492 [00:00<?, ?it/s]W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0] Graph break from `Tensor.item()`, consider setting:
W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0]     torch._dynamo.config.capture_scalar_outputs = True
W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0] or:
W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0] to include these operations in the captured graph.
W0907 09:00:04.391000 128164618101184 torch/_dynamo/variables/tensor.py:715] [17/0] 
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/492 [02:24<19:43:56, 144.68s/it]  0%|          | 2/492 [04:14<16:52:12, 123.94s/it]  1%|          | 3/492 [06:07<16:11:26, 119.20s/it]  1%|          | 4/492 [08:00<15:49:55, 116.79s/it]  1%|          | 5/492 [09:53<15:36:52, 115.43s/it]                                                     1%|          | 5/492 [09:53<15:36:52, 115.43s/it]  1%|          | 6/492 [11:46<15:28:31, 114.63s/it]  1%|▏         | 7/492 [13:39<15:21:07, 113.95s/it]  2%|▏         | 8/492 [15:32<15:18:08, 113.82s/it]  2%|▏         | 9/492 [17:26<15:14:53, 113.65s/it]  2%|▏         | 10/492 [19:18<15:10:44, 113.37s/it]                                                      2%|▏         | 10/492 [19:18<15:10:44, 113.37s/it]  2%|▏         | 11/492 [21:12<15:10:18, 113.55s/it]  2%|▏         | 12/492 [23:05<15:06:07, 113.27s/it]  3%|▎         | 13/492 [24:58<15:04:17, 113.27s/it]  3%|▎         | 14/492 [26:53<15:05:59, 113.72s/it]  3%|▎         | 15/492 [28:46<15:01:47, 113.43s/it]                                                      3%|▎         | 15/492 [28:46<15:01:47, 113.43s/it]  3%|▎         | 16/492 [30:39<14:59:26, 113.38s/it]  3%|▎         | 17/492 [32:32<14:56:25, 113.23s/it]  4%|▎         | 18/492 [34:25<14:54:11, 113.19s/it]  4%|▍         | 19/492 [36:18<14:52:37, 113.23s/it]  4%|▍         | 20/492 [38:12<14:50:28, 113.20s/it]                                                      4%|▍         | 20/492 [38:12<14:50:28, 113.20s/it]  4%|▍         | 21/492 [40:05<14:48:55, 113.24s/it]  4%|▍         | 22/492 [41:58<14:46:19, 113.15s/it]  5%|▍         | 23/492 [43:51<14:43:56, 113.08s/it]  5%|▍         | 24/492 [45:44<14:42:49, 113.18s/it]  5%|▌         | 25/492 [47:37<14:40:44, 113.16s/it]                                                      5%|▌         | 25/492 [47:37<14:40:44, 113.16s/it]  5%|▌         | 26/492 [49:31<14:39:30, 113.24s/it]  5%|▌         | 27/492 [51:24<14:38:05, 113.30s/it]  6%|▌         | 28/492 [53:18<14:36:24, 113.33s/it]  6%|▌         | 29/492 [55:11<14:35:16, 113.43s/it]  6%|▌         | 30/492 [57:04<14:32:40, 113.33s/it]                                                      6%|▌         | 30/492 [57:04<14:32:40, 113.33s/it]  6%|▋         | 31/492 [58:57<14:29:25, 113.16s/it]  7%|▋         | 32/492 [1:00:50<14:27:27, 113.15s/it]  7%|▋         | 33/492 [1:02:44<14:26:18, 113.24s/it]  7%|▋         | 34/492 [1:04:37<14:24:23, 113.24s/it]  7%|▋         | 35/492 [1:06:30<14:22:16, 113.21s/it]                                                        7%|▋         | 35/492 [1:06:30<14:22:16, 113.21s/it]  7%|▋         | 36/492 [1:08:23<14:20:35, 113.24s/it]  8%|▊         | 37/492 [1:10:16<14:18:00, 113.14s/it]  8%|▊         | 38/492 [1:12:10<14:16:39, 113.21s/it]  8%|▊         | 39/492 [1:14:03<14:14:12, 113.14s/it]  8%|▊         | 40/492 [1:15:56<14:12:58, 113.23s/it]                                                        8%|▊         | 40/492 [1:15:56<14:12:58, 113.23s/it]  8%|▊         | 41/492 [1:17:49<14:10:24, 113.14s/it]  9%|▊         | 42/492 [1:19:42<14:07:57, 113.06s/it]  9%|▊         | 43/492 [1:21:35<14:06:49, 113.16s/it]  9%|▉         | 44/492 [1:23:29<14:05:16, 113.21s/it]  9%|▉         | 45/492 [1:25:22<14:03:15, 113.19s/it]                                                        9%|▉         | 45/492 [1:25:22<14:03:15, 113.19s/it]  9%|▉         | 46/492 [1:27:15<14:01:12, 113.17s/it] 10%|▉         | 47/492 [1:29:09<14:00:38, 113.34s/it] 10%|▉         | 48/492 [1:31:02<13:58:55, 113.37s/it] 10%|▉         | 49/492 [1:32:55<13:56:58, 113.36s/it] 10%|█         | 50/492 [1:34:48<13:54:39, 113.30s/it]                                                       10%|█         | 50/492 [1:34:48<13:54:39, 113.30s/it]{'loss': 15.6138, 'grad_norm': 113.10508728027344, 'learning_rate': 1e-05, 'epoch': 0.04}
{'loss': 11.7959, 'grad_norm': 114.42933654785156, 'learning_rate': 2e-05, 'epoch': 0.08}
{'loss': 3.0499, 'grad_norm': 33.93031311035156, 'learning_rate': 3e-05, 'epoch': 0.12}
{'loss': 0.1854, 'grad_norm': 0.41336098313331604, 'learning_rate': 4e-05, 'epoch': 0.16}
{'loss': 0.8857, 'grad_norm': 0.4682806432247162, 'learning_rate': 5e-05, 'epoch': 0.2}
{'loss': 0.4888, 'grad_norm': 506.6198425292969, 'learning_rate': 6e-05, 'epoch': 0.24}
{'loss': 0.2279, 'grad_norm': 0.2869759202003479, 'learning_rate': 7e-05, 'epoch': 0.28}
{'loss': 0.1661, 'grad_norm': 0.18190807104110718, 'learning_rate': 8e-05, 'epoch': 0.32}
{'loss': 0.1575, 'grad_norm': 0.09090979397296906, 'learning_rate': 9e-05, 'epoch': 0.37}
{'loss': 0.1569, 'grad_norm': 0.14082124829292297, 'learning_rate': 0.0001, 'epoch': 0.41}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:20,  2.12s/it][A
  2%|▏         | 3/125 [00:08<06:19,  3.11s/it][A
  3%|▎         | 4/125 [00:13<07:19,  3.63s/it][A
  4%|▍         | 5/125 [00:17<07:52,  3.94s/it][A
  5%|▍         | 6/125 [00:22<08:13,  4.14s/it][A
  6%|▌         | 7/125 [00:26<08:23,  4.27s/it][A
  6%|▋         | 8/125 [00:31<08:29,  4.35s/it][A
  7%|▋         | 9/125 [00:35<08:33,  4.43s/it][A
  8%|▊         | 10/125 [00:40<08:33,  4.46s/it][A
  9%|▉         | 11/125 [00:45<08:31,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:28,  4.50s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.52s/it][A
 11%|█         | 14/125 [00:58<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:07<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:21<08:02,  4.56s/it][A
 16%|█▌        | 20/125 [01:26<07:57,  4.55s/it][A
 17%|█▋        | 21/125 [01:30<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:39<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:36,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:02<07:21,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.55s/it][A
 24%|██▍       | 30/125 [02:11<07:13,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.56s/it][A
 26%|██▌       | 32/125 [02:20<07:03,  4.56s/it][A
 26%|██▋       | 33/125 [02:25<07:00,  4.57s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.57s/it][A
 28%|██▊       | 35/125 [02:34<06:50,  4.56s/it][A
 29%|██▉       | 36/125 [02:39<06:45,  4.56s/it][A
 30%|██▉       | 37/125 [02:43<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:52<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.55s/it][A
 33%|███▎      | 41/125 [03:01<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.54s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:15<06:08,  4.55s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:24<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:33<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:42<05:42,  4.57s/it][A
 41%|████      | 51/125 [03:47<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:56<05:30,  4.59s/it][A
 43%|████▎     | 54/125 [04:01<05:24,  4.58s/it][A
 44%|████▍     | 55/125 [04:05<05:20,  4.57s/it][A
 45%|████▍     | 56/125 [04:10<05:14,  4.56s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.57s/it][A
 46%|████▋     | 58/125 [04:19<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.57s/it][A
 48%|████▊     | 60/125 [04:28<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:37<04:47,  4.56s/it][A
 50%|█████     | 63/125 [04:42<04:43,  4.57s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.57s/it][A
 52%|█████▏    | 65/125 [04:51<04:34,  4.57s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.55s/it][A
 54%|█████▎    | 67/125 [05:00<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:09<04:13,  4.54s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:18<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:27<03:57,  4.57s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.60s/it][A
 61%|██████    | 76/125 [05:41<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:50<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:55<03:31,  4.59s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:04<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:13<03:11,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:06,  4.56s/it][A
 68%|██████▊   | 85/125 [06:22<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.57s/it][A
 70%|███████   | 88/125 [06:36<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:45<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:35,  4.59s/it][A
 74%|███████▎  | 92/125 [06:54<02:30,  4.57s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:08<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:17<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:26<01:58,  4.57s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.56s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:40<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:49<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.59s/it][A
 86%|████████▌ | 107/125 [08:03<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.60s/it][A
 87%|████████▋ | 109/125 [08:12<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:21<01:03,  4.57s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:35<00:50,  4.55s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.56s/it][A
 93%|█████████▎| 116/125 [08:44<00:40,  4.56s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:53<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:02<00:22,  4.56s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:16<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:25<00:00,  4.57s/it][A                                                      
                                                 [A 10%|█         | 50/492 [1:44:19<13:54:39, 113.30s/it]
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-50)... Done. 8.3s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 10%|█         | 51/492 [1:46:32<35:34:00, 290.34s/it] 11%|█         | 52/492 [1:48:25<28:58:58, 237.13s/it] 11%|█         | 53/492 [1:50:18<24:21:55, 199.81s/it] 11%|█         | 54/492 [1:52:11<21:09:18, 173.88s/it] 11%|█         | 55/492 [1:54:04<18:52:55, 155.55s/it]                                                       11%|█         | 55/492 [1:54:04<18:52:55, 155.55s/it] 11%|█▏        | 56/492 [1:55:57<17:17:49, 142.82s/it] 12%|█▏        | 57/492 [1:57:50<16:10:48, 133.90s/it] 12%|█▏        | 58/492 [1:59:43<15:23:33, 127.68s/it] 12%|█▏        | 59/492 [2:01:36<14:50:02, 123.33s/it] 12%|█▏        | 60/492 [2:03:29<14:25:29, 120.21s/it]                                                       12%|█▏        | 60/492 [2:03:29<14:25:29, 120.21s/it] 12%|█▏        | 61/492 [2:05:22<14:07:30, 117.98s/it] 13%|█▎        | 62/492 [2:07:15<13:54:15, 116.41s/it] 13%|█▎        | 63/492 [2:09:08<13:45:09, 115.41s/it] 13%|█▎        | 64/492 [2:11:01<13:38:39, 114.77s/it] 13%|█▎        | 65/492 [2:12:55<13:34:22, 114.43s/it]                                                       13%|█▎        | 65/492 [2:12:55<13:34:22, 114.43s/it] 13%|█▎        | 66/492 [2:14:48<13:30:18, 114.13s/it] 14%|█▎        | 67/492 [2:16:42<13:27:46, 114.04s/it] 14%|█▍        | 68/492 [2:18:35<13:24:05, 113.79s/it] 14%|█▍        | 69/492 [2:20:29<13:21:18, 113.66s/it] 14%|█▍        | 70/492 [2:22:22<13:18:17, 113.50s/it]                                                       14%|█▍        | 70/492 [2:22:22<13:18:17, 113.50s/it] 14%|█▍        | 71/492 [2:24:15<13:15:36, 113.39s/it] 15%|█▍        | 72/492 [2:26:09<13:14:21, 113.48s/it] 15%|█▍        | 73/492 [2:28:02<13:11:37, 113.36s/it] 15%|█▌        | 74/492 [2:29:55<13:09:59, 113.40s/it] 15%|█▌        | 75/492 [2:31:48<13:07:27, 113.30s/it]                                                       15%|█▌        | 75/492 [2:31:48<13:07:27, 113.30s/it] 15%|█▌        | 76/492 [2:33:41<13:05:21, 113.27s/it] 16%|█▌        | 77/492 [2:35:34<13:02:21, 113.11s/it] 16%|█▌        | 78/492 [2:37:27<13:00:50, 113.17s/it] 16%|█▌        | 79/492 [2:39:20<12:58:39, 113.12s/it] 16%|█▋        | 80/492 [2:41:14<12:57:38, 113.25s/it]                                                       16%|█▋        | 80/492 [2:41:14<12:57:38, 113.25s/it] 16%|█▋        | 81/492 [2:43:07<12:54:26, 113.06s/it] 17%|█▋        | 82/492 [2:45:00<12:53:46, 113.24s/it] 17%|█▋        | 83/492 [2:46:53<12:51:04, 113.12s/it] 17%|█▋        | 84/492 [2:48:46<12:49:30, 113.16s/it] 17%|█▋        | 85/492 [2:50:41<12:50:31, 113.59s/it]                                                       17%|█▋        | 85/492 [2:50:41<12:50:31, 113.59s/it] 17%|█▋        | 86/492 [2:52:34<12:47:52, 113.48s/it] 18%|█▊        | 87/492 [2:54:27<12:45:41, 113.43s/it] 18%|█▊        | 88/492 [2:56:21<12:43:12, 113.35s/it] 18%|█▊        | 89/492 [2:58:13<12:40:14, 113.19s/it] 18%|█▊        | 90/492 [3:00:06<12:37:47, 113.10s/it]                                                       18%|█▊        | 90/492 [3:00:06<12:37:47, 113.10s/it] 18%|█▊        | 91/492 [3:01:59<12:35:12, 113.00s/it] 19%|█▊        | 92/492 [3:03:52<12:33:38, 113.05s/it] 19%|█▉        | 93/492 [3:05:46<12:32:44, 113.19s/it] 19%|█▉        | 94/492 [3:07:38<12:29:52, 113.05s/it] 19%|█▉        | 95/492 [3:09:31<12:27:44, 113.01s/it]                                                       19%|█▉        | 95/492 [3:09:31<12:27:44, 113.01s/it] 20%|█▉        | 96/492 [3:11:25<12:26:35, 113.12s/it] 20%|█▉        | 97/492 [3:13:18<12:24:14, 113.05s/it] 20%|█▉        | 98/492 [3:15:11<12:21:58, 112.99s/it] 20%|██        | 99/492 [3:17:04<12:20:03, 112.99s/it] 20%|██        | 100/492 [3:18:57<12:19:01, 113.12s/it]                                                        20%|██        | 100/492 [3:18:57<12:19:01, 113.12s/it]{'eval_loss': 0.16598469018936157, 'eval_runtime': 571.0235, 'eval_samples_per_second': 1.751, 'eval_steps_per_second': 0.219, 'epoch': 0.41}
{'loss': 0.15, 'grad_norm': 1.0748934745788574, 'learning_rate': 9.996842891446092e-05, 'epoch': 0.45}
{'loss': 0.1498, 'grad_norm': 0.09886147826910019, 'learning_rate': 9.987375552718133e-05, 'epoch': 0.49}
{'loss': 0.1499, 'grad_norm': 0.07677606493234634, 'learning_rate': 9.971609939582557e-05, 'epoch': 0.53}
{'loss': 0.1631, 'grad_norm': 0.26791003346443176, 'learning_rate': 9.9495659615402e-05, 'epoch': 0.57}
{'loss': 0.1535, 'grad_norm': 0.07558655738830566, 'learning_rate': 9.921271456683715e-05, 'epoch': 0.61}
{'loss': 0.1454, 'grad_norm': 0.04132043197751045, 'learning_rate': 9.886762156542428e-05, 'epoch': 0.65}
{'loss': 0.1372, 'grad_norm': 0.03367358446121216, 'learning_rate': 9.846081640959007e-05, 'epoch': 0.69}
{'loss': 0.1411, 'grad_norm': 0.05775720626115799, 'learning_rate': 9.79928128305494e-05, 'epoch': 0.73}
{'loss': 0.1369, 'grad_norm': 0.05461897701025009, 'learning_rate': 9.746420184354334e-05, 'epoch': 0.77}
{'loss': 0.1422, 'grad_norm': 0.03982888534665108, 'learning_rate': 9.687565100147939e-05, 'epoch': 0.81}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:33,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.70s/it][A
  4%|▍         | 5/125 [00:18<07:57,  3.98s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.17s/it][A
  6%|▌         | 7/125 [00:27<08:26,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:35,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.50s/it][A
 10%|▉         | 12/125 [00:50<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.53s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:21<08:02,  4.55s/it][A
 16%|█▌        | 20/125 [01:26<07:57,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:53,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:37,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:22,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.56s/it][A
 24%|██▍       | 30/125 [02:12<07:14,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.57s/it][A
 26%|██▌       | 32/125 [02:21<07:03,  4.56s/it][A
 26%|██▋       | 33/125 [02:25<07:00,  4.57s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.57s/it][A
 28%|██▊       | 35/125 [02:35<06:50,  4.57s/it][A
 29%|██▉       | 36/125 [02:39<06:46,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.55s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.55s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:15<06:08,  4.55s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:42,  4.57s/it][A
 41%|████      | 51/125 [03:48<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:30,  4.60s/it][A
 43%|████▎     | 54/125 [04:01<05:25,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.58s/it][A
 45%|████▍     | 56/125 [04:10<05:15,  4.57s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.58s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.57s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.57s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.56s/it][A
 52%|█████▏    | 65/125 [04:52<04:33,  4.57s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.55s/it][A
 54%|█████▎    | 67/125 [05:01<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:14,  4.54s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.57s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.60s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:56<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:11,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:07,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.56s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:35,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.57s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.56s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.55s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:41<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.58s/it][A
 86%|████████▌ | 107/125 [08:04<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.59s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.57s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.56s/it][A
 91%|█████████ | 114/125 [08:35<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:45<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:54<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:03<00:22,  4.56s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:17<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A                                                       
                                                 [A 20%|██        | 100/492 [3:28:28<12:19:01, 113.12s/it]
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-100)... Done. 9.5s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 21%|██        | 101/492 [3:30:43<31:35:41, 290.90s/it] 21%|██        | 102/492 [3:32:35<25:43:26, 237.45s/it] 21%|██        | 103/492 [3:34:29<21:38:03, 200.21s/it] 21%|██        | 104/492 [3:36:22<18:46:20, 174.18s/it] 21%|██▏       | 105/492 [3:38:15<16:45:08, 155.84s/it]                                                        21%|██▏       | 105/492 [3:38:15<16:45:08, 155.84s/it] 22%|██▏       | 106/492 [3:40:09<15:20:43, 143.12s/it] 22%|██▏       | 107/492 [3:42:02<14:20:52, 134.16s/it] 22%|██▏       | 108/492 [3:43:55<13:38:08, 127.83s/it] 22%|██▏       | 109/492 [3:45:48<13:07:24, 123.35s/it] 22%|██▏       | 110/492 [3:47:42<12:47:21, 120.53s/it]                                                        22%|██▏       | 110/492 [3:47:42<12:47:21, 120.53s/it] 23%|██▎       | 111/492 [3:49:35<12:30:57, 118.26s/it] 23%|██▎       | 112/492 [3:51:28<12:19:40, 116.79s/it] 23%|██▎       | 113/492 [3:53:22<12:11:20, 115.78s/it] 23%|██▎       | 114/492 [3:55:15<12:04:19, 114.97s/it] 23%|██▎       | 115/492 [3:57:08<12:00:13, 114.63s/it]                                                        23%|██▎       | 115/492 [3:57:08<12:00:13, 114.63s/it] 24%|██▎       | 116/492 [3:59:02<11:55:46, 114.22s/it] 24%|██▍       | 117/492 [4:00:55<11:52:15, 113.96s/it] 24%|██▍       | 118/492 [4:02:48<11:48:34, 113.67s/it] 24%|██▍       | 119/492 [4:04:41<11:45:00, 113.41s/it] 24%|██▍       | 120/492 [4:06:34<11:42:38, 113.33s/it]                                                        24%|██▍       | 120/492 [4:06:34<11:42:38, 113.33s/it] 25%|██▍       | 121/492 [4:08:27<11:40:17, 113.25s/it] 25%|██▍       | 122/492 [4:10:20<11:38:33, 113.28s/it] 25%|██▌       | 123/492 [4:12:14<11:36:33, 113.26s/it]/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 25%|██▌       | 124/492 [4:14:13<11:46:37, 115.21s/it] 25%|██▌       | 125/492 [4:16:06<11:40:41, 114.56s/it]                                                        25%|██▌       | 125/492 [4:16:06<11:40:41, 114.56s/it] 26%|██▌       | 126/492 [4:17:59<11:35:45, 114.06s/it] 26%|██▌       | 127/492 [4:19:53<11:32:29, 113.83s/it] 26%|██▌       | 128/492 [4:21:46<11:29:36, 113.67s/it] 26%|██▌       | 129/492 [4:23:39<11:26:19, 113.44s/it] 26%|██▋       | 130/492 [4:25:32<11:24:13, 113.41s/it]                                                        26%|██▋       | 130/492 [4:25:32<11:24:13, 113.41s/it] 27%|██▋       | 131/492 [4:27:25<11:22:06, 113.37s/it] 27%|██▋       | 132/492 [4:29:19<11:19:45, 113.29s/it] 27%|██▋       | 133/492 [4:31:12<11:17:26, 113.22s/it] 27%|██▋       | 134/492 [4:33:05<11:15:04, 113.14s/it] 27%|██▋       | 135/492 [4:34:58<11:13:13, 113.15s/it]                                                        27%|██▋       | 135/492 [4:34:58<11:13:13, 113.15s/it] 28%|██▊       | 136/492 [4:36:51<11:11:13, 113.13s/it] 28%|██▊       | 137/492 [4:38:44<11:10:05, 113.26s/it] 28%|██▊       | 138/492 [4:40:38<11:08:24, 113.29s/it] 28%|██▊       | 139/492 [4:42:31<11:07:13, 113.41s/it] 28%|██▊       | 140/492 [4:44:25<11:05:09, 113.38s/it]                                                        28%|██▊       | 140/492 [4:44:25<11:05:09, 113.38s/it] 29%|██▊       | 141/492 [4:46:18<11:03:00, 113.34s/it] 29%|██▉       | 142/492 [4:48:11<11:00:36, 113.25s/it] 29%|██▉       | 143/492 [4:50:04<10:57:51, 113.10s/it] 29%|██▉       | 144/492 [4:51:57<10:56:42, 113.23s/it] 29%|██▉       | 145/492 [4:53:50<10:54:35, 113.19s/it]                                                        29%|██▉       | 145/492 [4:53:50<10:54:35, 113.19s/it] 30%|██▉       | 146/492 [4:55:43<10:51:42, 113.01s/it] 30%|██▉       | 147/492 [4:57:36<10:49:09, 112.90s/it] 30%|███       | 148/492 [4:59:29<10:47:17, 112.90s/it] 30%|███       | 149/492 [5:01:22<10:45:38, 112.94s/it] 30%|███       | 150/492 [5:03:15<10:45:18, 113.21s/it]                                                        30%|███       | 150/492 [5:03:15<10:45:18, 113.21s/it]{'eval_loss': 0.15572066605091095, 'eval_runtime': 570.7773, 'eval_samples_per_second': 1.752, 'eval_steps_per_second': 0.219, 'epoch': 0.81}
{'loss': 0.1396, 'grad_norm': 0.049296505749225616, 'learning_rate': 9.622790355191672e-05, 'epoch': 0.85}
{'loss': 0.1466, 'grad_norm': 0.04366493597626686, 'learning_rate': 9.552177749846083e-05, 'epoch': 0.89}
{'loss': 0.1421, 'grad_norm': 0.0475134439766407, 'learning_rate': 9.475816456775313e-05, 'epoch': 0.93}
{'loss': 0.137, 'grad_norm': 0.044564343988895416, 'learning_rate': 9.393802908335977e-05, 'epoch': 0.97}
{'loss': 0.1442, 'grad_norm': 0.04059167578816414, 'learning_rate': 9.306240674798203e-05, 'epoch': 1.02}
{'loss': 0.1362, 'grad_norm': 0.0424371100962162, 'learning_rate': 9.213240333552589e-05, 'epoch': 1.06}
{'loss': 0.1351, 'grad_norm': 0.059122174978256226, 'learning_rate': 9.114919329468282e-05, 'epoch': 1.1}
{'loss': 0.1404, 'grad_norm': 0.06440797448158264, 'learning_rate': 9.011401826578492e-05, 'epoch': 1.14}
{'loss': 0.1258, 'grad_norm': 0.044413380324840546, 'learning_rate': 8.902818551280758e-05, 'epoch': 1.18}
{'loss': 0.1238, 'grad_norm': 0.06735623627901077, 'learning_rate': 8.789306627249985e-05, 'epoch': 1.22}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:33,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.71s/it][A
  4%|▍         | 5/125 [00:18<07:58,  3.99s/it][A
  5%|▍         | 6/125 [00:22<08:17,  4.18s/it][A
  6%|▌         | 7/125 [00:27<08:26,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:35,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.50s/it][A
 10%|▉         | 12/125 [00:50<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:27,  4.53s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.55s/it][A
 15%|█▌        | 19/125 [01:22<08:02,  4.56s/it][A
 16%|█▌        | 20/125 [01:26<07:58,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:37,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:22,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.55s/it][A
 24%|██▍       | 30/125 [02:12<07:14,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.57s/it][A
 26%|██▌       | 32/125 [02:21<07:04,  4.56s/it][A
 26%|██▋       | 33/125 [02:25<07:00,  4.57s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.58s/it][A
 28%|██▊       | 35/125 [02:35<06:51,  4.57s/it][A
 29%|██▉       | 36/125 [02:39<06:46,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.55s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.55s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:16<06:08,  4.55s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:43,  4.57s/it][A
 41%|████      | 51/125 [03:48<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:31,  4.60s/it][A
 43%|████▎     | 54/125 [04:01<05:25,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.58s/it][A
 45%|████▍     | 56/125 [04:10<05:15,  4.57s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.58s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.57s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.56s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.57s/it][A
 52%|█████▏    | 65/125 [04:52<04:34,  4.57s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.55s/it][A
 54%|█████▎    | 67/125 [05:01<04:23,  4.54s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:13,  4.53s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.56s/it][A
 59%|█████▉    | 74/125 [05:33<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.59s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:56<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:11,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:06,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.57s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:35,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.57s/it][A
 74%|███████▍  | 93/125 [07:00<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.56s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.55s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:41<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.59s/it][A
 86%|████████▌ | 107/125 [08:04<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.59s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.56s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:36<00:53,  4.83s/it][A
 92%|█████████▏| 115/125 [08:41<00:47,  4.77s/it][A
 93%|█████████▎| 116/125 [08:46<00:42,  4.71s/it][A
 94%|█████████▎| 117/125 [08:50<00:37,  4.68s/it][A
 94%|█████████▍| 118/125 [08:55<00:32,  4.64s/it][A
 95%|█████████▌| 119/125 [08:59<00:27,  4.63s/it][A
 96%|█████████▌| 120/125 [09:04<00:23,  4.60s/it][A
 97%|█████████▋| 121/125 [09:08<00:18,  4.59s/it][A
 98%|█████████▊| 122/125 [09:13<00:13,  4.57s/it][A
 98%|█████████▊| 123/125 [09:18<00:09,  4.58s/it][A
 99%|█████████▉| 124/125 [09:22<00:04,  4.58s/it][A
100%|██████████| 125/125 [09:27<00:00,  4.58s/it][A                                                       
                                                 [A 30%|███       | 150/492 [5:12:47<10:45:18, 113.21s/it]
100%|██████████| 125/125 [09:27<00:00,  4.58s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-150)... Done. 15.6s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 31%|███       | 151/492 [5:15:08<27:44:39, 292.90s/it] 31%|███       | 152/492 [5:17:01<22:34:22, 239.01s/it] 31%|███       | 153/492 [5:18:54<18:56:29, 201.15s/it] 31%|███▏      | 154/492 [5:20:47<16:24:11, 174.71s/it] 32%|███▏      | 155/492 [5:22:40<14:37:57, 156.31s/it]                                                        32%|███▏      | 155/492 [5:22:40<14:37:57, 156.31s/it] 32%|███▏      | 156/492 [5:24:33<13:22:33, 143.31s/it] 32%|███▏      | 157/492 [5:26:26<12:29:21, 134.21s/it] 32%|███▏      | 158/492 [5:28:19<11:51:56, 127.90s/it] 32%|███▏      | 159/492 [5:30:12<11:25:00, 123.42s/it] 33%|███▎      | 160/492 [5:32:05<11:05:44, 120.31s/it]                                                        33%|███▎      | 160/492 [5:32:05<11:05:44, 120.31s/it] 33%|███▎      | 161/492 [5:33:59<10:52:07, 118.21s/it] 33%|███▎      | 162/492 [5:35:52<10:42:50, 116.88s/it] 33%|███▎      | 163/492 [5:37:46<10:35:45, 115.94s/it] 33%|███▎      | 164/492 [5:39:39<10:29:30, 115.16s/it] 34%|███▎      | 165/492 [5:41:32<10:24:04, 114.51s/it]                                                        34%|███▎      | 165/492 [5:41:32<10:24:04, 114.51s/it] 34%|███▎      | 166/492 [5:43:25<10:19:46, 114.07s/it] 34%|███▍      | 167/492 [5:45:18<10:16:09, 113.75s/it] 34%|███▍      | 168/492 [5:47:11<10:12:31, 113.43s/it] 34%|███▍      | 169/492 [5:49:04<10:10:29, 113.41s/it] 35%|███▍      | 170/492 [5:50:58<10:08:14, 113.34s/it]                                                        35%|███▍      | 170/492 [5:50:58<10:08:14, 113.34s/it] 35%|███▍      | 171/492 [5:52:51<10:06:18, 113.33s/it] 35%|███▍      | 172/492 [5:54:44<10:04:02, 113.26s/it] 35%|███▌      | 173/492 [5:56:37<10:01:34, 113.15s/it] 35%|███▌      | 174/492 [5:58:30<10:00:20, 113.27s/it] 36%|███▌      | 175/492 [6:00:24<9:59:08, 113.40s/it]                                                        36%|███▌      | 175/492 [6:00:24<9:59:08, 113.40s/it] 36%|███▌      | 176/492 [6:02:18<9:57:12, 113.39s/it] 36%|███▌      | 177/492 [6:04:11<9:54:52, 113.31s/it] 36%|███▌      | 178/492 [6:06:04<9:53:34, 113.42s/it] 36%|███▋      | 179/492 [6:07:57<9:51:04, 113.30s/it] 37%|███▋      | 180/492 [6:09:50<9:48:19, 113.14s/it]                                                       37%|███▋      | 180/492 [6:09:50<9:48:19, 113.14s/it] 37%|███▋      | 181/492 [6:11:43<9:46:15, 113.10s/it] 37%|███▋      | 182/492 [6:13:37<9:44:55, 113.21s/it] 37%|███▋      | 183/492 [6:15:30<9:42:41, 113.15s/it] 37%|███▋      | 184/492 [6:17:23<9:41:38, 113.31s/it] 38%|███▊      | 185/492 [6:19:17<9:39:49, 113.32s/it]                                                       38%|███▊      | 185/492 [6:19:17<9:39:49, 113.32s/it] 38%|███▊      | 186/492 [6:21:10<9:37:58, 113.33s/it] 38%|███▊      | 187/492 [6:23:03<9:35:21, 113.19s/it] 38%|███▊      | 188/492 [6:24:56<9:33:25, 113.18s/it] 38%|███▊      | 189/492 [6:26:49<9:31:33, 113.18s/it] 39%|███▊      | 190/492 [6:28:43<9:29:55, 113.23s/it]                                                       39%|███▊      | 190/492 [6:28:43<9:29:55, 113.23s/it] 39%|███▉      | 191/492 [6:30:36<9:29:02, 113.43s/it] 39%|███▉      | 192/492 [6:32:30<9:26:44, 113.35s/it] 39%|███▉      | 193/492 [6:34:23<9:25:06, 113.40s/it] 39%|███▉      | 194/492 [6:36:16<9:22:20, 113.22s/it] 40%|███▉      | 195/492 [6:38:09<9:20:12, 113.17s/it]                                                       40%|███▉      | 195/492 [6:38:09<9:20:12, 113.17s/it] 40%|███▉      | 196/492 [6:40:03<9:19:10, 113.35s/it] 40%|████      | 197/492 [6:41:56<9:17:32, 113.40s/it] 40%|████      | 198/492 [6:43:50<9:15:32, 113.37s/it] 40%|████      | 199/492 [6:45:43<9:13:15, 113.30s/it] 41%|████      | 200/492 [6:47:36<9:10:58, 113.21s/it]                                                       41%|████      | 200/492 [6:47:36<9:10:58, 113.21s/it]{'eval_loss': 0.15116116404533386, 'eval_runtime': 571.8633, 'eval_samples_per_second': 1.749, 'eval_steps_per_second': 0.219, 'epoch': 1.22}
{'loss': 0.1319, 'grad_norm': 0.05769121274352074, 'learning_rate': 8.6710094022727e-05, 'epoch': 1.26}
{'loss': 0.1232, 'grad_norm': 0.048896849155426025, 'learning_rate': 8.548076267221256e-05, 'epoch': 1.3}
{'loss': 0.1397, 'grad_norm': 0.0718092992901802, 'learning_rate': 8.420662467396547e-05, 'epoch': 1.34}
{'loss': 0.121, 'grad_norm': 0.054730452597141266, 'learning_rate': 8.288928906477496e-05, 'epoch': 1.38}
{'loss': 0.1358, 'grad_norm': 0.08080842345952988, 'learning_rate': 8.15304194332491e-05, 'epoch': 1.42}
{'loss': 0.1347, 'grad_norm': 0.05518824979662895, 'learning_rate': 8.013173181896283e-05, 'epoch': 1.46}
{'loss': 0.1386, 'grad_norm': 0.07823627442121506, 'learning_rate': 7.869499254536865e-05, 'epoch': 1.5}
{'loss': 0.1261, 'grad_norm': 0.08264634758234024, 'learning_rate': 7.722201598920673e-05, 'epoch': 1.54}
{'loss': 0.1338, 'grad_norm': 0.06334514170885086, 'learning_rate': 7.571466228923115e-05, 'epoch': 1.58}
{'loss': 0.1306, 'grad_norm': 0.06367149949073792, 'learning_rate': 7.417483499714589e-05, 'epoch': 1.62}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:33,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.70s/it][A
  4%|▍         | 5/125 [00:18<07:58,  3.98s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.18s/it][A
  6%|▌         | 7/125 [00:27<08:26,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:35,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.49s/it][A
 10%|▉         | 12/125 [00:50<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.53s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:22<08:02,  4.56s/it][A
 16%|█▌        | 20/125 [01:26<07:57,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:36,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:22,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.55s/it][A
 24%|██▍       | 30/125 [02:12<07:14,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.56s/it][A
 26%|██▌       | 32/125 [02:21<07:03,  4.55s/it][A
 26%|██▋       | 33/125 [02:25<07:00,  4.57s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.57s/it][A
 28%|██▊       | 35/125 [02:35<06:51,  4.57s/it][A
 29%|██▉       | 36/125 [02:39<06:46,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.56s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.55s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:16<06:09,  4.56s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.56s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:43,  4.57s/it][A
 41%|████      | 51/125 [03:48<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:31,  4.60s/it][A
 43%|████▎     | 54/125 [04:01<05:25,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.58s/it][A
 45%|████▍     | 56/125 [04:10<05:15,  4.57s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.57s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.57s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.56s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.56s/it][A
 52%|█████▏    | 65/125 [04:52<04:33,  4.56s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.54s/it][A
 54%|█████▎    | 67/125 [05:01<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:13,  4.53s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.56s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.59s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:56<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.61s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:12,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:07,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.57s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.57s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.57s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.55s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:41<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.59s/it][A
 86%|████████▌ | 107/125 [08:04<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.60s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.57s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:35<00:50,  4.55s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.56s/it][A
 93%|█████████▎| 116/125 [08:45<00:41,  4.56s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:54<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:03<00:22,  4.57s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:17<00:09,  4.57s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:26<00:00,  4.58s/it][A                                                      
                                                 [A 41%|████      | 200/492 [6:57:07<9:10:58, 113.21s/it]
100%|██████████| 125/125 [09:26<00:00,  4.58s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-200)... Done. 9.3s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 41%|████      | 201/492 [6:59:19<23:27:56, 290.30s/it] 41%|████      | 202/492 [7:01:13<19:06:55, 237.30s/it] 41%|████▏     | 203/492 [7:03:06<16:03:48, 200.10s/it] 41%|████▏     | 204/492 [7:04:59<13:55:24, 174.04s/it] 42%|████▏     | 205/492 [7:06:53<12:25:29, 155.85s/it]                                                        42%|████▏     | 205/492 [7:06:53<12:25:29, 155.85s/it] 42%|████▏     | 206/492 [7:08:46<11:21:44, 143.02s/it] 42%|████▏     | 207/492 [7:10:39<10:37:20, 134.18s/it] 42%|████▏     | 208/492 [7:12:32<10:04:48, 127.78s/it] 42%|████▏     | 209/492 [7:14:26<9:42:16, 123.45s/it]  43%|████▎     | 210/492 [7:16:19<9:25:38, 120.35s/it]                                                       43%|████▎     | 210/492 [7:16:19<9:25:38, 120.35s/it] 43%|████▎     | 211/492 [7:18:13<9:14:26, 118.39s/it] 43%|████▎     | 212/492 [7:20:05<9:04:31, 116.68s/it] 43%|████▎     | 213/492 [7:21:59<8:58:12, 115.75s/it] 43%|████▎     | 214/492 [7:23:52<8:52:36, 114.95s/it] 44%|████▎     | 215/492 [7:25:45<8:48:25, 114.46s/it]                                                       44%|████▎     | 215/492 [7:25:45<8:48:25, 114.46s/it] 44%|████▍     | 216/492 [7:27:39<8:45:10, 114.17s/it] 44%|████▍     | 217/492 [7:29:32<8:41:50, 113.86s/it] 44%|████▍     | 218/492 [7:31:26<8:40:33, 113.99s/it] 45%|████▍     | 219/492 [7:33:20<8:38:09, 113.88s/it] 45%|████▍     | 220/492 [7:35:13<8:35:57, 113.81s/it]                                                       45%|████▍     | 220/492 [7:35:13<8:35:57, 113.81s/it] 45%|████▍     | 221/492 [7:37:07<8:33:32, 113.70s/it] 45%|████▌     | 222/492 [7:39:01<8:31:38, 113.70s/it] 45%|████▌     | 223/492 [7:40:54<8:29:13, 113.58s/it] 46%|████▌     | 224/492 [7:42:47<8:26:29, 113.39s/it] 46%|████▌     | 225/492 [7:44:40<8:24:30, 113.37s/it]                                                       46%|████▌     | 225/492 [7:44:40<8:24:30, 113.37s/it] 46%|████▌     | 226/492 [7:46:33<8:22:29, 113.34s/it] 46%|████▌     | 227/492 [7:48:27<8:20:50, 113.40s/it] 46%|████▋     | 228/492 [7:50:21<8:19:20, 113.49s/it] 47%|████▋     | 229/492 [7:52:14<8:16:48, 113.34s/it] 47%|████▋     | 230/492 [7:54:07<8:14:23, 113.22s/it]                                                       47%|████▋     | 230/492 [7:54:07<8:14:23, 113.22s/it] 47%|████▋     | 231/492 [7:55:59<8:12:00, 113.10s/it] 47%|████▋     | 232/492 [7:57:53<8:10:13, 113.13s/it] 47%|████▋     | 233/492 [7:59:46<8:08:48, 113.24s/it] 48%|████▊     | 234/492 [8:01:39<8:06:37, 113.17s/it] 48%|████▊     | 235/492 [8:03:32<8:04:13, 113.05s/it]                                                       48%|████▊     | 235/492 [8:03:32<8:04:13, 113.05s/it] 48%|████▊     | 236/492 [8:05:25<8:02:10, 113.01s/it] 48%|████▊     | 237/492 [8:07:18<8:00:14, 113.00s/it] 48%|████▊     | 238/492 [8:09:11<7:58:33, 113.04s/it] 49%|████▊     | 239/492 [8:11:04<7:56:38, 113.04s/it] 49%|████▉     | 240/492 [8:12:57<7:54:56, 113.08s/it]                                                       49%|████▉     | 240/492 [8:12:57<7:54:56, 113.08s/it] 49%|████▉     | 241/492 [8:14:50<7:52:52, 113.04s/it] 49%|████▉     | 242/492 [8:16:43<7:51:08, 113.07s/it] 49%|████▉     | 243/492 [8:18:36<7:49:21, 113.10s/it] 50%|████▉     | 244/492 [8:20:30<7:47:42, 113.16s/it] 50%|████▉     | 245/492 [8:22:23<7:46:24, 113.30s/it]                                                       50%|████▉     | 245/492 [8:22:23<7:46:24, 113.30s/it] 50%|█████     | 246/492 [8:24:17<7:45:17, 113.48s/it] 50%|█████     | 247/492 [8:26:04<7:35:24, 111.53s/it] 50%|█████     | 248/492 [8:27:58<7:36:34, 112.27s/it] 51%|█████     | 249/492 [8:29:51<7:35:55, 112.58s/it] 51%|█████     | 250/492 [8:31:44<7:34:32, 112.70s/it]                                                       51%|█████     | 250/492 [8:31:44<7:34:32, 112.70s/it]{'eval_loss': 0.1474769562482834, 'eval_runtime': 570.894, 'eval_samples_per_second': 1.752, 'eval_steps_per_second': 0.219, 'epoch': 1.62}
{'loss': 0.1342, 'grad_norm': 0.08058533072471619, 'learning_rate': 7.260447867371709e-05, 'epoch': 1.66}
{'loss': 0.1247, 'grad_norm': 0.07283538579940796, 'learning_rate': 7.100557643309732e-05, 'epoch': 1.71}
{'loss': 0.1278, 'grad_norm': 0.08428559452295303, 'learning_rate': 6.938014743846285e-05, 'epoch': 1.75}
{'loss': 0.1312, 'grad_norm': 0.08377284556627274, 'learning_rate': 6.773024435212678e-05, 'epoch': 1.79}
{'loss': 0.1304, 'grad_norm': 0.10298043489456177, 'learning_rate': 6.605795074334794e-05, 'epoch': 1.83}
{'loss': 0.1303, 'grad_norm': 0.09377053380012512, 'learning_rate': 6.436537845710903e-05, 'epoch': 1.87}
{'loss': 0.1163, 'grad_norm': 0.11010950058698654, 'learning_rate': 6.265466494718732e-05, 'epoch': 1.91}
{'loss': 0.1124, 'grad_norm': 0.17498579621315002, 'learning_rate': 6.092797057688495e-05, 'epoch': 1.95}
{'loss': 0.1193, 'grad_norm': 0.09446436911821365, 'learning_rate': 5.918747589082853e-05, 'epoch': 1.99}
{'loss': 0.1252, 'grad_norm': 0.09566423296928406, 'learning_rate': 5.7435378861282585e-05, 'epoch': 2.03}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:33,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.70s/it][A
  4%|▍         | 5/125 [00:18<07:57,  3.98s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.18s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:35,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.50s/it][A
 10%|▉         | 12/125 [00:49<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.53s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.57s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:22<08:02,  4.56s/it][A
 16%|█▌        | 20/125 [01:26<07:58,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:37,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:22,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.55s/it][A
 24%|██▍       | 30/125 [02:12<07:13,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.57s/it][A
 26%|██▌       | 32/125 [02:21<07:03,  4.56s/it][A
 26%|██▋       | 33/125 [02:25<06:59,  4.56s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.57s/it][A
 28%|██▊       | 35/125 [02:35<06:50,  4.56s/it][A
 29%|██▉       | 36/125 [02:39<06:46,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.55s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.54s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:15<06:08,  4.55s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:42,  4.57s/it][A
 41%|████      | 51/125 [03:47<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:30,  4.59s/it][A
 43%|████▎     | 54/125 [04:01<05:24,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.57s/it][A
 45%|████▍     | 56/125 [04:10<05:15,  4.57s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.57s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.56s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.56s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.56s/it][A
 52%|█████▏    | 65/125 [04:51<04:33,  4.57s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.54s/it][A
 54%|█████▎    | 67/125 [05:00<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:13,  4.53s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.57s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.60s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:55<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:12,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:07,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.57s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:36,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.57s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.57s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.56s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:41<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.59s/it][A
 86%|████████▌ | 107/125 [08:04<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.59s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.56s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:35<00:49,  4.55s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.56s/it][A
 93%|█████████▎| 116/125 [08:45<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:54<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:03<00:22,  4.56s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:17<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A                                                      
                                                 [A 51%|█████     | 250/492 [8:41:15<7:34:32, 112.70s/it]
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-250)... Done. 10.0s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
wandb: WARNING Failed to cache /root/.local/share/wandb/artifacts/staging/tmp1r0le466, ignoring [Errno 28] Insufficient free space in /root/.cache/wandb/artifacts
 51%|█████     | 251/492 [8:43:29<19:26:21, 290.38s/it] 51%|█████     | 252/492 [8:45:22<15:48:38, 237.16s/it] 51%|█████▏    | 253/492 [8:47:15<13:16:16, 199.90s/it] 52%|█████▏    | 254/492 [8:49:08<11:29:22, 173.79s/it] 52%|█████▏    | 255/492 [8:51:01<10:14:26, 155.55s/it]                                                        52%|█████▏    | 255/492 [8:51:01<10:14:26, 155.55s/it] 52%|█████▏    | 256/492 [8:52:54<9:21:54, 142.86s/it]  52%|█████▏    | 257/492 [8:54:48<8:44:33, 133.93s/it] 52%|█████▏    | 258/492 [8:56:41<8:18:40, 127.87s/it] 53%|█████▎    | 259/492 [8:58:34<7:59:17, 123.42s/it] 53%|█████▎    | 260/492 [9:00:28<7:45:52, 120.48s/it]                                                       53%|█████▎    | 260/492 [9:00:28<7:45:52, 120.48s/it] 53%|█████▎    | 261/492 [9:02:22<7:35:52, 118.41s/it] 53%|█████▎    | 262/492 [9:04:15<7:28:07, 116.90s/it] 53%|█████▎    | 263/492 [9:06:08<7:21:40, 115.72s/it] 54%|█████▎    | 264/492 [9:08:01<7:16:54, 114.98s/it] 54%|█████▍    | 265/492 [9:09:54<7:12:56, 114.43s/it]                                                       54%|█████▍    | 265/492 [9:09:54<7:12:56, 114.43s/it] 54%|█████▍    | 266/492 [9:11:48<7:09:41, 114.08s/it] 54%|█████▍    | 267/492 [9:13:41<7:06:37, 113.77s/it] 54%|█████▍    | 268/492 [9:15:34<7:04:43, 113.76s/it] 55%|█████▍    | 269/492 [9:17:27<7:01:51, 113.50s/it] 55%|█████▍    | 270/492 [9:19:20<6:59:11, 113.29s/it]                                                       55%|█████▍    | 270/492 [9:19:20<6:59:11, 113.29s/it] 55%|█████▌    | 271/492 [9:21:13<6:57:05, 113.24s/it] 55%|█████▌    | 272/492 [9:23:06<6:54:50, 113.14s/it] 55%|█████▌    | 273/492 [9:24:59<6:52:56, 113.13s/it] 56%|█████▌    | 274/492 [9:26:52<6:51:13, 113.18s/it] 56%|█████▌    | 275/492 [9:28:46<6:49:21, 113.19s/it]                                                       56%|█████▌    | 275/492 [9:28:46<6:49:21, 113.19s/it] 56%|█████▌    | 276/492 [9:30:39<6:47:35, 113.22s/it] 56%|█████▋    | 277/492 [9:32:32<6:45:37, 113.20s/it] 57%|█████▋    | 278/492 [9:34:26<6:44:02, 113.28s/it] 57%|█████▋    | 279/492 [9:36:19<6:42:19, 113.33s/it] 57%|█████▋    | 280/492 [9:38:12<6:39:57, 113.19s/it]                                                       57%|█████▋    | 280/492 [9:38:12<6:39:57, 113.19s/it] 57%|█████▋    | 281/492 [9:40:05<6:38:11, 113.23s/it] 57%|█████▋    | 282/492 [9:41:58<6:36:08, 113.18s/it] 58%|█████▊    | 283/492 [9:43:53<6:35:48, 113.63s/it] 58%|█████▊    | 284/492 [9:45:46<6:33:32, 113.52s/it] 58%|█████▊    | 285/492 [9:47:39<6:30:56, 113.32s/it]                                                       58%|█████▊    | 285/492 [9:47:39<6:30:56, 113.32s/it] 58%|█████▊    | 286/492 [9:49:32<6:28:25, 113.14s/it] 58%|█████▊    | 287/492 [9:51:25<6:26:32, 113.13s/it] 59%|█████▊    | 288/492 [9:53:18<6:24:59, 113.23s/it] 59%|█████▊    | 289/492 [9:55:11<6:22:42, 113.11s/it] 59%|█████▉    | 290/492 [9:57:04<6:20:37, 113.06s/it]                                                       59%|█████▉    | 290/492 [9:57:04<6:20:37, 113.06s/it] 59%|█████▉    | 291/492 [9:58:57<6:18:17, 112.92s/it] 59%|█████▉    | 292/492 [10:00:50<6:16:40, 113.00s/it] 60%|█████▉    | 293/492 [10:02:42<6:14:21, 112.87s/it] 60%|█████▉    | 294/492 [10:04:36<6:13:00, 113.03s/it] 60%|█████▉    | 295/492 [10:06:29<6:11:37, 113.19s/it]                                                        60%|█████▉    | 295/492 [10:06:29<6:11:37, 113.19s/it] 60%|██████    | 296/492 [10:08:23<6:09:52, 113.23s/it] 60%|██████    | 297/492 [10:10:16<6:08:06, 113.26s/it] 61%|██████    | 298/492 [10:12:10<6:06:26, 113.33s/it] 61%|██████    | 299/492 [10:14:03<6:04:14, 113.24s/it] 61%|██████    | 300/492 [10:15:56<6:02:29, 113.28s/it]                                                        61%|██████    | 300/492 [10:15:56<6:02:29, 113.28s/it]{'eval_loss': 0.14643818140029907, 'eval_runtime': 570.7851, 'eval_samples_per_second': 1.752, 'eval_steps_per_second': 0.219, 'epoch': 2.03}
{'loss': 0.1152, 'grad_norm': 0.10885192453861237, 'learning_rate': 5.567389211245485e-05, 'epoch': 2.07}
{'loss': 0.1248, 'grad_norm': 0.09853996336460114, 'learning_rate': 5.390524012629824e-05, 'epoch': 2.11}
{'loss': 0.1207, 'grad_norm': 0.0892142653465271, 'learning_rate': 5.2131656433338506e-05, 'epoch': 2.15}
{'loss': 0.1143, 'grad_norm': 0.09116163849830627, 'learning_rate': 5.035538079207488e-05, 'epoch': 2.19}
{'loss': 0.1155, 'grad_norm': 0.09667850285768509, 'learning_rate': 4.857865636051585e-05, 'epoch': 2.23}
{'loss': 0.1146, 'grad_norm': 0.1532243937253952, 'learning_rate': 4.6803726863421725e-05, 'epoch': 2.27}
{'loss': 0.111, 'grad_norm': 0.11655127257108688, 'learning_rate': 4.503283375883165e-05, 'epoch': 2.31}
{'loss': 0.1102, 'grad_norm': 0.1412302553653717, 'learning_rate': 4.326821340745304e-05, 'epoch': 2.36}
{'loss': 0.112, 'grad_norm': 0.10279002040624619, 'learning_rate': 4.151209424848819e-05, 'epoch': 2.4}
{'loss': 0.1197, 'grad_norm': 0.08668510615825653, 'learning_rate': 3.976669398546451e-05, 'epoch': 2.44}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:32,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:27,  3.70s/it][A
  4%|▍         | 5/125 [00:18<07:57,  3.98s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.17s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:30,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:34,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.53s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:21<08:02,  4.55s/it][A
 16%|█▌        | 20/125 [01:26<07:57,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:44,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:37,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:21,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:16,  4.55s/it][A
 24%|██▍       | 30/125 [02:12<07:13,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:08,  4.56s/it][A
 26%|██▌       | 32/125 [02:21<07:03,  4.55s/it][A
 26%|██▋       | 33/125 [02:25<06:59,  4.56s/it][A
 27%|██▋       | 34/125 [02:30<06:55,  4.57s/it][A
 28%|██▊       | 35/125 [02:34<06:50,  4.56s/it][A
 29%|██▉       | 36/125 [02:39<06:45,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.56s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.55s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:15<06:08,  4.56s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:42,  4.57s/it][A
 41%|████      | 51/125 [03:47<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:30,  4.60s/it][A
 43%|████▎     | 54/125 [04:01<05:25,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.57s/it][A
 45%|████▍     | 56/125 [04:10<05:14,  4.56s/it][A
 46%|████▌     | 57/125 [04:15<05:10,  4.57s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.57s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.57s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.56s/it][A
 52%|█████▏    | 65/125 [04:51<04:33,  4.57s/it][A
 53%|█████▎    | 66/125 [04:56<04:28,  4.54s/it][A
 54%|█████▎    | 67/125 [05:00<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:13,  4.53s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.56s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.59s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:55<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:11,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:06,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:01,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.56s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:35,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.56s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.59s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.56s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.55s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:40<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.59s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.58s/it][A
 86%|████████▌ | 107/125 [08:03<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.59s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.57s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.56s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:35<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:44<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:54<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:03<00:22,  4.56s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:16<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A                                                       
                                                 [A 61%|██████    | 300/492 [10:25:27<6:02:29, 113.28s/it]
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-300)... Done. 8.4s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
wandb: WARNING Failed to cache /root/.local/share/wandb/artifacts/staging/tmpmk21u_5a, ignoring [Errno 28] Insufficient free space in /root/.cache/wandb/artifacts
 61%|██████    | 301/492 [10:27:40<15:24:32, 290.43s/it] 61%|██████▏   | 302/492 [10:29:33<12:31:17, 237.25s/it] 62%|██████▏   | 303/492 [10:31:27<10:30:30, 200.16s/it] 62%|██████▏   | 304/492 [10:33:20<9:05:32, 174.11s/it]  62%|██████▏   | 305/492 [10:35:13<8:05:59, 155.93s/it]                                                        62%|██████▏   | 305/492 [10:35:13<8:05:59, 155.93s/it] 62%|██████▏   | 306/492 [10:37:06<7:23:15, 142.99s/it] 62%|██████▏   | 307/492 [10:38:59<6:53:25, 134.08s/it] 63%|██████▎   | 308/492 [10:40:53<6:32:19, 127.93s/it] 63%|██████▎   | 309/492 [10:42:46<6:16:41, 123.50s/it] 63%|██████▎   | 310/492 [10:44:39<6:04:50, 120.28s/it]                                                        63%|██████▎   | 310/492 [10:44:39<6:04:50, 120.28s/it] 63%|██████▎   | 311/492 [10:46:32<5:56:20, 118.12s/it] 63%|██████▎   | 312/492 [10:48:25<5:49:37, 116.54s/it] 64%|██████▎   | 313/492 [10:50:18<5:44:47, 115.57s/it] 64%|██████▍   | 314/492 [10:52:12<5:41:00, 114.95s/it] 64%|██████▍   | 315/492 [10:54:04<5:37:03, 114.26s/it]                                                        64%|██████▍   | 315/492 [10:54:04<5:37:03, 114.26s/it] 64%|██████▍   | 316/492 [10:55:58<5:35:00, 114.21s/it] 64%|██████▍   | 317/492 [10:57:51<5:31:48, 113.76s/it] 65%|██████▍   | 318/492 [10:59:44<5:29:26, 113.60s/it] 65%|██████▍   | 319/492 [11:01:38<5:27:20, 113.53s/it] 65%|██████▌   | 320/492 [11:03:31<5:24:55, 113.35s/it]                                                        65%|██████▌   | 320/492 [11:03:31<5:24:55, 113.35s/it] 65%|██████▌   | 321/492 [11:05:24<5:22:44, 113.24s/it] 65%|██████▌   | 322/492 [11:07:16<5:20:24, 113.08s/it] 66%|██████▌   | 323/492 [11:09:09<5:18:21, 113.02s/it] 66%|██████▌   | 324/492 [11:11:02<5:16:31, 113.05s/it] 66%|██████▌   | 325/492 [11:12:56<5:15:08, 113.22s/it]                                                        66%|██████▌   | 325/492 [11:12:56<5:15:08, 113.22s/it] 66%|██████▋   | 326/492 [11:14:49<5:13:22, 113.27s/it] 66%|██████▋   | 327/492 [11:16:42<5:11:02, 113.11s/it] 67%|██████▋   | 328/492 [11:18:35<5:09:03, 113.07s/it] 67%|██████▋   | 329/492 [11:20:28<5:06:46, 112.93s/it] 67%|██████▋   | 330/492 [11:22:21<5:05:26, 113.13s/it]                                                        67%|██████▋   | 330/492 [11:22:21<5:05:26, 113.13s/it] 67%|██████▋   | 331/492 [11:24:15<5:03:39, 113.16s/it] 67%|██████▋   | 332/492 [11:26:08<5:01:56, 113.23s/it] 68%|██████▊   | 333/492 [11:28:01<5:00:06, 113.25s/it] 68%|██████▊   | 334/492 [11:29:54<4:57:57, 113.15s/it] 68%|██████▊   | 335/492 [11:31:48<4:56:13, 113.21s/it]                                                        68%|██████▊   | 335/492 [11:31:48<4:56:13, 113.21s/it] 68%|██████▊   | 336/492 [11:33:40<4:53:56, 113.05s/it] 68%|██████▊   | 337/492 [11:35:34<4:52:26, 113.21s/it] 69%|██████▊   | 338/492 [11:37:27<4:50:35, 113.22s/it] 69%|██████▉   | 339/492 [11:39:20<4:48:38, 113.19s/it] 69%|██████▉   | 340/492 [11:41:13<4:46:46, 113.20s/it]                                                        69%|██████▉   | 340/492 [11:41:13<4:46:46, 113.20s/it] 69%|██████▉   | 341/492 [11:43:07<4:44:57, 113.23s/it] 70%|██████▉   | 342/492 [11:45:00<4:43:03, 113.22s/it] 70%|██████▉   | 343/492 [11:46:53<4:41:06, 113.20s/it] 70%|██████▉   | 344/492 [11:48:46<4:39:23, 113.26s/it] 70%|███████   | 345/492 [11:50:39<4:36:58, 113.05s/it]                                                        70%|███████   | 345/492 [11:50:39<4:36:58, 113.05s/it] 70%|███████   | 346/492 [11:52:32<4:35:12, 113.10s/it] 71%|███████   | 347/492 [11:54:25<4:33:11, 113.04s/it] 71%|███████   | 348/492 [11:56:19<4:31:34, 113.16s/it] 71%|███████   | 349/492 [11:58:12<4:29:42, 113.16s/it] 71%|███████   | 350/492 [12:00:05<4:27:40, 113.10s/it]                                                        71%|███████   | 350/492 [12:00:05<4:27:40, 113.10s/it]{'eval_loss': 0.14324025809764862, 'eval_runtime': 570.6919, 'eval_samples_per_second': 1.752, 'eval_steps_per_second': 0.219, 'epoch': 2.44}
{'loss': 0.1169, 'grad_norm': 0.0965413898229599, 'learning_rate': 3.803421678562213e-05, 'epoch': 2.48}
{'loss': 0.1084, 'grad_norm': 0.07902427762746811, 'learning_rate': 3.631685049639586e-05, 'epoch': 2.52}
{'loss': 0.1092, 'grad_norm': 0.0779964029788971, 'learning_rate': 3.461676388250651e-05, 'epoch': 2.56}
{'loss': 0.1116, 'grad_norm': 0.08506277203559875, 'learning_rate': 3.293610388715048e-05, 'epoch': 2.6}
{'loss': 0.118, 'grad_norm': 0.1012549176812172, 'learning_rate': 3.127699292074683e-05, 'epoch': 2.64}
{'loss': 0.1043, 'grad_norm': 0.13339918851852417, 'learning_rate': 2.964152618066508e-05, 'epoch': 2.68}
{'loss': 0.1103, 'grad_norm': 0.10142350941896439, 'learning_rate': 2.8031769005319147e-05, 'epoch': 2.72}
{'loss': 0.1125, 'grad_norm': 0.08831272274255753, 'learning_rate': 2.6449754265968264e-05, 'epoch': 2.76}
{'loss': 0.1069, 'grad_norm': 0.07664326578378677, 'learning_rate': 2.4897479799518796e-05, 'epoch': 2.8}
{'loss': 0.1044, 'grad_norm': 0.08216122537851334, 'learning_rate': 2.3376905885569182e-05, 'epoch': 2.84}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:44,  2.31s/it][A
  2%|▏         | 3/125 [00:09<06:32,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:27,  3.70s/it][A
  4%|▍         | 5/125 [00:18<07:57,  3.98s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.17s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:30,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:34,  4.44s/it][A
  8%|▊         | 10/125 [00:40<08:34,  4.47s/it][A
  9%|▉         | 11/125 [00:45<08:32,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:29,  4.51s/it][A
 10%|█         | 13/125 [00:54<08:26,  4.52s/it][A
 11%|█         | 14/125 [00:59<08:26,  4.56s/it][A
 12%|█▏        | 15/125 [01:03<08:22,  4.57s/it][A
 13%|█▎        | 16/125 [01:08<08:17,  4.56s/it][A
 14%|█▎        | 17/125 [01:12<08:12,  4.56s/it][A
 14%|█▍        | 18/125 [01:17<08:07,  4.56s/it][A
 15%|█▌        | 19/125 [01:21<08:02,  4.56s/it][A
 16%|█▌        | 20/125 [01:26<07:57,  4.55s/it][A
 17%|█▋        | 21/125 [01:31<07:54,  4.56s/it][A
 18%|█▊        | 22/125 [01:35<07:49,  4.56s/it][A
 18%|█▊        | 23/125 [01:40<07:45,  4.56s/it][A
 19%|█▉        | 24/125 [01:44<07:40,  4.56s/it][A
 20%|██        | 25/125 [01:49<07:37,  4.57s/it][A
 21%|██        | 26/125 [01:53<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:58<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:03<07:22,  4.56s/it][A
 23%|██▎       | 29/125 [02:07<07:17,  4.55s/it][A
 24%|██▍       | 30/125 [02:12<07:14,  4.57s/it][A
 25%|██▍       | 31/125 [02:16<07:09,  4.57s/it][A
 26%|██▌       | 32/125 [02:21<07:03,  4.56s/it][A
 26%|██▋       | 33/125 [02:25<07:00,  4.57s/it][A
 27%|██▋       | 34/125 [02:30<06:56,  4.58s/it][A
 28%|██▊       | 35/125 [02:34<06:50,  4.57s/it][A
 29%|██▉       | 36/125 [02:39<06:46,  4.56s/it][A
 30%|██▉       | 37/125 [02:44<06:41,  4.56s/it][A
 30%|███       | 38/125 [02:48<06:36,  4.56s/it][A
 31%|███       | 39/125 [02:53<06:31,  4.55s/it][A
 32%|███▏      | 40/125 [02:57<06:27,  4.55s/it][A
 33%|███▎      | 41/125 [03:02<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:06<06:17,  4.54s/it][A
 34%|███▍      | 43/125 [03:11<06:14,  4.57s/it][A
 35%|███▌      | 44/125 [03:15<06:08,  4.55s/it][A
 36%|███▌      | 45/125 [03:20<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:25<05:59,  4.55s/it][A
 38%|███▊      | 47/125 [03:29<05:54,  4.55s/it][A
 38%|███▊      | 48/125 [03:34<05:51,  4.57s/it][A
 39%|███▉      | 49/125 [03:38<05:47,  4.57s/it][A
 40%|████      | 50/125 [03:43<05:42,  4.57s/it][A
 41%|████      | 51/125 [03:47<05:39,  4.59s/it][A
 42%|████▏     | 52/125 [03:52<05:36,  4.61s/it][A
 42%|████▏     | 53/125 [03:57<05:30,  4.59s/it][A
 43%|████▎     | 54/125 [04:01<05:25,  4.58s/it][A
 44%|████▍     | 55/125 [04:06<05:20,  4.57s/it][A
 45%|████▍     | 56/125 [04:10<05:15,  4.57s/it][A
 46%|████▌     | 57/125 [04:15<05:11,  4.57s/it][A
 46%|████▋     | 58/125 [04:20<05:06,  4.57s/it][A
 47%|████▋     | 59/125 [04:24<05:01,  4.56s/it][A
 48%|████▊     | 60/125 [04:29<04:56,  4.57s/it][A
 49%|████▉     | 61/125 [04:33<04:52,  4.57s/it][A
 50%|████▉     | 62/125 [04:38<04:47,  4.56s/it][A
 50%|█████     | 63/125 [04:42<04:42,  4.56s/it][A
 51%|█████     | 64/125 [04:47<04:38,  4.56s/it][A
 52%|█████▏    | 65/125 [04:51<04:33,  4.56s/it][A
 53%|█████▎    | 66/125 [04:56<04:27,  4.54s/it][A
 54%|█████▎    | 67/125 [05:00<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:05<04:18,  4.54s/it][A
 55%|█████▌    | 69/125 [05:10<04:13,  4.53s/it][A
 56%|█████▌    | 70/125 [05:14<04:09,  4.54s/it][A
 57%|█████▋    | 71/125 [05:19<04:06,  4.56s/it][A
 58%|█████▊    | 72/125 [05:23<04:01,  4.55s/it][A
 58%|█████▊    | 73/125 [05:28<03:57,  4.56s/it][A
 59%|█████▉    | 74/125 [05:32<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:37<03:49,  4.59s/it][A
 61%|██████    | 76/125 [05:42<03:45,  4.60s/it][A
 62%|██████▏   | 77/125 [05:46<03:40,  4.59s/it][A
 62%|██████▏   | 78/125 [05:51<03:35,  4.58s/it][A
 63%|██████▎   | 79/125 [05:55<03:31,  4.60s/it][A
 64%|██████▍   | 80/125 [06:00<03:27,  4.61s/it][A
 65%|██████▍   | 81/125 [06:05<03:22,  4.60s/it][A
 66%|██████▌   | 82/125 [06:09<03:17,  4.59s/it][A
 66%|██████▋   | 83/125 [06:14<03:11,  4.57s/it][A
 67%|██████▋   | 84/125 [06:18<03:06,  4.56s/it][A
 68%|██████▊   | 85/125 [06:23<03:02,  4.55s/it][A
 69%|██████▉   | 86/125 [06:27<02:57,  4.55s/it][A
 70%|██████▉   | 87/125 [06:32<02:53,  4.56s/it][A
 70%|███████   | 88/125 [06:37<02:49,  4.59s/it][A
 71%|███████   | 89/125 [06:41<02:45,  4.59s/it][A
 72%|███████▏  | 90/125 [06:46<02:40,  4.58s/it][A
 73%|███████▎  | 91/125 [06:50<02:35,  4.59s/it][A
 74%|███████▎  | 92/125 [06:55<02:30,  4.56s/it][A
 74%|███████▍  | 93/125 [06:59<02:25,  4.55s/it][A
 75%|███████▌  | 94/125 [07:04<02:21,  4.57s/it][A
 76%|███████▌  | 95/125 [07:09<02:17,  4.58s/it][A
 77%|███████▋  | 96/125 [07:13<02:12,  4.57s/it][A
 78%|███████▊  | 97/125 [07:18<02:07,  4.56s/it][A
 78%|███████▊  | 98/125 [07:22<02:03,  4.56s/it][A
 79%|███████▉  | 99/125 [07:27<01:58,  4.56s/it][A
 80%|████████  | 100/125 [07:31<01:53,  4.55s/it][A
 81%|████████  | 101/125 [07:36<01:49,  4.55s/it][A
 82%|████████▏ | 102/125 [07:40<01:44,  4.56s/it][A
 82%|████████▏ | 103/125 [07:45<01:40,  4.57s/it][A
 83%|████████▎ | 104/125 [07:50<01:36,  4.58s/it][A
 84%|████████▍ | 105/125 [07:54<01:31,  4.60s/it][A
 85%|████████▍ | 106/125 [07:59<01:27,  4.58s/it][A
 86%|████████▌ | 107/125 [08:03<01:22,  4.58s/it][A
 86%|████████▋ | 108/125 [08:08<01:18,  4.59s/it][A
 87%|████████▋ | 109/125 [08:13<01:13,  4.58s/it][A
 88%|████████▊ | 110/125 [08:17<01:08,  4.57s/it][A
 89%|████████▉ | 111/125 [08:22<01:03,  4.57s/it][A
 90%|████████▉ | 112/125 [08:26<00:59,  4.57s/it][A
 90%|█████████ | 113/125 [08:31<00:54,  4.57s/it][A
 91%|█████████ | 114/125 [08:35<00:49,  4.55s/it][A
 92%|█████████▏| 115/125 [08:40<00:45,  4.56s/it][A
 93%|█████████▎| 116/125 [08:44<00:41,  4.56s/it][A
 94%|█████████▎| 117/125 [08:49<00:36,  4.57s/it][A
 94%|█████████▍| 118/125 [08:54<00:31,  4.57s/it][A
 95%|█████████▌| 119/125 [08:58<00:27,  4.58s/it][A
 96%|█████████▌| 120/125 [09:03<00:22,  4.57s/it][A
 97%|█████████▋| 121/125 [09:07<00:18,  4.56s/it][A
 98%|█████████▊| 122/125 [09:12<00:13,  4.55s/it][A
 98%|█████████▊| 123/125 [09:16<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:21<00:04,  4.57s/it][A
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A                                                       
                                                 [A 71%|███████   | 350/492 [12:09:35<4:27:40, 113.10s/it]
100%|██████████| 125/125 [09:26<00:00,  4.57s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-350)... {'eval_loss': 0.1425444483757019, 'eval_runtime': 570.665, 'eval_samples_per_second': 1.752, 'eval_steps_per_second': 0.219, 'epoch': 2.84}
Traceback (most recent call last):
  File "/workspace/model_training/deepseek_prover_base_no_err/main.py", line 293, in <module>
    choices=['train', 'valid', 'test', 'all'],
  File "/workspace/model_training/deepseek_prover_base_no_err/main.py", line 176, in finetune
    eval_strategy="steps",
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 1948, in train
    return inner_training_loop(
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 2366, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py", line 2818, in _maybe_log_save_evaluate
    self.control = self.callback_handler.on_save(self.args, self.state, self.control)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer_callback.py", line 496, in on_save
    return self.call_event("on_save", args, state, control)
  File "/workspace/venv/lib/python3.10/site-packages/transformers/trainer_callback.py", line 507, in call_event
    result = getattr(callback, event)(
  File "/workspace/venv/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 980, in on_save
    artifact.add_dir(artifact_path)
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1256, in add_dir
    pool.map(add_manifest_file, paths)
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1247, in add_manifest_file
    self._add_local_file(
  File "/workspace/venv/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1461, in _add_local_file
    shutil.copyfile(path, staging_path)
  File "/usr/lib/python3.10/shutil.py", line 267, in copyfile
    _fastcopy_sendfile(fsrc, fdst)
  File "/usr/lib/python3.10/shutil.py", line 156, in _fastcopy_sendfile
    raise err from None
  File "/usr/lib/python3.10/shutil.py", line 142, in _fastcopy_sendfile
    sent = os.sendfile(outfd, infd, offset, blocksize)
OSError: [Errno 28] No space left on device: 'model_training/deepseek_prover_base_no_err/checkpoints-by_file-09-07-08-59/checkpoint-350/adapter_model.safetensors' -> '/root/.local/share/wandb/artifacts/staging/tmpmtz2_fmp'
wandb: - 19147.378 MB of 19147.378 MB uploaded (22.042 MB deduped)wandb: \ 19147.378 MB of 19147.412 MB uploaded (22.042 MB deduped)wandb: | 19147.412 MB of 19147.412 MB uploaded (22.042 MB deduped)wandb: 
wandb: Run history:
wandb:               eval/loss █▅▄▂▂▁▁
wandb:            eval/runtime ▃▂█▂▂▁▁
wandb: eval/samples_per_second ▆█▁████
wandb:   eval/steps_per_second ▁▁▁▁▁▁▁
wandb:             train/epoch ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:         train/grad_norm ▃▃▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     train/learning_rate ▁▂▃▅▆▇████████▇▇▇▇▇▇▆▆▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▃▂▂
wandb:              train/loss █▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:               eval/loss 0.14254
wandb:            eval/runtime 570.665
wandb: eval/samples_per_second 1.752
wandb:   eval/steps_per_second 0.219
wandb:             train/epoch 2.84264
wandb:       train/global_step 350
wandb:         train/grad_norm 0.08216
wandb:     train/learning_rate 2e-05
wandb:              train/loss 0.1044
wandb: 
wandb: 🚀 View run deepseek_prover_base_no_err-by_file-09-07-08-59 at: https://wandb.ai/tcwong/decoder/runs/qzthc60s
wandb: ⭐️ View project at: https://wandb.ai/tcwong/decoder
wandb: Synced 5 W&B file(s), 0 media file(s), 67 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240907_085950-qzthc60s/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
Exception ignored in atexit callback: <function matmul_ext_update_autotune_table at 0x748e88b5bbe0>
Traceback (most recent call last):
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 473, in matmul_ext_update_autotune_table
    fp16_matmul._update_autotune_table()
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 450, in _update_autotune_table
    TritonMatmul._update_autotune_table(__class__.__name__ + "_2d_kernel", __class__._2d_kernel)
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 179, in _update_autotune_table
    cache_manager.put(autotune_table)
  File "/workspace/venv/lib/python3.10/site-packages/deepspeed/ops/transformer/inference/triton/matmul_ext.py", line 95, in put
    with FileLock(self.lock_path):
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_api.py", line 376, in __enter__
    self.acquire()
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_api.py", line 332, in acquire
    self._acquire()
  File "/workspace/venv/lib/python3.10/site-packages/filelock/_unix.py", line 42, in _acquire
    fd = os.open(self.lock_file, open_flags, self._context.mode)
OSError: [Errno 28] No space left on device: '/tmp/torchinductor_root/triton/0/Fp16Matmul_2d_kernel.pickle.lock'
