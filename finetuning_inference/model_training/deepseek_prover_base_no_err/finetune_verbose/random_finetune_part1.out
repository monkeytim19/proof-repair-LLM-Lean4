nohup: ignoring input
Finetuning starting.
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]Downloading shards:  50%|█████     | 1/2 [01:23<01:23, 83.11s/it]Downloading shards: 100%|██████████| 2/2 [02:13<00:00, 64.11s/it]Downloading shards: 100%|██████████| 2/2 [02:13<00:00, 66.96s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.48s/it]
trainable params: 10,644,480 || all params: 6,901,373,952 || trainable%: 0.1542
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 7876 examples [00:00, 12082.30 examples/s]Generating train split: 7876 examples [00:00, 11939.31 examples/s]
Generating valid split: 0 examples [00:00, ? examples/s]Generating valid split: 1000 examples [00:00, 9651.40 examples/s]Generating valid split: 1000 examples [00:00, 9554.59 examples/s]
Map:   0%|          | 0/7876 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7876 [00:00<00:06, 1015.28 examples/s]Map:  25%|██▌       | 2000/7876 [00:01<00:05, 1046.11 examples/s]Map:  38%|███▊      | 3000/7876 [00:02<00:04, 1047.31 examples/s]Map:  51%|█████     | 4000/7876 [00:03<00:03, 1045.88 examples/s]Map:  63%|██████▎   | 5000/7876 [00:04<00:02, 1046.03 examples/s]Map:  76%|███████▌  | 6000/7876 [00:05<00:01, 1044.49 examples/s]Map:  89%|████████▉ | 7000/7876 [00:06<00:00, 1039.06 examples/s]Map: 100%|██████████| 7876/7876 [00:07<00:00, 1030.42 examples/s]Map: 100%|██████████| 7876/7876 [00:07<00:00, 1035.39 examples/s]
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1069.56 examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 1048.11 examples/s]
[2024-09-07 09:02:33,081] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
df: /root/.triton/autotune: No such file or directory
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
wandb: Currently logged in as: tcwong. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.7
wandb: Run data is saved locally in /workspace/wandb/run-20240907_090247-86fwp1sy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deepseek_prover_base_no_err-random-09-07-09-02
wandb: ⭐️ View project at https://wandb.ai/tcwong/decoder
wandb: 🚀 View run at https://wandb.ai/tcwong/decoder/runs/86fwp1sy
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
  0%|          | 0/492 [00:00<?, ?it/s]W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0] Graph break from `Tensor.item()`, consider setting:
W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0]     torch._dynamo.config.capture_scalar_outputs = True
W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0] or:
W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0] to include these operations in the captured graph.
W0907 09:03:00.107000 126475815067648 torch/_dynamo/variables/tensor.py:715] [17/0] 
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/492 [02:23<19:36:26, 143.76s/it]  0%|          | 2/492 [04:13<16:49:05, 123.56s/it]  1%|          | 3/492 [06:05<16:04:44, 118.37s/it]  1%|          | 4/492 [07:57<15:43:09, 115.96s/it]  1%|          | 5/492 [09:49<15:28:47, 114.43s/it]                                                     1%|          | 5/492 [09:49<15:28:47, 114.43s/it]  1%|          | 6/492 [11:41<15:20:54, 113.69s/it]  1%|▏         | 7/492 [13:33<15:13:00, 112.95s/it]  2%|▏         | 8/492 [15:25<15:08:48, 112.66s/it]  2%|▏         | 9/492 [17:17<15:05:22, 112.47s/it]  2%|▏         | 10/492 [19:09<15:02:32, 112.35s/it]                                                      2%|▏         | 10/492 [19:09<15:02:32, 112.35s/it]  2%|▏         | 11/492 [21:01<15:00:23, 112.31s/it]  2%|▏         | 12/492 [22:53<14:57:01, 112.13s/it]  3%|▎         | 13/492 [24:45<14:55:06, 112.12s/it]  3%|▎         | 14/492 [26:37<14:53:53, 112.20s/it]  3%|▎         | 15/492 [28:29<14:51:37, 112.15s/it]                                                      3%|▎         | 15/492 [28:29<14:51:37, 112.15s/it]  3%|▎         | 16/492 [30:21<14:49:38, 112.14s/it]  3%|▎         | 17/492 [32:13<14:47:34, 112.11s/it]  4%|▎         | 18/492 [34:05<14:45:38, 112.11s/it]  4%|▍         | 19/492 [35:58<14:43:42, 112.10s/it]  4%|▍         | 20/492 [37:49<14:41:13, 112.02s/it]                                                      4%|▍         | 20/492 [37:49<14:41:13, 112.02s/it]  4%|▍         | 21/492 [39:41<14:38:37, 111.93s/it]  4%|▍         | 22/492 [41:33<14:37:28, 112.02s/it]  5%|▍         | 23/492 [43:25<14:34:32, 111.88s/it]  5%|▍         | 24/492 [45:17<14:32:56, 111.92s/it]  5%|▌         | 25/492 [47:09<14:31:38, 111.99s/it]                                                      5%|▌         | 25/492 [47:09<14:31:38, 111.99s/it]  5%|▌         | 26/492 [49:01<14:29:34, 111.96s/it]  5%|▌         | 27/492 [50:53<14:28:16, 112.04s/it]  6%|▌         | 28/492 [52:45<14:26:11, 112.01s/it]  6%|▌         | 29/492 [54:37<14:24:28, 112.03s/it]  6%|▌         | 30/492 [56:29<14:22:39, 112.03s/it]                                                      6%|▌         | 30/492 [56:29<14:22:39, 112.03s/it]  6%|▋         | 31/492 [58:22<14:22:09, 112.21s/it]  7%|▋         | 32/492 [1:00:14<14:20:35, 112.25s/it]  7%|▋         | 33/492 [1:02:06<14:18:05, 112.17s/it]  7%|▋         | 34/492 [1:03:58<14:16:13, 112.17s/it]  7%|▋         | 35/492 [1:05:50<14:13:39, 112.08s/it]                                                        7%|▋         | 35/492 [1:05:50<14:13:39, 112.08s/it]  7%|▋         | 36/492 [1:07:42<14:12:10, 112.13s/it]  8%|▊         | 37/492 [1:09:35<14:11:02, 112.23s/it]  8%|▊         | 38/492 [1:11:27<14:09:25, 112.26s/it]  8%|▊         | 39/492 [1:13:19<14:06:08, 112.07s/it]  8%|▊         | 40/492 [1:15:11<14:03:52, 112.02s/it]                                                        8%|▊         | 40/492 [1:15:11<14:03:52, 112.02s/it]  8%|▊         | 41/492 [1:17:03<14:02:26, 112.08s/it]  9%|▊         | 42/492 [1:18:55<14:00:12, 112.03s/it]  9%|▊         | 43/492 [1:20:47<13:57:52, 111.96s/it]  9%|▉         | 44/492 [1:22:39<13:56:50, 112.08s/it]  9%|▉         | 45/492 [1:24:31<13:54:26, 112.00s/it]                                                        9%|▉         | 45/492 [1:24:31<13:54:26, 112.00s/it]  9%|▉         | 46/492 [1:26:23<13:51:51, 111.91s/it] 10%|▉         | 47/492 [1:28:15<13:51:37, 112.13s/it] 10%|▉         | 48/492 [1:30:08<13:50:12, 112.19s/it] 10%|▉         | 49/492 [1:32:00<13:48:34, 112.22s/it] 10%|█         | 50/492 [1:33:52<13:46:37, 112.21s/it]                                                       10%|█         | 50/492 [1:33:52<13:46:37, 112.21s/it]{'loss': 15.7951, 'grad_norm': 117.39540100097656, 'learning_rate': 1e-05, 'epoch': 0.04}
{'loss': 11.8462, 'grad_norm': 105.14662170410156, 'learning_rate': 2e-05, 'epoch': 0.08}
{'loss': 3.3642, 'grad_norm': 43.610801696777344, 'learning_rate': 3e-05, 'epoch': 0.12}
{'loss': 0.1821, 'grad_norm': 0.4269501864910126, 'learning_rate': 4e-05, 'epoch': 0.16}
{'loss': 0.4639, 'grad_norm': 0.41744017601013184, 'learning_rate': 5e-05, 'epoch': 0.2}
{'loss': 0.1685, 'grad_norm': 0.45930907130241394, 'learning_rate': 6e-05, 'epoch': 0.24}
{'loss': 0.1772, 'grad_norm': 0.32693225145339966, 'learning_rate': 7e-05, 'epoch': 0.28}
{'loss': 0.1677, 'grad_norm': 0.2242601364850998, 'learning_rate': 8e-05, 'epoch': 0.32}
{'loss': 0.1544, 'grad_norm': 2.6285548210144043, 'learning_rate': 9e-05, 'epoch': 0.37}
{'loss': 0.1655, 'grad_norm': 0.1525067687034607, 'learning_rate': 0.0001, 'epoch': 0.41}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:14,  2.07s/it][A
  2%|▏         | 3/125 [00:08<06:17,  3.10s/it][A
  3%|▎         | 4/125 [00:13<07:18,  3.62s/it][A
  4%|▍         | 5/125 [00:17<07:53,  3.95s/it][A
  5%|▍         | 6/125 [00:22<08:12,  4.14s/it][A
  6%|▌         | 7/125 [00:26<08:23,  4.26s/it][A
  6%|▋         | 8/125 [00:31<08:27,  4.34s/it][A
  7%|▋         | 9/125 [00:35<08:28,  4.38s/it][A
  8%|▊         | 10/125 [00:40<08:29,  4.43s/it][A
  9%|▉         | 11/125 [00:44<08:29,  4.47s/it][A
 10%|▉         | 12/125 [00:49<08:25,  4.47s/it][A
 10%|█         | 13/125 [00:53<08:21,  4.47s/it][A
 11%|█         | 14/125 [00:58<08:18,  4.49s/it][A
 12%|█▏        | 15/125 [01:02<08:13,  4.49s/it][A
 13%|█▎        | 16/125 [01:07<08:10,  4.50s/it][A
 14%|█▎        | 17/125 [01:11<08:06,  4.51s/it][A
 14%|█▍        | 18/125 [01:16<08:02,  4.51s/it][A
 15%|█▌        | 19/125 [01:20<07:57,  4.50s/it][A
 16%|█▌        | 20/125 [01:25<07:53,  4.51s/it][A
 17%|█▋        | 21/125 [01:29<07:48,  4.50s/it][A
 18%|█▊        | 22/125 [01:34<07:42,  4.49s/it][A
 18%|█▊        | 23/125 [01:38<07:37,  4.49s/it][A
 19%|█▉        | 24/125 [01:43<07:35,  4.51s/it][A
 20%|██        | 25/125 [01:47<07:33,  4.53s/it][A
 21%|██        | 26/125 [01:52<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:57<07:24,  4.53s/it][A
 22%|██▏       | 28/125 [02:01<07:17,  4.51s/it][A
 23%|██▎       | 29/125 [02:06<07:13,  4.51s/it][A
 24%|██▍       | 30/125 [02:10<07:07,  4.50s/it][A
 25%|██▍       | 31/125 [02:15<07:03,  4.51s/it][A
 26%|██▌       | 32/125 [02:19<06:58,  4.50s/it][A
 26%|██▋       | 33/125 [02:24<06:54,  4.50s/it][A
 27%|██▋       | 34/125 [02:28<06:48,  4.49s/it][A
 28%|██▊       | 35/125 [02:32<06:44,  4.49s/it][A
 29%|██▉       | 36/125 [02:37<06:40,  4.50s/it][A
 30%|██▉       | 37/125 [02:41<06:35,  4.49s/it][A
 30%|███       | 38/125 [02:46<06:30,  4.49s/it][A
 31%|███       | 39/125 [02:50<06:27,  4.50s/it][A
 32%|███▏      | 40/125 [02:55<06:22,  4.50s/it][A
 33%|███▎      | 41/125 [03:00<06:20,  4.52s/it][A
 34%|███▎      | 42/125 [03:04<06:14,  4.52s/it][A
 34%|███▍      | 43/125 [03:09<06:09,  4.51s/it][A
 35%|███▌      | 44/125 [03:13<06:05,  4.51s/it][A
 36%|███▌      | 45/125 [03:18<06:02,  4.53s/it][A
 37%|███▋      | 46/125 [03:22<05:56,  4.52s/it][A
 38%|███▊      | 47/125 [03:27<05:50,  4.50s/it][A
 38%|███▊      | 48/125 [03:31<05:47,  4.51s/it][A
 39%|███▉      | 49/125 [03:36<05:42,  4.51s/it][A
 40%|████      | 50/125 [03:40<05:38,  4.51s/it][A
 41%|████      | 51/125 [03:45<05:33,  4.51s/it][A
 42%|████▏     | 52/125 [03:49<05:28,  4.51s/it][A
 42%|████▏     | 53/125 [03:54<05:24,  4.51s/it][A
 43%|████▎     | 54/125 [03:58<05:20,  4.51s/it][A
 44%|████▍     | 55/125 [04:03<05:16,  4.52s/it][A
 45%|████▍     | 56/125 [04:07<05:11,  4.52s/it][A
 46%|████▌     | 57/125 [04:12<05:06,  4.51s/it][A
 46%|████▋     | 58/125 [04:16<05:03,  4.52s/it][A
 47%|████▋     | 59/125 [04:21<04:57,  4.50s/it][A
 48%|████▊     | 60/125 [04:25<04:53,  4.51s/it][A
 49%|████▉     | 61/125 [04:30<04:47,  4.50s/it][A
 50%|████▉     | 62/125 [04:34<04:43,  4.50s/it][A
 50%|█████     | 63/125 [04:39<04:40,  4.52s/it][A
 51%|█████     | 64/125 [04:43<04:35,  4.52s/it][A
 52%|█████▏    | 65/125 [04:48<04:30,  4.50s/it][A
 53%|█████▎    | 66/125 [04:52<04:26,  4.52s/it][A
 54%|█████▎    | 67/125 [04:57<04:21,  4.50s/it][A
 54%|█████▍    | 68/125 [05:01<04:16,  4.51s/it][A
 55%|█████▌    | 69/125 [05:06<04:12,  4.50s/it][A
 56%|█████▌    | 70/125 [05:10<04:08,  4.51s/it][A
 57%|█████▋    | 71/125 [05:15<04:03,  4.52s/it][A
 58%|█████▊    | 72/125 [05:19<03:59,  4.53s/it][A
 58%|█████▊    | 73/125 [05:24<03:55,  4.53s/it][A
 59%|█████▉    | 74/125 [05:29<03:52,  4.57s/it][A
 60%|██████    | 75/125 [05:33<03:47,  4.55s/it][A
 61%|██████    | 76/125 [05:38<03:42,  4.54s/it][A
 62%|██████▏   | 77/125 [05:42<03:37,  4.53s/it][A
 62%|██████▏   | 78/125 [05:47<03:32,  4.52s/it][A
 63%|██████▎   | 79/125 [05:51<03:27,  4.50s/it][A
 64%|██████▍   | 80/125 [05:56<03:22,  4.51s/it][A
 65%|██████▍   | 81/125 [06:00<03:18,  4.51s/it][A
 66%|██████▌   | 82/125 [06:05<03:13,  4.51s/it][A
 66%|██████▋   | 83/125 [06:09<03:09,  4.50s/it][A
 67%|██████▋   | 84/125 [06:14<03:04,  4.50s/it][A
 68%|██████▊   | 85/125 [06:18<03:00,  4.51s/it][A
 69%|██████▉   | 86/125 [06:23<02:55,  4.51s/it][A
 70%|██████▉   | 87/125 [06:27<02:51,  4.52s/it][A
 70%|███████   | 88/125 [06:32<02:46,  4.51s/it][A
 71%|███████   | 89/125 [06:36<02:42,  4.51s/it][A
 72%|███████▏  | 90/125 [06:41<02:37,  4.50s/it][A
 73%|███████▎  | 91/125 [06:45<02:32,  4.49s/it][A
 74%|███████▎  | 92/125 [06:50<02:27,  4.48s/it][A
 74%|███████▍  | 93/125 [06:54<02:24,  4.50s/it][A
 75%|███████▌  | 94/125 [06:59<02:19,  4.50s/it][A
 76%|███████▌  | 95/125 [07:03<02:15,  4.51s/it][A
 77%|███████▋  | 96/125 [07:08<02:10,  4.50s/it][A
 78%|███████▊  | 97/125 [07:12<02:06,  4.51s/it][A
 78%|███████▊  | 98/125 [07:17<02:01,  4.50s/it][A
 79%|███████▉  | 99/125 [07:21<01:56,  4.50s/it][A
 80%|████████  | 100/125 [07:26<01:52,  4.50s/it][A
 81%|████████  | 101/125 [07:30<01:47,  4.50s/it][A
 82%|████████▏ | 102/125 [07:35<01:43,  4.52s/it][A
 82%|████████▏ | 103/125 [07:39<01:39,  4.53s/it][A
 83%|████████▎ | 104/125 [07:44<01:35,  4.53s/it][A
 84%|████████▍ | 105/125 [07:48<01:30,  4.51s/it][A
 85%|████████▍ | 106/125 [07:53<01:25,  4.51s/it][A
 86%|████████▌ | 107/125 [07:57<01:20,  4.50s/it][A
 86%|████████▋ | 108/125 [08:02<01:16,  4.50s/it][A
 87%|████████▋ | 109/125 [08:06<01:12,  4.51s/it][A
 88%|████████▊ | 110/125 [08:11<01:07,  4.50s/it][A
 89%|████████▉ | 111/125 [08:15<01:03,  4.51s/it][A
 90%|████████▉ | 112/125 [08:20<00:58,  4.51s/it][A
 90%|█████████ | 113/125 [08:24<00:53,  4.49s/it][A
 91%|█████████ | 114/125 [08:29<00:49,  4.51s/it][A
 92%|█████████▏| 115/125 [08:33<00:45,  4.53s/it][A
 93%|█████████▎| 116/125 [08:38<00:40,  4.52s/it][A
 94%|█████████▎| 117/125 [08:42<00:36,  4.53s/it][A
 94%|█████████▍| 118/125 [08:47<00:31,  4.52s/it][A
 95%|█████████▌| 119/125 [08:51<00:27,  4.52s/it][A
 96%|█████████▌| 120/125 [08:56<00:22,  4.51s/it][A
 97%|█████████▋| 121/125 [09:00<00:18,  4.52s/it][A
 98%|█████████▊| 122/125 [09:05<00:13,  4.52s/it][A
 98%|█████████▊| 123/125 [09:10<00:09,  4.54s/it][A
 99%|█████████▉| 124/125 [09:14<00:04,  4.53s/it][A
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A                                                      
                                                 [A 10%|█         | 50/492 [1:43:16<13:46:37, 112.21s/it]
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-50)... Done. 8.9s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 10%|█         | 51/492 [1:45:27<35:09:07, 286.96s/it] 11%|█         | 52/492 [1:47:19<28:40:14, 234.58s/it] 11%|█         | 53/492 [1:49:11<24:06:44, 197.73s/it] 11%|█         | 54/492 [1:51:03<20:55:47, 172.03s/it] 11%|█         | 55/492 [1:52:55<18:41:54, 154.04s/it]                                                       11%|█         | 55/492 [1:52:55<18:41:54, 154.04s/it] 11%|█▏        | 56/492 [1:54:47<17:07:16, 141.37s/it] 12%|█▏        | 57/492 [1:56:39<16:01:27, 132.62s/it] 12%|█▏        | 58/492 [1:58:31<15:14:48, 126.47s/it] 12%|█▏        | 59/492 [2:00:23<14:40:32, 122.01s/it] 12%|█▏        | 60/492 [2:02:15<14:16:46, 119.00s/it]                                                       12%|█▏        | 60/492 [2:02:15<14:16:46, 119.00s/it] 12%|█▏        | 61/492 [2:04:07<14:00:35, 117.02s/it] 13%|█▎        | 62/492 [2:05:59<13:48:35, 115.62s/it] 13%|█▎        | 63/492 [2:07:51<13:38:28, 114.47s/it] 13%|█▎        | 64/492 [2:09:43<13:31:27, 113.76s/it] 13%|█▎        | 65/492 [2:11:35<13:25:53, 113.24s/it]                                                       13%|█▎        | 65/492 [2:11:35<13:25:53, 113.24s/it] 13%|█▎        | 66/492 [2:13:28<13:22:20, 113.01s/it] 14%|█▎        | 67/492 [2:15:20<13:17:53, 112.64s/it] 14%|█▍        | 68/492 [2:17:12<13:15:15, 112.54s/it] 14%|█▍        | 69/492 [2:19:04<13:12:09, 112.36s/it] 14%|█▍        | 70/492 [2:20:56<13:09:28, 112.25s/it]                                                       14%|█▍        | 70/492 [2:20:56<13:09:28, 112.25s/it] 14%|█▍        | 71/492 [2:22:48<13:07:00, 112.16s/it] 15%|█▍        | 72/492 [2:24:39<13:03:46, 111.97s/it] 15%|█▍        | 73/492 [2:26:31<13:01:05, 111.85s/it] 15%|█▌        | 74/492 [2:28:23<13:00:14, 112.00s/it] 15%|█▌        | 75/492 [2:30:15<12:58:34, 112.02s/it]                                                       15%|█▌        | 75/492 [2:30:15<12:58:34, 112.02s/it] 15%|█▌        | 76/492 [2:32:07<12:57:01, 112.07s/it] 16%|█▌        | 77/492 [2:34:00<12:55:28, 112.12s/it] 16%|█▌        | 78/492 [2:35:52<12:54:21, 112.23s/it] 16%|█▌        | 79/492 [2:37:44<12:52:41, 112.25s/it] 16%|█▋        | 80/492 [2:39:37<12:50:51, 112.26s/it]                                                       16%|█▋        | 80/492 [2:39:37<12:50:51, 112.26s/it] 16%|█▋        | 81/492 [2:41:28<12:47:52, 112.10s/it] 17%|█▋        | 82/492 [2:43:21<12:47:47, 112.36s/it] 17%|█▋        | 83/492 [2:45:13<12:44:53, 112.21s/it] 17%|█▋        | 84/492 [2:47:05<12:42:15, 112.10s/it] 17%|█▋        | 85/492 [2:48:57<12:40:40, 112.14s/it]                                                       17%|█▋        | 85/492 [2:48:57<12:40:40, 112.14s/it] 17%|█▋        | 86/492 [2:50:49<12:38:14, 112.05s/it] 18%|█▊        | 87/492 [2:52:41<12:35:53, 111.98s/it] 18%|█▊        | 88/492 [2:54:33<12:33:45, 111.94s/it] 18%|█▊        | 89/492 [2:56:26<12:33:19, 112.16s/it] 18%|█▊        | 90/492 [2:58:18<12:31:38, 112.19s/it]                                                       18%|█▊        | 90/492 [2:58:18<12:31:38, 112.19s/it] 18%|█▊        | 91/492 [3:00:10<12:30:09, 112.24s/it] 19%|█▊        | 92/492 [3:02:02<12:28:00, 112.20s/it] 19%|█▉        | 93/492 [3:03:54<12:25:45, 112.15s/it] 19%|█▉        | 94/492 [3:05:47<12:24:28, 112.23s/it] 19%|█▉        | 95/492 [3:07:39<12:21:45, 112.10s/it]                                                       19%|█▉        | 95/492 [3:07:39<12:21:45, 112.10s/it] 20%|█▉        | 96/492 [3:09:30<12:19:32, 112.05s/it] 20%|█▉        | 97/492 [3:11:22<12:16:26, 111.86s/it] 20%|█▉        | 98/492 [3:13:14<12:15:27, 112.00s/it] 20%|██        | 99/492 [3:15:07<12:14:26, 112.13s/it] 20%|██        | 100/492 [3:16:59<12:12:43, 112.15s/it]                                                        20%|██        | 100/492 [3:16:59<12:12:43, 112.15s/it]{'eval_loss': 0.15786193311214447, 'eval_runtime': 564.1924, 'eval_samples_per_second': 1.772, 'eval_steps_per_second': 0.222, 'epoch': 0.41}
{'loss': 0.1514, 'grad_norm': 0.10299257934093475, 'learning_rate': 9.996842891446092e-05, 'epoch': 0.45}
{'loss': 0.1505, 'grad_norm': 0.11552461981773376, 'learning_rate': 9.987375552718133e-05, 'epoch': 0.49}
{'loss': 0.1556, 'grad_norm': 0.07015743851661682, 'learning_rate': 9.971609939582557e-05, 'epoch': 0.53}
{'loss': 0.1515, 'grad_norm': 0.0795639380812645, 'learning_rate': 9.9495659615402e-05, 'epoch': 0.57}
{'loss': 0.1394, 'grad_norm': 0.07625389844179153, 'learning_rate': 9.921271456683715e-05, 'epoch': 0.61}
{'loss': 0.1657, 'grad_norm': 0.10126403719186783, 'learning_rate': 9.886762156542428e-05, 'epoch': 0.65}
{'loss': 0.1475, 'grad_norm': 0.06794468313455582, 'learning_rate': 9.846081640959007e-05, 'epoch': 0.69}
{'loss': 0.1474, 'grad_norm': 0.043415650725364685, 'learning_rate': 9.79928128305494e-05, 'epoch': 0.73}
{'loss': 0.1495, 'grad_norm': 0.04360484331846237, 'learning_rate': 9.746420184354334e-05, 'epoch': 0.77}
{'loss': 0.1466, 'grad_norm': 0.044484805315732956, 'learning_rate': 9.687565100147939e-05, 'epoch': 0.81}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:37,  2.25s/it][A
  2%|▏         | 3/125 [00:09<06:31,  3.21s/it][A
  3%|▎         | 4/125 [00:13<07:26,  3.69s/it][A
  4%|▍         | 5/125 [00:18<07:58,  3.99s/it][A
  5%|▍         | 6/125 [00:22<08:15,  4.16s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.28s/it][A
  6%|▋         | 8/125 [00:31<08:29,  4.35s/it][A
  7%|▋         | 9/125 [00:36<08:29,  4.39s/it][A
  8%|▊         | 10/125 [00:40<08:30,  4.44s/it][A
  9%|▉         | 11/125 [00:45<08:29,  4.47s/it][A
 10%|▉         | 12/125 [00:49<08:26,  4.48s/it][A
 10%|█         | 13/125 [00:54<08:21,  4.48s/it][A
 11%|█         | 14/125 [00:58<08:18,  4.49s/it][A
 12%|█▏        | 15/125 [01:03<08:13,  4.49s/it][A
 13%|█▎        | 16/125 [01:07<08:10,  4.50s/it][A
 14%|█▎        | 17/125 [01:12<08:07,  4.51s/it][A
 14%|█▍        | 18/125 [01:16<08:02,  4.51s/it][A
 15%|█▌        | 19/125 [01:21<07:57,  4.50s/it][A
 16%|█▌        | 20/125 [01:25<07:53,  4.51s/it][A
 17%|█▋        | 21/125 [01:30<07:48,  4.50s/it][A
 18%|█▊        | 22/125 [01:34<07:42,  4.49s/it][A
 18%|█▊        | 23/125 [01:39<07:37,  4.49s/it][A
 19%|█▉        | 24/125 [01:43<07:35,  4.51s/it][A
 20%|██        | 25/125 [01:48<07:33,  4.54s/it][A
 21%|██        | 26/125 [01:52<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:57<07:24,  4.54s/it][A
 22%|██▏       | 28/125 [02:01<07:17,  4.51s/it][A
 23%|██▎       | 29/125 [02:06<07:13,  4.51s/it][A
 24%|██▍       | 30/125 [02:10<07:07,  4.50s/it][A
 25%|██▍       | 31/125 [02:15<07:03,  4.51s/it][A
 26%|██▌       | 32/125 [02:19<06:58,  4.50s/it][A
 26%|██▋       | 33/125 [02:24<06:54,  4.50s/it][A
 27%|██▋       | 34/125 [02:28<06:48,  4.49s/it][A
 28%|██▊       | 35/125 [02:33<06:44,  4.49s/it][A
 29%|██▉       | 36/125 [02:37<06:40,  4.50s/it][A
 30%|██▉       | 37/125 [02:42<06:35,  4.49s/it][A
 30%|███       | 38/125 [02:46<06:30,  4.49s/it][A
 31%|███       | 39/125 [02:51<06:27,  4.50s/it][A
 32%|███▏      | 40/125 [02:55<06:22,  4.50s/it][A
 33%|███▎      | 41/125 [03:00<06:20,  4.53s/it][A
 34%|███▎      | 42/125 [03:04<06:14,  4.52s/it][A
 34%|███▍      | 43/125 [03:09<06:09,  4.51s/it][A
 35%|███▌      | 44/125 [03:13<06:05,  4.51s/it][A
 36%|███▌      | 45/125 [03:18<06:02,  4.53s/it][A
 37%|███▋      | 46/125 [03:23<05:56,  4.52s/it][A
 38%|███▊      | 47/125 [03:27<05:50,  4.50s/it][A
 38%|███▊      | 48/125 [03:32<05:47,  4.51s/it][A
 39%|███▉      | 49/125 [03:36<05:42,  4.51s/it][A
 40%|████      | 50/125 [03:41<05:38,  4.51s/it][A
 41%|████      | 51/125 [03:45<05:33,  4.51s/it][A
 42%|████▏     | 52/125 [03:50<05:29,  4.51s/it][A
 42%|████▏     | 53/125 [03:54<05:24,  4.51s/it][A
 43%|████▎     | 54/125 [03:59<05:20,  4.51s/it][A
 44%|████▍     | 55/125 [04:03<05:16,  4.52s/it][A
 45%|████▍     | 56/125 [04:08<05:11,  4.52s/it][A
 46%|████▌     | 57/125 [04:12<05:06,  4.51s/it][A
 46%|████▋     | 58/125 [04:17<05:03,  4.53s/it][A
 47%|████▋     | 59/125 [04:21<04:57,  4.51s/it][A
 48%|████▊     | 60/125 [04:26<04:53,  4.51s/it][A
 49%|████▉     | 61/125 [04:30<04:47,  4.50s/it][A
 50%|████▉     | 62/125 [04:35<04:43,  4.50s/it][A
 50%|█████     | 63/125 [04:39<04:40,  4.52s/it][A
 51%|█████     | 64/125 [04:44<04:35,  4.52s/it][A
 52%|█████▏    | 65/125 [04:48<04:30,  4.50s/it][A
 53%|█████▎    | 66/125 [04:53<04:26,  4.52s/it][A
 54%|█████▎    | 67/125 [04:57<04:21,  4.50s/it][A
 54%|█████▍    | 68/125 [05:02<04:16,  4.51s/it][A
 55%|█████▌    | 69/125 [05:06<04:12,  4.50s/it][A
 56%|█████▌    | 70/125 [05:11<04:08,  4.51s/it][A
 57%|█████▋    | 71/125 [05:15<04:03,  4.52s/it][A
 58%|█████▊    | 72/125 [05:20<03:59,  4.53s/it][A
 58%|█████▊    | 73/125 [05:24<03:55,  4.53s/it][A
 59%|█████▉    | 74/125 [05:29<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:34<03:47,  4.55s/it][A
 61%|██████    | 76/125 [05:38<03:42,  4.54s/it][A
 62%|██████▏   | 77/125 [05:43<03:37,  4.53s/it][A
 62%|██████▏   | 78/125 [05:47<03:32,  4.52s/it][A
 63%|██████▎   | 79/125 [05:52<03:27,  4.50s/it][A
 64%|██████▍   | 80/125 [05:56<03:22,  4.51s/it][A
 65%|██████▍   | 81/125 [06:01<03:18,  4.52s/it][A
 66%|██████▌   | 82/125 [06:05<03:13,  4.51s/it][A
 66%|██████▋   | 83/125 [06:10<03:09,  4.50s/it][A
 67%|██████▋   | 84/125 [06:14<03:04,  4.50s/it][A
 68%|██████▊   | 85/125 [06:19<03:00,  4.51s/it][A
 69%|██████▉   | 86/125 [06:23<02:55,  4.51s/it][A
 70%|██████▉   | 87/125 [06:28<02:51,  4.52s/it][A
 70%|███████   | 88/125 [06:32<02:47,  4.51s/it][A
 71%|███████   | 89/125 [06:37<02:42,  4.51s/it][A
 72%|███████▏  | 90/125 [06:41<02:37,  4.50s/it][A
 73%|███████▎  | 91/125 [06:46<02:32,  4.49s/it][A
 74%|███████▎  | 92/125 [06:50<02:27,  4.48s/it][A
 74%|███████▍  | 93/125 [06:55<02:24,  4.51s/it][A
 75%|███████▌  | 94/125 [06:59<02:19,  4.50s/it][A
 76%|███████▌  | 95/125 [07:04<02:15,  4.51s/it][A
 77%|███████▋  | 96/125 [07:08<02:10,  4.50s/it][A
 78%|███████▊  | 97/125 [07:13<02:06,  4.51s/it][A
 78%|███████▊  | 98/125 [07:17<02:01,  4.50s/it][A
 79%|███████▉  | 99/125 [07:22<01:56,  4.50s/it][A
 80%|████████  | 100/125 [07:26<01:52,  4.50s/it][A
 81%|████████  | 101/125 [07:31<01:48,  4.50s/it][A
 82%|████████▏ | 102/125 [07:35<01:43,  4.52s/it][A
 82%|████████▏ | 103/125 [07:40<01:39,  4.53s/it][A
 83%|████████▎ | 104/125 [07:44<01:35,  4.53s/it][A
 84%|████████▍ | 105/125 [07:49<01:30,  4.51s/it][A
 85%|████████▍ | 106/125 [07:53<01:25,  4.51s/it][A
 86%|████████▌ | 107/125 [07:58<01:20,  4.50s/it][A
 86%|████████▋ | 108/125 [08:02<01:16,  4.50s/it][A
 87%|████████▋ | 109/125 [08:07<01:12,  4.51s/it][A
 88%|████████▊ | 110/125 [08:11<01:07,  4.50s/it][A
 89%|████████▉ | 111/125 [08:16<01:03,  4.51s/it][A
 90%|████████▉ | 112/125 [08:20<00:58,  4.51s/it][A
 90%|█████████ | 113/125 [08:25<00:53,  4.49s/it][A
 91%|█████████ | 114/125 [08:29<00:49,  4.51s/it][A
 92%|█████████▏| 115/125 [08:34<00:45,  4.53s/it][A
 93%|█████████▎| 116/125 [08:38<00:40,  4.53s/it][A
 94%|█████████▎| 117/125 [08:43<00:36,  4.53s/it][A
 94%|█████████▍| 118/125 [08:47<00:31,  4.52s/it][A
 95%|█████████▌| 119/125 [08:52<00:27,  4.52s/it][A
 96%|█████████▌| 120/125 [08:56<00:22,  4.51s/it][A
 97%|█████████▋| 121/125 [09:01<00:18,  4.52s/it][A
 98%|█████████▊| 122/125 [09:05<00:13,  4.52s/it][A
 98%|█████████▊| 123/125 [09:10<00:09,  4.54s/it][A
 99%|█████████▉| 124/125 [09:15<00:04,  4.53s/it][A
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A                                                       
                                                 [A 20%|██        | 100/492 [3:26:23<12:12:43, 112.15s/it]
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-100)... Done. 9.0s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 21%|██        | 101/492 [3:28:33<31:09:08, 286.82s/it]wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 21%|██        | 102/492 [3:30:25<25:23:10, 234.33s/it] 21%|██        | 103/492 [3:32:17<21:21:54, 197.72s/it] 21%|██        | 104/492 [3:34:10<18:32:45, 172.08s/it] 21%|██▏       | 105/492 [3:36:02<16:33:45, 154.07s/it]                                                        21%|██▏       | 105/492 [3:36:02<16:33:45, 154.07s/it] 22%|██▏       | 106/492 [3:37:54<15:10:16, 141.49s/it] 22%|██▏       | 107/492 [3:39:46<14:10:32, 132.55s/it] 22%|██▏       | 108/492 [3:41:38<13:29:23, 126.47s/it] 22%|██▏       | 109/492 [3:43:30<12:59:20, 122.09s/it] 22%|██▏       | 110/492 [3:45:22<12:38:22, 119.12s/it]                                                        22%|██▏       | 110/492 [3:45:22<12:38:22, 119.12s/it] 23%|██▎       | 111/492 [3:47:14<12:23:19, 117.06s/it] 23%|██▎       | 112/492 [3:49:06<12:12:02, 115.59s/it] 23%|██▎       | 113/492 [3:50:59<12:03:55, 114.61s/it] 23%|██▎       | 114/492 [3:52:51<11:57:23, 113.87s/it] 23%|██▎       | 115/492 [3:54:43<11:52:36, 113.41s/it]                                                        23%|██▎       | 115/492 [3:54:43<11:52:36, 113.41s/it] 24%|██▎       | 116/492 [3:56:35<11:47:49, 112.95s/it] 24%|██▍       | 117/492 [3:58:27<11:44:45, 112.76s/it] 24%|██▍       | 118/492 [4:00:19<11:41:48, 112.59s/it] 24%|██▍       | 119/492 [4:02:11<11:38:33, 112.37s/it] 24%|██▍       | 120/492 [4:04:03<11:36:08, 112.28s/it]                                                        24%|██▍       | 120/492 [4:04:03<11:36:08, 112.28s/it] 25%|██▍       | 121/492 [4:05:55<11:33:50, 112.21s/it] 25%|██▍       | 122/492 [4:07:48<11:32:14, 112.26s/it] 25%|██▌       | 123/492 [4:09:40<11:30:54, 112.34s/it]/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 25%|██▌       | 124/492 [4:11:40<11:42:54, 114.61s/it] 25%|██▌       | 125/492 [4:13:32<11:36:21, 113.85s/it]                                                        25%|██▌       | 125/492 [4:13:32<11:36:21, 113.85s/it] 26%|██▌       | 126/492 [4:15:24<11:31:22, 113.34s/it] 26%|██▌       | 127/492 [4:17:16<11:27:05, 112.95s/it] 26%|██▌       | 128/492 [4:19:08<11:23:22, 112.64s/it] 26%|██▌       | 129/492 [4:21:01<11:20:49, 112.53s/it] 26%|██▋       | 130/492 [4:22:53<11:18:11, 112.41s/it]                                                        26%|██▋       | 130/492 [4:22:53<11:18:11, 112.41s/it] 27%|██▋       | 131/492 [4:24:45<11:16:47, 112.49s/it] 27%|██▋       | 132/492 [4:26:39<11:16:20, 112.72s/it] 27%|██▋       | 133/492 [4:28:31<11:13:34, 112.58s/it] 27%|██▋       | 134/492 [4:30:23<11:11:06, 112.48s/it] 27%|██▋       | 135/492 [4:32:15<11:08:40, 112.38s/it]                                                        27%|██▋       | 135/492 [4:32:15<11:08:40, 112.38s/it] 28%|██▊       | 136/492 [4:34:07<11:05:42, 112.20s/it] 28%|██▊       | 137/492 [4:35:59<11:03:34, 112.15s/it] 28%|██▊       | 138/492 [4:37:51<11:01:54, 112.19s/it] 28%|██▊       | 139/492 [4:39:43<10:59:42, 112.13s/it] 28%|██▊       | 140/492 [4:41:36<10:57:54, 112.14s/it]                                                        28%|██▊       | 140/492 [4:41:36<10:57:54, 112.14s/it] 29%|██▊       | 141/492 [4:43:28<10:55:57, 112.13s/it] 29%|██▉       | 142/492 [4:45:20<10:53:47, 112.08s/it] 29%|██▉       | 143/492 [4:47:12<10:52:05, 112.11s/it] 29%|██▉       | 144/492 [4:49:04<10:50:19, 112.12s/it] 29%|██▉       | 145/492 [4:50:56<10:48:04, 112.06s/it]                                                        29%|██▉       | 145/492 [4:50:56<10:48:04, 112.06s/it] 30%|██▉       | 146/492 [4:52:48<10:46:27, 112.10s/it] 30%|██▉       | 147/492 [4:54:40<10:44:06, 112.02s/it] 30%|███       | 148/492 [4:56:32<10:42:16, 112.03s/it] 30%|███       | 149/492 [4:58:24<10:40:18, 112.01s/it] 30%|███       | 150/492 [5:00:16<10:37:55, 111.92s/it]                                                        30%|███       | 150/492 [5:00:16<10:37:55, 111.92s/it]{'eval_loss': 0.14690107107162476, 'eval_runtime': 564.1055, 'eval_samples_per_second': 1.773, 'eval_steps_per_second': 0.222, 'epoch': 0.81}
{'loss': 0.1393, 'grad_norm': 0.0379624105989933, 'learning_rate': 9.622790355191672e-05, 'epoch': 0.85}
{'loss': 0.1408, 'grad_norm': 0.046673040837049484, 'learning_rate': 9.552177749846083e-05, 'epoch': 0.89}
{'loss': 0.1482, 'grad_norm': 0.04505982622504234, 'learning_rate': 9.475816456775313e-05, 'epoch': 0.93}
{'loss': 0.141, 'grad_norm': 0.04212146997451782, 'learning_rate': 9.393802908335977e-05, 'epoch': 0.97}
{'loss': 0.144, 'grad_norm': 0.044183164834976196, 'learning_rate': 9.306240674798203e-05, 'epoch': 1.02}
{'loss': 0.1376, 'grad_norm': 0.050254255533218384, 'learning_rate': 9.213240333552589e-05, 'epoch': 1.06}
{'loss': 0.1583, 'grad_norm': 0.050791483372449875, 'learning_rate': 9.114919329468282e-05, 'epoch': 1.1}
{'loss': 0.1307, 'grad_norm': 0.05157487466931343, 'learning_rate': 9.011401826578492e-05, 'epoch': 1.14}
{'loss': 0.134, 'grad_norm': 0.05917412042617798, 'learning_rate': 8.902818551280758e-05, 'epoch': 1.18}
{'loss': 0.1252, 'grad_norm': 0.047791987657547, 'learning_rate': 8.789306627249985e-05, 'epoch': 1.22}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:37,  2.26s/it][A
  2%|▏         | 3/125 [00:09<06:31,  3.21s/it][A
  3%|▎         | 4/125 [00:13<07:26,  3.69s/it][A
  4%|▍         | 5/125 [00:18<07:59,  3.99s/it][A
  5%|▍         | 6/125 [00:22<08:15,  4.17s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.28s/it][A
  6%|▋         | 8/125 [00:31<08:29,  4.35s/it][A
  7%|▋         | 9/125 [00:36<08:29,  4.39s/it][A
  8%|▊         | 10/125 [00:40<08:30,  4.44s/it][A
  9%|▉         | 11/125 [00:45<08:30,  4.47s/it][A
 10%|▉         | 12/125 [00:49<08:26,  4.48s/it][A
 10%|█         | 13/125 [00:54<08:21,  4.48s/it][A
 11%|█         | 14/125 [00:58<08:18,  4.49s/it][A
 12%|█▏        | 15/125 [01:03<08:13,  4.49s/it][A
 13%|█▎        | 16/125 [01:07<08:10,  4.50s/it][A
 14%|█▎        | 17/125 [01:12<08:07,  4.51s/it][A
 14%|█▍        | 18/125 [01:16<08:02,  4.51s/it][A
 15%|█▌        | 19/125 [01:21<07:57,  4.50s/it][A
 16%|█▌        | 20/125 [01:25<07:53,  4.51s/it][A
 17%|█▋        | 21/125 [01:30<07:48,  4.50s/it][A
 18%|█▊        | 22/125 [01:34<07:42,  4.49s/it][A
 18%|█▊        | 23/125 [01:39<07:37,  4.49s/it][A
 19%|█▉        | 24/125 [01:43<07:35,  4.51s/it][A
 20%|██        | 25/125 [01:48<07:33,  4.53s/it][A
 21%|██        | 26/125 [01:52<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:57<07:24,  4.53s/it][A
 22%|██▏       | 28/125 [02:01<07:17,  4.51s/it][A
 23%|██▎       | 29/125 [02:06<07:13,  4.51s/it][A
 24%|██▍       | 30/125 [02:10<07:07,  4.50s/it][A
 25%|██▍       | 31/125 [02:15<07:03,  4.51s/it][A
 26%|██▌       | 32/125 [02:19<06:58,  4.50s/it][A
 26%|██▋       | 33/125 [02:24<06:53,  4.50s/it][A
 27%|██▋       | 34/125 [02:28<06:48,  4.49s/it][A
 28%|██▊       | 35/125 [02:33<06:44,  4.49s/it][A
 29%|██▉       | 36/125 [02:37<06:40,  4.50s/it][A
 30%|██▉       | 37/125 [02:42<06:35,  4.49s/it][A
 30%|███       | 38/125 [02:46<06:30,  4.49s/it][A
 31%|███       | 39/125 [02:51<06:26,  4.50s/it][A
 32%|███▏      | 40/125 [02:55<06:22,  4.50s/it][A
 33%|███▎      | 41/125 [03:00<06:19,  4.52s/it][A
 34%|███▎      | 42/125 [03:05<06:14,  4.52s/it][A
 34%|███▍      | 43/125 [03:09<06:09,  4.51s/it][A
 35%|███▌      | 44/125 [03:13<06:05,  4.51s/it][A
 36%|███▌      | 45/125 [03:18<06:02,  4.53s/it][A
 37%|███▋      | 46/125 [03:23<05:56,  4.52s/it][A
 38%|███▊      | 47/125 [03:27<05:50,  4.50s/it][A
 38%|███▊      | 48/125 [03:32<05:47,  4.51s/it][A
 39%|███▉      | 49/125 [03:36<05:42,  4.51s/it][A
 40%|████      | 50/125 [03:41<05:38,  4.51s/it][A
 41%|████      | 51/125 [03:45<05:33,  4.51s/it][A
 42%|████▏     | 52/125 [03:50<05:29,  4.51s/it][A
 42%|████▏     | 53/125 [03:54<05:24,  4.51s/it][A
 43%|████▎     | 54/125 [03:59<05:20,  4.52s/it][A
 44%|████▍     | 55/125 [04:03<05:16,  4.52s/it][A
 45%|████▍     | 56/125 [04:08<05:11,  4.52s/it][A
 46%|████▌     | 57/125 [04:12<05:07,  4.52s/it][A
 46%|████▋     | 58/125 [04:17<05:03,  4.53s/it][A
 47%|████▋     | 59/125 [04:21<04:57,  4.51s/it][A
 48%|████▊     | 60/125 [04:26<04:53,  4.51s/it][A
 49%|████▉     | 61/125 [04:30<04:47,  4.50s/it][A
 50%|████▉     | 62/125 [04:35<04:43,  4.50s/it][A
 50%|█████     | 63/125 [04:39<04:39,  4.52s/it][A
 51%|█████     | 64/125 [04:44<04:35,  4.52s/it][A
 52%|█████▏    | 65/125 [04:48<04:30,  4.50s/it][A
 53%|█████▎    | 66/125 [04:53<04:26,  4.52s/it][A
 54%|█████▎    | 67/125 [04:57<04:21,  4.51s/it][A
 54%|█████▍    | 68/125 [05:02<04:17,  4.51s/it][A
 55%|█████▌    | 69/125 [05:06<04:12,  4.50s/it][A
 56%|█████▌    | 70/125 [05:11<04:08,  4.51s/it][A
 57%|█████▋    | 71/125 [05:15<04:03,  4.52s/it][A
 58%|█████▊    | 72/125 [05:20<03:59,  4.53s/it][A
 58%|█████▊    | 73/125 [05:24<03:55,  4.53s/it][A
 59%|█████▉    | 74/125 [05:29<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:34<03:47,  4.55s/it][A
 61%|██████    | 76/125 [05:38<03:42,  4.54s/it][A
 62%|██████▏   | 77/125 [05:43<03:37,  4.53s/it][A
 62%|██████▏   | 78/125 [05:47<03:32,  4.52s/it][A
 63%|██████▎   | 79/125 [05:52<03:27,  4.50s/it][A
 64%|██████▍   | 80/125 [05:56<03:22,  4.51s/it][A
 65%|██████▍   | 81/125 [06:01<03:18,  4.52s/it][A
 66%|██████▌   | 82/125 [06:05<03:13,  4.51s/it][A
 66%|██████▋   | 83/125 [06:10<03:09,  4.50s/it][A
 67%|██████▋   | 84/125 [06:14<03:04,  4.50s/it][A
 68%|██████▊   | 85/125 [06:19<03:00,  4.51s/it][A
 69%|██████▉   | 86/125 [06:23<02:55,  4.51s/it][A
 70%|██████▉   | 87/125 [06:28<02:51,  4.52s/it][A
 70%|███████   | 88/125 [06:32<02:47,  4.51s/it][A
 71%|███████   | 89/125 [06:37<02:42,  4.51s/it][A
 72%|███████▏  | 90/125 [06:41<02:37,  4.50s/it][A
 73%|███████▎  | 91/125 [06:46<02:32,  4.49s/it][A
 74%|███████▎  | 92/125 [06:50<02:27,  4.48s/it][A
 74%|███████▍  | 93/125 [06:55<02:24,  4.51s/it][A
 75%|███████▌  | 94/125 [06:59<02:19,  4.50s/it][A
 76%|███████▌  | 95/125 [07:04<02:15,  4.51s/it][A
 77%|███████▋  | 96/125 [07:08<02:10,  4.50s/it][A
 78%|███████▊  | 97/125 [07:13<02:06,  4.51s/it][A
 78%|███████▊  | 98/125 [07:17<02:01,  4.50s/it][A
 79%|███████▉  | 99/125 [07:22<01:56,  4.50s/it][A
 80%|████████  | 100/125 [07:26<01:52,  4.50s/it][A
 81%|████████  | 101/125 [07:31<01:48,  4.50s/it][A
 82%|████████▏ | 102/125 [07:35<01:43,  4.52s/it][A
 82%|████████▏ | 103/125 [07:40<01:39,  4.53s/it][A
 83%|████████▎ | 104/125 [07:44<01:35,  4.53s/it][A
 84%|████████▍ | 105/125 [07:49<01:30,  4.52s/it][A
 85%|████████▍ | 106/125 [07:53<01:25,  4.51s/it][A
 86%|████████▌ | 107/125 [07:58<01:20,  4.50s/it][A
 86%|████████▋ | 108/125 [08:02<01:16,  4.50s/it][A
 87%|████████▋ | 109/125 [08:07<01:12,  4.51s/it][A
 88%|████████▊ | 110/125 [08:11<01:07,  4.50s/it][A
 89%|████████▉ | 111/125 [08:16<01:03,  4.51s/it][A
 90%|████████▉ | 112/125 [08:20<00:58,  4.51s/it][A
 90%|█████████ | 113/125 [08:25<00:53,  4.49s/it][A
 91%|█████████ | 114/125 [08:29<00:49,  4.52s/it][A
 92%|█████████▏| 115/125 [08:34<00:45,  4.53s/it][A
 93%|█████████▎| 116/125 [08:38<00:40,  4.52s/it][A
 94%|█████████▎| 117/125 [08:43<00:36,  4.53s/it][A
 94%|█████████▍| 118/125 [08:47<00:31,  4.52s/it][A
 95%|█████████▌| 119/125 [08:52<00:27,  4.52s/it][A
 96%|█████████▌| 120/125 [08:56<00:22,  4.51s/it][A
 97%|█████████▋| 121/125 [09:01<00:18,  4.52s/it][A
 98%|█████████▊| 122/125 [09:06<00:13,  4.52s/it][A
 98%|█████████▊| 123/125 [09:10<00:09,  4.54s/it][A
 99%|█████████▉| 124/125 [09:15<00:04,  4.53s/it][A
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A                                                       
                                                 [A 30%|███       | 150/492 [5:09:40<10:37:55, 111.92s/it]
100%|██████████| 125/125 [09:20<00:00,  4.53s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-150)... Done. 8.9s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 31%|███       | 151/492 [5:11:51<27:10:22, 286.87s/it] 31%|███       | 152/492 [5:13:43<22:08:36, 234.46s/it] 31%|███       | 153/492 [5:15:35<18:37:04, 197.71s/it] 31%|███▏      | 154/492 [5:17:27<16:09:12, 172.05s/it] 32%|███▏      | 155/492 [5:19:19<14:24:35, 153.93s/it]                                                        32%|███▏      | 155/492 [5:19:19<14:24:35, 153.93s/it] 32%|███▏      | 156/492 [5:21:11<13:12:11, 141.46s/it] 32%|███▏      | 157/492 [5:23:03<12:20:46, 132.68s/it] 32%|███▏      | 158/492 [5:24:55<11:43:49, 126.43s/it] 32%|███▏      | 159/492 [5:26:47<11:17:53, 122.14s/it] 33%|███▎      | 160/492 [5:28:39<10:59:17, 119.15s/it]                                                        33%|███▎      | 160/492 [5:28:39<10:59:17, 119.15s/it] 33%|███▎      | 161/492 [5:30:31<10:45:24, 116.99s/it] 33%|███▎      | 162/492 [5:32:24<10:35:43, 115.59s/it] 33%|███▎      | 163/492 [5:34:16<10:28:34, 114.63s/it] 33%|███▎      | 164/492 [5:36:09<10:23:02, 113.97s/it] 34%|███▎      | 165/492 [5:38:01<10:18:29, 113.48s/it]                                                        34%|███▎      | 165/492 [5:38:01<10:18:29, 113.48s/it] 34%|███▎      | 166/492 [5:39:53<10:14:13, 113.05s/it] 34%|███▍      | 167/492 [5:41:45<10:11:20, 112.86s/it] 34%|███▍      | 168/492 [5:43:38<10:08:19, 112.65s/it] 34%|███▍      | 169/492 [5:45:30<10:05:23, 112.46s/it] 35%|███▍      | 170/492 [5:47:22<10:03:15, 112.41s/it]                                                        35%|███▍      | 170/492 [5:47:22<10:03:15, 112.41s/it] 35%|███▍      | 171/492 [5:49:14<10:01:32, 112.44s/it] 35%|███▍      | 172/492 [5:51:06<9:59:10, 112.34s/it]  35%|███▌      | 173/492 [5:52:58<9:56:32, 112.20s/it] 35%|███▌      | 174/492 [5:54:50<9:54:25, 112.16s/it] 36%|███▌      | 175/492 [5:56:43<9:52:39, 112.18s/it]                                                       36%|███▌      | 175/492 [5:56:43<9:52:39, 112.18s/it] 36%|███▌      | 176/492 [5:58:35<9:50:25, 112.11s/it] 36%|███▌      | 177/492 [6:00:26<9:48:06, 112.02s/it] 36%|███▌      | 178/492 [6:02:19<9:46:38, 112.10s/it] 36%|███▋      | 179/492 [6:04:11<9:45:15, 112.19s/it] 37%|███▋      | 180/492 [6:06:03<9:43:05, 112.13s/it]                                                       37%|███▋      | 180/492 [6:06:03<9:43:05, 112.13s/it] 37%|███▋      | 181/492 [6:07:55<9:41:15, 112.14s/it] 37%|███▋      | 182/492 [6:09:47<9:39:22, 112.14s/it] 37%|███▋      | 183/492 [6:11:39<9:36:52, 112.01s/it] 37%|███▋      | 184/492 [6:13:31<9:35:32, 112.12s/it] 38%|███▊      | 185/492 [6:15:23<9:33:25, 112.07s/it]                                                       38%|███▊      | 185/492 [6:15:23<9:33:25, 112.07s/it] 38%|███▊      | 186/492 [6:17:15<9:31:31, 112.06s/it] 38%|███▊      | 187/492 [6:19:07<9:29:21, 112.00s/it] 38%|███▊      | 188/492 [6:20:59<9:26:53, 111.89s/it] 38%|███▊      | 189/492 [6:22:51<9:24:56, 111.87s/it] 39%|███▊      | 190/492 [6:24:43<9:23:10, 111.89s/it]                                                       39%|███▊      | 190/492 [6:24:43<9:23:10, 111.89s/it] 39%|███▉      | 191/492 [6:26:35<9:21:50, 112.00s/it] 39%|███▉      | 192/492 [6:28:27<9:19:36, 111.92s/it] 39%|███▉      | 193/492 [6:30:20<9:19:08, 112.20s/it] 39%|███▉      | 194/492 [6:32:11<9:16:27, 112.04s/it] 40%|███▉      | 195/492 [6:34:03<9:14:22, 111.99s/it]                                                       40%|███▉      | 195/492 [6:34:03<9:14:22, 111.99s/it] 40%|███▉      | 196/492 [6:35:55<9:12:57, 112.08s/it] 40%|████      | 197/492 [6:37:48<9:11:15, 112.12s/it] 40%|████      | 198/492 [6:39:40<9:09:09, 112.07s/it] 40%|████      | 199/492 [6:41:32<9:08:00, 112.22s/it] 41%|████      | 200/492 [6:43:24<9:05:57, 112.18s/it]                                                       41%|████      | 200/492 [6:43:24<9:05:57, 112.18s/it]{'eval_loss': 0.1394234001636505, 'eval_runtime': 564.1635, 'eval_samples_per_second': 1.773, 'eval_steps_per_second': 0.222, 'epoch': 1.22}
{'loss': 0.1289, 'grad_norm': 0.06823377311229706, 'learning_rate': 8.6710094022727e-05, 'epoch': 1.26}
{'loss': 0.1345, 'grad_norm': 0.10027821362018585, 'learning_rate': 8.548076267221256e-05, 'epoch': 1.3}
{'loss': 0.147, 'grad_norm': 0.08134859055280685, 'learning_rate': 8.420662467396547e-05, 'epoch': 1.34}
{'loss': 0.1328, 'grad_norm': 0.0758972093462944, 'learning_rate': 8.288928906477496e-05, 'epoch': 1.38}
{'loss': 0.1311, 'grad_norm': 0.07111922651529312, 'learning_rate': 8.15304194332491e-05, 'epoch': 1.42}
{'loss': 0.126, 'grad_norm': 0.05676901340484619, 'learning_rate': 8.013173181896283e-05, 'epoch': 1.46}
{'loss': 0.1265, 'grad_norm': 0.058128587901592255, 'learning_rate': 7.869499254536865e-05, 'epoch': 1.5}
{'loss': 0.1194, 'grad_norm': 0.07095002382993698, 'learning_rate': 7.722201598920673e-05, 'epoch': 1.54}
{'loss': 0.1274, 'grad_norm': 0.06738153845071793, 'learning_rate': 7.571466228923115e-05, 'epoch': 1.58}
{'loss': 0.1396, 'grad_norm': 0.08010146021842957, 'learning_rate': 7.417483499714589e-05, 'epoch': 1.62}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:37,  2.26s/it][A
  2%|▏         | 3/125 [00:09<06:31,  3.21s/it][A
  3%|▎         | 4/125 [00:13<07:26,  3.69s/it][A
  4%|▍         | 5/125 [00:18<07:59,  4.00s/it][A
  5%|▍         | 6/125 [00:22<08:16,  4.17s/it][A
  6%|▌         | 7/125 [00:27<08:25,  4.29s/it][A
  6%|▋         | 8/125 [00:31<08:29,  4.35s/it][A
  7%|▋         | 9/125 [00:36<08:29,  4.39s/it][A
  8%|▊         | 10/125 [00:40<08:30,  4.44s/it][A
  9%|▉         | 11/125 [00:45<08:29,  4.47s/it][A
 10%|▉         | 12/125 [00:49<08:25,  4.48s/it][A
 10%|█         | 13/125 [00:54<08:21,  4.48s/it][A
 11%|█         | 14/125 [00:58<08:18,  4.49s/it][A
 12%|█▏        | 15/125 [01:03<08:13,  4.49s/it][A
 13%|█▎        | 16/125 [01:07<08:10,  4.50s/it][A
 14%|█▎        | 17/125 [01:12<08:06,  4.51s/it][A
 14%|█▍        | 18/125 [01:16<08:02,  4.51s/it][A
 15%|█▌        | 19/125 [01:21<07:57,  4.50s/it][A
 16%|█▌        | 20/125 [01:25<07:53,  4.51s/it][A
 17%|█▋        | 21/125 [01:30<07:48,  4.50s/it][A
 18%|█▊        | 22/125 [01:34<07:43,  4.50s/it][A
 18%|█▊        | 23/125 [01:39<07:37,  4.49s/it][A
 19%|█▉        | 24/125 [01:43<07:35,  4.51s/it][A
 20%|██        | 25/125 [01:48<07:33,  4.54s/it][A
 21%|██        | 26/125 [01:52<07:30,  4.55s/it][A
 22%|██▏       | 27/125 [01:57<07:24,  4.54s/it][A
 22%|██▏       | 28/125 [02:01<07:17,  4.51s/it][A
 23%|██▎       | 29/125 [02:06<07:13,  4.51s/it][A
 24%|██▍       | 30/125 [02:10<07:07,  4.50s/it][A
 25%|██▍       | 31/125 [02:15<07:03,  4.51s/it][A
 26%|██▌       | 32/125 [02:19<06:58,  4.50s/it][A
 26%|██▋       | 33/125 [02:24<06:54,  4.50s/it][A
 27%|██▋       | 34/125 [02:28<06:49,  4.49s/it][A
 28%|██▊       | 35/125 [02:33<06:44,  4.49s/it][A
 29%|██▉       | 36/125 [02:37<06:40,  4.50s/it][A
 30%|██▉       | 37/125 [02:42<06:35,  4.49s/it][A
 30%|███       | 38/125 [02:46<06:30,  4.49s/it][A
 31%|███       | 39/125 [02:51<06:27,  4.50s/it][A
 32%|███▏      | 40/125 [02:55<06:22,  4.50s/it][A
 33%|███▎      | 41/125 [03:00<06:20,  4.52s/it][A
 34%|███▎      | 42/125 [03:04<06:14,  4.52s/it][A
 34%|███▍      | 43/125 [03:09<06:09,  4.51s/it][A
 35%|███▌      | 44/125 [03:13<06:05,  4.51s/it][A
 36%|███▌      | 45/125 [03:18<06:02,  4.53s/it][A
 37%|███▋      | 46/125 [03:23<05:56,  4.51s/it][A
 38%|███▊      | 47/125 [03:27<05:50,  4.50s/it][A
 38%|███▊      | 48/125 [03:32<05:46,  4.51s/it][A
 39%|███▉      | 49/125 [03:36<05:42,  4.50s/it][A
 40%|████      | 50/125 [03:41<05:38,  4.51s/it][A
 41%|████      | 51/125 [03:45<05:33,  4.51s/it][A
 42%|████▏     | 52/125 [03:50<05:28,  4.51s/it][A
 42%|████▏     | 53/125 [03:54<05:24,  4.51s/it][A
 43%|████▎     | 54/125 [03:59<05:20,  4.51s/it][A
 44%|████▍     | 55/125 [04:03<05:16,  4.52s/it][A
 45%|████▍     | 56/125 [04:08<05:11,  4.52s/it][A
 46%|████▌     | 57/125 [04:12<05:06,  4.51s/it][A
 46%|████▋     | 58/125 [04:17<05:03,  4.53s/it][A
 47%|████▋     | 59/125 [04:21<04:57,  4.51s/it][A
 48%|████▊     | 60/125 [04:26<04:53,  4.51s/it][A
 49%|████▉     | 61/125 [04:30<04:47,  4.50s/it][A
 50%|████▉     | 62/125 [04:35<04:43,  4.50s/it][A
 50%|█████     | 63/125 [04:39<04:40,  4.52s/it][A
 51%|█████     | 64/125 [04:44<04:35,  4.52s/it][A
 52%|█████▏    | 65/125 [04:48<04:30,  4.50s/it][A
 53%|█████▎    | 66/125 [04:53<04:26,  4.52s/it][A
 54%|█████▎    | 67/125 [04:57<04:21,  4.50s/it][A
 54%|█████▍    | 68/125 [05:02<04:16,  4.51s/it][A
 55%|█████▌    | 69/125 [05:06<04:12,  4.50s/it][A
 56%|█████▌    | 70/125 [05:11<04:08,  4.51s/it][A
 57%|█████▋    | 71/125 [05:15<04:03,  4.52s/it][A
 58%|█████▊    | 72/125 [05:20<04:00,  4.53s/it][A
 58%|█████▊    | 73/125 [05:24<03:55,  4.53s/it][A
 59%|█████▉    | 74/125 [05:29<03:53,  4.57s/it][A
 60%|██████    | 75/125 [05:34<03:47,  4.55s/it][A
 61%|██████    | 76/125 [05:38<03:42,  4.54s/it][A
 62%|██████▏   | 77/125 [05:43<03:37,  4.53s/it][A
 62%|██████▏   | 78/125 [05:47<03:32,  4.52s/it][A
 63%|██████▎   | 79/125 [05:52<03:27,  4.50s/it][A
 64%|██████▍   | 80/125 [05:56<03:22,  4.51s/it][A
 65%|██████▍   | 81/125 [06:01<03:18,  4.52s/it][A
 66%|██████▌   | 82/125 [06:05<03:13,  4.51s/it][A
 66%|██████▋   | 83/125 [06:10<03:09,  4.50s/it][A
 67%|██████▋   | 84/125 [06:14<03:04,  4.50s/it][A
 68%|██████▊   | 85/125 [06:19<03:00,  4.51s/it][A
 69%|██████▉   | 86/125 [06:23<02:55,  4.51s/it][A
 70%|██████▉   | 87/125 [06:28<02:51,  4.52s/it][A
 70%|███████   | 88/125 [06:32<02:46,  4.51s/it][A
 71%|███████   | 89/125 [06:37<02:42,  4.51s/it][A
 72%|███████▏  | 90/125 [06:41<02:37,  4.50s/it][A
 73%|███████▎  | 91/125 [06:46<02:32,  4.49s/it][A
 74%|███████▎  | 92/125 [06:50<02:27,  4.48s/it][A
 74%|███████▍  | 93/125 [06:55<02:24,  4.51s/it][A
 75%|███████▌  | 94/125 [06:59<02:19,  4.50s/it][A
 76%|███████▌  | 95/125 [07:04<02:15,  4.51s/it][A
 77%|███████▋  | 96/125 [07:08<02:10,  4.50s/it][A
 78%|███████▊  | 97/125 [07:13<02:06,  4.51s/it][A
 78%|███████▊  | 98/125 [07:17<02:01,  4.50s/it][A
 79%|███████▉  | 99/125 [07:22<01:56,  4.50s/it][A
 80%|████████  | 100/125 [07:26<01:52,  4.50s/it][A
 81%|████████  | 101/125 [07:31<01:48,  4.50s/it][A
 82%|████████▏ | 102/125 [07:35<01:43,  4.52s/it][A
 82%|████████▏ | 103/125 [07:40<01:39,  4.53s/it][A
 83%|████████▎ | 104/125 [07:44<01:35,  4.53s/it][A
 84%|████████▍ | 105/125 [07:49<01:30,  4.52s/it][A
 85%|████████▍ | 106/125 [07:53<01:25,  4.51s/it][A
 86%|████████▌ | 107/125 [07:58<01:20,  4.50s/it][A
 86%|████████▋ | 108/125 [08:02<01:16,  4.50s/it][A
 87%|████████▋ | 109/125 [08:07<01:12,  4.51s/it][A
 88%|████████▊ | 110/125 [08:11<01:07,  4.50s/it][A
 89%|████████▉ | 111/125 [08:16<01:03,  4.51s/it][A
 90%|████████▉ | 112/125 [08:20<00:58,  4.51s/it][A
 90%|█████████ | 113/125 [08:25<00:53,  4.49s/it][A
 91%|█████████ | 114/125 [08:29<00:49,  4.51s/it][A
 92%|█████████▏| 115/125 [08:34<00:45,  4.53s/it][A
 93%|█████████▎| 116/125 [08:38<00:40,  4.52s/it][A
 94%|█████████▎| 117/125 [08:43<00:36,  4.53s/it][A
 94%|█████████▍| 118/125 [08:47<00:31,  4.52s/it][A
 95%|█████████▌| 119/125 [08:52<00:27,  4.52s/it][A
 96%|█████████▌| 120/125 [08:56<00:22,  4.51s/it][A
 97%|█████████▋| 121/125 [09:01<00:18,  4.52s/it][A
 98%|█████████▊| 122/125 [09:05<00:13,  4.52s/it][A
 98%|█████████▊| 123/125 [09:10<00:09,  4.54s/it][A
 99%|█████████▉| 124/125 [09:15<00:04,  4.53s/it][A
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A                                                      
                                                 [A 41%|████      | 200/492 [6:52:48<9:05:57, 112.18s/it]
100%|██████████| 125/125 [09:19<00:00,  4.53s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-200)... Done. 8.9s
/workspace/venv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 41%|████      | 201/492 [6:55:00<23:12:48, 287.18s/it] 41%|████      | 202/492 [6:56:52<18:53:45, 234.57s/it] 41%|████▏     | 203/492 [6:58:44<15:53:07, 197.88s/it] 41%|████▏     | 204/492 [7:00:36<13:46:10, 172.12s/it] 42%|████▏     | 205/492 [7:02:28<12:16:58, 154.07s/it]                                                        42%|████▏     | 205/492 [7:02:28<12:16:58, 154.07s/it] 42%|████▏     | 206/492 [7:04:20<11:14:29, 141.50s/it] 42%|████▏     | 207/492 [7:06:12<10:29:55, 132.61s/it] 42%|████▏     | 208/492 [7:08:04<9:59:08, 126.58s/it]  42%|████▏     | 209/492 [7:09:56<9:36:13, 122.17s/it] 43%|████▎     | 210/492 [7:11:48<9:19:36, 119.06s/it]                                                       43%|████▎     | 210/492 [7:11:48<9:19:36, 119.06s/it] 43%|████▎     | 211/492 [7:13:40<9:07:26, 116.89s/it] 43%|████▎     | 212/492 [7:15:32<8:58:52, 115.47s/it] 43%|████▎     | 213/492 [7:17:24<8:52:15, 114.47s/it] 43%|████▎     | 214/492 [7:19:16<8:47:29, 113.85s/it] 44%|████▎     | 215/492 [7:21:09<8:43:13, 113.33s/it]                                                       44%|████▎     | 215/492 [7:21:09<8:43:13, 113.33s/it] 44%|████▍     | 216/492 [7:23:01<8:39:27, 112.93s/it] 44%|████▍     | 217/492 [7:24:53<8:37:09, 112.84s/it] 44%|████▍     | 218/492 [7:26:45<8:34:19, 112.62s/it] 45%|████▍     | 219/492 [7:28:37<8:31:23, 112.39s/it] 45%|████▍     | 220/492 [7:30:30<8:29:23, 112.37s/it]                                                       45%|████▍     | 220/492 [7:30:30<8:29:23, 112.37s/it] 45%|████▍     | 221/492 [7:32:22<8:27:45, 112.42s/it] 45%|████▌     | 222/492 [7:34:14<8:25:19, 112.29s/it] 45%|████▌     | 223/492 [7:36:06<8:22:54, 112.17s/it] 46%|████▌     | 224/492 [7:37:58<8:20:46, 112.11s/it] 46%|████▌     | 225/492 [7:39:50<8:18:24, 112.00s/it]                                                       46%|████▌     | 225/492 [7:39:50<8:18:24, 112.00s/it] 46%|████▌     | 226/492 [7:41:42<8:16:58, 112.10s/it] 46%|████▌     | 227/492 [7:43:34<8:14:53, 112.05s/it] 46%|████▋     | 228/492 [7:45:27<8:13:47, 112.22s/it] 47%|████▋     | 229/492 [7:47:19<8:12:09, 112.28s/it] 47%|████▋     | 230/492 [7:49:11<8:10:20, 112.29s/it]                                                       47%|████▋     | 230/492 [7:49:11<8:10:20, 112.29s/it] 47%|████▋     | 231/492 [7:51:04<8:08:53, 112.39s/it] 47%|████▋     | 232/492 [7:52:56<8:07:07, 112.41s/it] 47%|████▋     | 233/492 [7:54:49<8:05:11, 112.40s/it] 48%|████▊     | 234/492 [7:56:41<8:03:30, 112.44s/it] 48%|████▊     | 235/492 [7:58:33<8:00:51, 112.26s/it]                                                       48%|████▊     | 235/492 [7:58:33<8:00:51, 112.26s/it] 48%|████▊     | 236/492 [8:00:25<7:58:48, 112.22s/it] 48%|████▊     | 237/492 [8:02:17<7:56:49, 112.19s/it] 48%|████▊     | 238/492 [8:04:09<7:54:30, 112.09s/it] 49%|████▊     | 239/492 [8:06:01<7:52:36, 112.08s/it] 49%|████▉     | 240/492 [8:07:53<7:50:47, 112.09s/it]                                                       49%|████▉     | 240/492 [8:07:53<7:50:47, 112.09s/it] 49%|████▉     | 241/492 [8:09:46<7:49:05, 112.13s/it] 49%|████▉     | 242/492 [8:11:37<7:46:35, 111.98s/it] 49%|████▉     | 243/492 [8:13:30<7:45:13, 112.10s/it] 50%|████▉     | 244/492 [8:15:22<7:43:36, 112.16s/it]