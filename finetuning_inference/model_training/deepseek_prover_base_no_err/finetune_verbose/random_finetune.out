nohup: ignoring input
Finetuning starting.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.11s/it]
trainable params: 10,644,480 || all params: 6,901,373,952 || trainable%: 0.1542
[2024-09-07 18:56:14,510] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/workspace/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py:3108: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(os.path.join(checkpoint, OPTIMIZER_NAME), map_location=map_location)
wandb: Currently logged in as: tcwong. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.7
wandb: Run data is saved locally in /workspace/wandb/run-20240907_185630-v2s2rx9y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deepseek_prover_base_no_err-random-09-07-09-02
wandb: ⭐️ View project at https://wandb.ai/tcwong/decoder
wandb: 🚀 View run at https://wandb.ai/tcwong/decoder/runs/v2s2rx9y
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
  0%|          | 0/492 [00:00<?, ?it/s]/workspace/venv/lib/python3.10/site-packages/transformers/trainer.py:2843: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint_rng_state = torch.load(rng_file)
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0] Graph break from `Tensor.item()`, consider setting:
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0]     torch._dynamo.config.capture_scalar_outputs = True
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0] or:
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0] to include these operations in the captured graph.
W0907 18:56:36.880000 135419832627200 torch/_dynamo/variables/tensor.py:715] [17/0] 
The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 41%|████      | 201/492 [02:03<02:58,  1.63it/s] 41%|████      | 202/492 [03:55<06:46,  1.40s/it] 41%|████▏     | 203/492 [05:48<12:06,  2.51s/it] 41%|████▏     | 204/492 [07:40<19:28,  4.06s/it] 42%|████▏     | 205/492 [09:34<29:41,  6.21s/it]                                                  42%|████▏     | 205/492 [09:34<29:41,  6.21s/it] 42%|████▏     | 206/492 [11:26<43:25,  9.11s/it] 42%|████▏     | 207/492 [13:18<1:01:42, 12.99s/it] 42%|████▏     | 208/492 [15:11<1:25:33, 18.08s/it] 42%|████▏     | 209/492 [17:03<1:55:26, 24.47s/it] 43%|████▎     | 210/492 [18:55<2:31:31, 32.24s/it]                                                    43%|████▎     | 210/492 [18:55<2:31:31, 32.24s/it] 43%|████▎     | 211/492 [20:48<3:13:02, 41.22s/it] 43%|████▎     | 212/492 [22:41<3:58:39, 51.14s/it] 43%|████▎     | 213/492 [24:34<4:44:56, 61.28s/it] 43%|████▎     | 214/492 [26:26<5:29:25, 71.10s/it] 44%|████▎     | 215/492 [28:19<6:09:12, 79.97s/it]                                                    44%|████▎     | 215/492 [28:19<6:09:12, 79.97s/it] 44%|████▍     | 216/492 [30:11<6:42:53, 87.58s/it] 44%|████▍     | 217/492 [32:04<7:10:26, 93.92s/it] 44%|████▍     | 218/492 [33:57<7:31:02, 98.77s/it] 45%|████▍     | 219/492 [35:49<7:46:23, 102.50s/it] 45%|████▍     | 220/492 [37:41<7:56:42, 105.16s/it]                                                     45%|████▍     | 220/492 [37:41<7:56:42, 105.16s/it] 45%|████▍     | 221/492 [39:34<8:05:00, 107.38s/it] 45%|████▌     | 222/492 [41:27<8:10:18, 108.96s/it] 45%|████▌     | 223/492 [43:19<8:13:21, 110.04s/it] 46%|████▌     | 224/492 [45:11<8:14:16, 110.66s/it] 46%|████▌     | 225/492 [47:04<8:14:37, 111.15s/it]                                                     46%|████▌     | 225/492 [47:04<8:14:37, 111.15s/it] 46%|████▌     | 226/492 [48:57<8:15:19, 111.73s/it] 46%|████▌     | 227/492 [50:50<8:14:40, 112.00s/it] 46%|████▋     | 228/492 [52:42<8:13:29, 112.16s/it] 47%|████▋     | 229/492 [54:35<8:12:14, 112.30s/it] 47%|████▋     | 230/492 [56:27<8:10:11, 112.26s/it]                                                     47%|████▋     | 230/492 [56:27<8:10:11, 112.26s/it] 47%|████▋     | 231/492 [58:20<8:08:57, 112.40s/it] 47%|████▋     | 232/492 [1:00:12<8:06:58, 112.38s/it] 47%|████▋     | 233/492 [1:02:05<8:05:27, 112.46s/it] 48%|████▊     | 234/492 [1:03:57<8:03:51, 112.53s/it] 48%|████▊     | 235/492 [1:05:50<8:02:05, 112.55s/it]                                                       48%|████▊     | 235/492 [1:05:50<8:02:05, 112.55s/it] 48%|████▊     | 236/492 [1:07:43<8:00:31, 112.62s/it] 48%|████▊     | 237/492 [1:09:35<7:58:36, 112.61s/it] 48%|████▊     | 238/492 [1:11:28<7:56:53, 112.65s/it] 49%|████▊     | 239/492 [1:13:20<7:54:31, 112.54s/it] 49%|████▉     | 240/492 [1:15:13<7:52:52, 112.59s/it]                                                       49%|████▉     | 240/492 [1:15:13<7:52:52, 112.59s/it] 49%|████▉     | 241/492 [1:17:06<7:51:01, 112.60s/it] 49%|████▉     | 242/492 [1:18:58<7:48:45, 112.50s/it] 49%|████▉     | 243/492 [1:20:50<7:46:55, 112.51s/it] 50%|████▉     | 244/492 [1:22:43<7:45:03, 112.51s/it] 50%|████▉     | 245/492 [1:24:36<7:43:33, 112.61s/it]                                                       50%|████▉     | 245/492 [1:24:36<7:43:33, 112.61s/it] 50%|█████     | 246/492 [1:26:29<7:42:09, 112.72s/it]/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 50%|█████     | 247/492 [1:28:29<7:49:17, 114.93s/it] 50%|█████     | 248/492 [1:30:22<7:44:44, 114.28s/it] 51%|█████     | 249/492 [1:32:14<7:41:00, 113.83s/it] 51%|█████     | 250/492 [1:34:07<7:37:37, 113.46s/it]                                                       51%|█████     | 250/492 [1:34:07<7:37:37, 113.46s/it]{'loss': 0.1362, 'grad_norm': 0.1655184030532837, 'learning_rate': 7.260447867371709e-05, 'epoch': 1.67}
{'loss': 0.1194, 'grad_norm': 0.07665544748306274, 'learning_rate': 7.100557643309732e-05, 'epoch': 1.71}
{'loss': 0.1319, 'grad_norm': 0.07500068098306656, 'learning_rate': 6.938014743846285e-05, 'epoch': 1.75}
{'loss': 0.1164, 'grad_norm': 0.0936647355556488, 'learning_rate': 6.773024435212678e-05, 'epoch': 1.79}
{'loss': 0.1242, 'grad_norm': 0.08089397102594376, 'learning_rate': 6.605795074334794e-05, 'epoch': 1.83}
{'loss': 0.1223, 'grad_norm': 0.06260140240192413, 'learning_rate': 6.436537845710903e-05, 'epoch': 1.87}
{'loss': 0.1251, 'grad_norm': 0.08003013581037521, 'learning_rate': 6.265466494718732e-05, 'epoch': 1.91}
{'loss': 0.1254, 'grad_norm': 0.09465450048446655, 'learning_rate': 6.092797057688495e-05, 'epoch': 1.95}
{'loss': 0.1198, 'grad_norm': 0.1107378676533699, 'learning_rate': 5.918747589082853e-05, 'epoch': 1.99}
{'loss': 0.1283, 'grad_norm': 0.08334667980670929, 'learning_rate': 5.7435378861282585e-05, 'epoch': 2.03}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:15,  2.07s/it][A
  2%|▏         | 3/125 [00:08<06:18,  3.10s/it][A
  3%|▎         | 4/125 [00:13<07:19,  3.63s/it][A
  4%|▍         | 5/125 [00:17<07:55,  3.96s/it][A
  5%|▍         | 6/125 [00:22<08:13,  4.15s/it][A
  6%|▌         | 7/125 [00:26<08:24,  4.28s/it][A
  6%|▋         | 8/125 [00:31<08:29,  4.35s/it][A
  7%|▋         | 9/125 [00:35<08:29,  4.39s/it][A
  8%|▊         | 10/125 [00:40<08:30,  4.44s/it][A
  9%|▉         | 11/125 [00:44<08:30,  4.48s/it][A
 10%|▉         | 12/125 [00:49<08:26,  4.49s/it][A
 10%|█         | 13/125 [00:53<08:22,  4.49s/it][A
 11%|█         | 14/125 [00:58<08:19,  4.50s/it][A
 12%|█▏        | 15/125 [01:03<08:14,  4.50s/it][A
 13%|█▎        | 16/125 [01:07<08:11,  4.51s/it][A
 14%|█▎        | 17/125 [01:12<08:08,  4.52s/it][A
 14%|█▍        | 18/125 [01:16<08:04,  4.52s/it][A
 15%|█▌        | 19/125 [01:21<07:58,  4.51s/it][A
 16%|█▌        | 20/125 [01:25<07:54,  4.52s/it][A
 17%|█▋        | 21/125 [01:30<07:49,  4.52s/it][A
 18%|█▊        | 22/125 [01:34<07:44,  4.51s/it][A
 18%|█▊        | 23/125 [01:39<07:39,  4.50s/it][A
 19%|█▉        | 24/125 [01:43<07:36,  4.52s/it][A
 20%|██        | 25/125 [01:48<07:34,  4.55s/it][A
 21%|██        | 26/125 [01:52<07:31,  4.56s/it][A
 22%|██▏       | 27/125 [01:57<07:25,  4.55s/it][A
 22%|██▏       | 28/125 [02:01<07:19,  4.53s/it][A
 23%|██▎       | 29/125 [02:06<07:14,  4.53s/it][A
 24%|██▍       | 30/125 [02:10<07:08,  4.51s/it][A
 25%|██▍       | 31/125 [02:15<07:04,  4.52s/it][A
 26%|██▌       | 32/125 [02:19<06:59,  4.52s/it][A
 26%|██▋       | 33/125 [02:24<06:55,  4.52s/it][A
 27%|██▋       | 34/125 [02:28<06:50,  4.51s/it][A
 28%|██▊       | 35/125 [02:33<06:45,  4.51s/it][A
 29%|██▉       | 36/125 [02:37<06:41,  4.52s/it][A
 30%|██▉       | 37/125 [02:42<06:36,  4.51s/it][A
 30%|███       | 38/125 [02:46<06:32,  4.51s/it][A
 31%|███       | 39/125 [02:51<06:28,  4.52s/it][A
 32%|███▏      | 40/125 [02:56<06:23,  4.52s/it][A
 33%|███▎      | 41/125 [03:00<06:21,  4.54s/it][A
 34%|███▎      | 42/125 [03:05<06:16,  4.53s/it][A
 34%|███▍      | 43/125 [03:09<06:11,  4.52s/it][A
 35%|███▌      | 44/125 [03:14<06:06,  4.53s/it][A
 36%|███▌      | 45/125 [03:18<06:03,  4.54s/it][A
 37%|███▋      | 46/125 [03:23<05:57,  4.53s/it][A
 38%|███▊      | 47/125 [03:27<05:52,  4.51s/it][A
 38%|███▊      | 48/125 [03:32<05:48,  4.52s/it][A
 39%|███▉      | 49/125 [03:36<05:43,  4.52s/it][A
 40%|████      | 50/125 [03:41<05:39,  4.52s/it][A
 41%|████      | 51/125 [03:45<05:34,  4.52s/it][A
 42%|████▏     | 52/125 [03:50<05:30,  4.52s/it][A
 42%|████▏     | 53/125 [03:54<05:25,  4.52s/it][A
 43%|████▎     | 54/125 [03:59<05:21,  4.53s/it][A
 44%|████▍     | 55/125 [04:03<05:17,  4.53s/it][A
 45%|████▍     | 56/125 [04:08<05:12,  4.53s/it][A
 46%|████▌     | 57/125 [04:13<05:07,  4.53s/it][A
 46%|████▋     | 58/125 [04:17<05:04,  4.54s/it][A
 47%|████▋     | 59/125 [04:22<04:58,  4.52s/it][A
 48%|████▊     | 60/125 [04:26<04:54,  4.52s/it][A
 49%|████▉     | 61/125 [04:31<04:48,  4.51s/it][A
 50%|████▉     | 62/125 [04:35<04:44,  4.51s/it][A
 50%|█████     | 63/125 [04:40<04:40,  4.53s/it][A
 51%|█████     | 64/125 [04:44<04:36,  4.54s/it][A
 52%|█████▏    | 65/125 [04:49<04:31,  4.52s/it][A
 53%|█████▎    | 66/125 [04:53<04:27,  4.54s/it][A
 54%|█████▎    | 67/125 [04:58<04:22,  4.52s/it][A
 54%|█████▍    | 68/125 [05:02<04:17,  4.52s/it][A
 55%|█████▌    | 69/125 [05:07<04:12,  4.52s/it][A
 56%|█████▌    | 70/125 [05:11<04:08,  4.52s/it][A
 57%|█████▋    | 71/125 [05:16<04:04,  4.53s/it][A
 58%|█████▊    | 72/125 [05:20<04:00,  4.54s/it][A
 58%|█████▊    | 73/125 [05:25<03:55,  4.54s/it][A
 59%|█████▉    | 74/125 [05:30<03:53,  4.58s/it][A
 60%|██████    | 75/125 [05:34<03:47,  4.56s/it][A
 61%|██████    | 76/125 [05:39<03:42,  4.55s/it][A
 62%|██████▏   | 77/125 [05:43<03:38,  4.54s/it][A
 62%|██████▏   | 78/125 [05:48<03:33,  4.54s/it][A
 63%|██████▎   | 79/125 [05:52<03:27,  4.52s/it][A
 64%|██████▍   | 80/125 [05:57<03:23,  4.52s/it][A
 65%|██████▍   | 81/125 [06:01<03:19,  4.53s/it][A
 66%|██████▌   | 82/125 [06:06<03:14,  4.52s/it][A
 66%|██████▋   | 83/125 [06:10<03:09,  4.52s/it][A
 67%|██████▋   | 84/125 [06:15<03:05,  4.52s/it][A
 68%|██████▊   | 85/125 [06:19<03:01,  4.53s/it][A
 69%|██████▉   | 86/125 [06:24<02:56,  4.53s/it][A
 70%|██████▉   | 87/125 [06:28<02:52,  4.53s/it][A
 70%|███████   | 88/125 [06:33<02:47,  4.53s/it][A
 71%|███████   | 89/125 [06:37<02:43,  4.53s/it][A
 72%|███████▏  | 90/125 [06:42<02:38,  4.52s/it][A
 73%|███████▎  | 91/125 [06:46<02:33,  4.51s/it][A
 74%|███████▎  | 92/125 [06:51<02:28,  4.50s/it][A
 74%|███████▍  | 93/125 [06:56<02:24,  4.52s/it][A
 75%|███████▌  | 94/125 [07:00<02:19,  4.52s/it][A
 76%|███████▌  | 95/125 [07:05<02:15,  4.52s/it][A
 77%|███████▋  | 96/125 [07:09<02:11,  4.52s/it][A
 78%|███████▊  | 97/125 [07:14<02:06,  4.52s/it][A
 78%|███████▊  | 98/125 [07:18<02:02,  4.52s/it][A
 79%|███████▉  | 99/125 [07:23<01:57,  4.51s/it][A
 80%|████████  | 100/125 [07:27<01:52,  4.52s/it][A
 81%|████████  | 101/125 [07:32<01:48,  4.52s/it][A
 82%|████████▏ | 102/125 [07:36<01:44,  4.53s/it][A
 82%|████████▏ | 103/125 [07:41<01:40,  4.55s/it][A
 83%|████████▎ | 104/125 [07:45<01:35,  4.54s/it][A
 84%|████████▍ | 105/125 [07:50<01:30,  4.53s/it][A
 85%|████████▍ | 106/125 [07:54<01:25,  4.52s/it][A
 86%|████████▌ | 107/125 [07:59<01:21,  4.51s/it][A
 86%|████████▋ | 108/125 [08:03<01:16,  4.52s/it][A
 87%|████████▋ | 109/125 [08:08<01:12,  4.52s/it][A
 88%|████████▊ | 110/125 [08:12<01:07,  4.52s/it][A
 89%|████████▉ | 111/125 [08:17<01:03,  4.53s/it][A
 90%|████████▉ | 112/125 [08:21<00:58,  4.52s/it][A
 90%|█████████ | 113/125 [08:26<00:54,  4.51s/it][A
 91%|█████████ | 114/125 [08:31<00:49,  4.53s/it][A
 92%|█████████▏| 115/125 [08:35<00:45,  4.54s/it][A
 93%|█████████▎| 116/125 [08:40<00:40,  4.54s/it][A
 94%|█████████▎| 117/125 [08:44<00:36,  4.54s/it][A
 94%|█████████▍| 118/125 [08:49<00:31,  4.54s/it][A
 95%|█████████▌| 119/125 [08:53<00:27,  4.53s/it][A
 96%|█████████▌| 120/125 [08:58<00:22,  4.53s/it][A
 97%|█████████▋| 121/125 [09:02<00:18,  4.53s/it][A
 98%|█████████▊| 122/125 [09:07<00:13,  4.53s/it][A
 98%|█████████▊| 123/125 [09:11<00:09,  4.55s/it][A
 99%|█████████▉| 124/125 [09:16<00:04,  4.55s/it][A
100%|██████████| 125/125 [09:20<00:00,  4.54s/it][A                                                      
                                                 [A 51%|█████     | 250/492 [1:43:33<7:37:37, 113.46s/it]
100%|██████████| 125/125 [09:21<00:00,  4.54s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-250)... Done. 5.1s
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 51%|█████     | 251/492 [1:45:37<19:10:08, 286.34s/it] 51%|█████     | 252/492 [1:47:29<15:36:29, 234.12s/it] 51%|█████▏    | 253/492 [1:49:22<13:07:23, 197.67s/it] 52%|█████▏    | 254/492 [1:51:14<11:22:56, 172.17s/it] 52%|█████▏    | 255/492 [1:53:06<10:08:58, 154.17s/it]                                                        52%|█████▏    | 255/492 [1:53:06<10:08:58, 154.17s/it] 52%|█████▏    | 256/492 [1:54:59<9:17:35, 141.76s/it]  52%|█████▏    | 257/492 [1:56:51<8:40:33, 132.91s/it] 52%|█████▏    | 258/492 [1:58:44<8:14:33, 126.81s/it] 53%|█████▎    | 259/492 [2:00:37<7:55:43, 122.50s/it] 53%|█████▎    | 260/492 [2:02:29<7:42:20, 119.57s/it]                                                       53%|█████▎    | 260/492 [2:02:29<7:42:20, 119.57s/it] 53%|█████▎    | 261/492 [2:04:22<7:32:30, 117.54s/it] 53%|█████▎    | 262/492 [2:06:15<7:25:29, 116.21s/it] 53%|█████▎    | 263/492 [2:08:07<7:19:00, 115.02s/it] 54%|█████▎    | 264/492 [2:10:00<7:14:24, 114.32s/it] 54%|█████▍    | 265/492 [2:11:52<7:10:10, 113.70s/it]                                                       54%|█████▍    | 265/492 [2:11:52<7:10:10, 113.70s/it] 54%|█████▍    | 266/492 [2:13:45<7:07:26, 113.48s/it] 54%|█████▍    | 267/492 [2:15:38<7:04:43, 113.26s/it] 54%|█████▍    | 268/492 [2:17:31<7:01:57, 113.02s/it] 55%|█████▍    | 269/492 [2:19:23<6:59:41, 112.92s/it] 55%|█████▍    | 270/492 [2:21:16<6:57:49, 112.92s/it]                                                       55%|█████▍    | 270/492 [2:21:16<6:57:49, 112.92s/it] 55%|█████▌    | 271/492 [2:23:09<6:56:01, 112.95s/it] 55%|█████▌    | 272/492 [2:25:02<6:53:38, 112.81s/it] 55%|█████▌    | 273/492 [2:26:55<6:52:01, 112.89s/it] 56%|█████▌    | 274/492 [2:28:47<6:49:23, 112.68s/it] 56%|█████▌    | 275/492 [2:30:39<6:47:24, 112.65s/it]                                                       56%|█████▌    | 275/492 [2:30:39<6:47:24, 112.65s/it] 56%|█████▌    | 276/492 [2:32:32<6:45:26, 112.62s/it] 56%|█████▋    | 277/492 [2:34:24<6:43:18, 112.55s/it] 57%|█████▋    | 278/492 [2:36:17<6:41:21, 112.53s/it] 57%|█████▋    | 279/492 [2:38:09<6:39:24, 112.51s/it] 57%|█████▋    | 280/492 [2:40:02<6:37:34, 112.52s/it]                                                       57%|█████▋    | 280/492 [2:40:02<6:37:34, 112.52s/it] 57%|█████▋    | 281/492 [2:41:54<6:35:18, 112.41s/it] 57%|█████▋    | 282/492 [2:43:47<6:34:02, 112.58s/it] 58%|█████▊    | 283/492 [2:45:39<6:31:43, 112.46s/it] 58%|█████▊    | 284/492 [2:47:31<6:29:35, 112.38s/it] 58%|█████▊    | 285/492 [2:49:24<6:28:12, 112.52s/it]                                                       58%|█████▊    | 285/492 [2:49:24<6:28:12, 112.52s/it] 58%|█████▊    | 286/492 [2:51:17<6:26:06, 112.46s/it] 58%|█████▊    | 287/492 [2:53:09<6:24:11, 112.45s/it] 59%|█████▊    | 288/492 [2:55:02<6:22:42, 112.56s/it] 59%|█████▊    | 289/492 [2:56:54<6:20:25, 112.44s/it] 59%|█████▉    | 290/492 [2:58:47<6:18:51, 112.53s/it]                                                       59%|█████▉    | 290/492 [2:58:47<6:18:51, 112.53s/it] 59%|█████▉    | 291/492 [3:00:39<6:17:04, 112.56s/it] 59%|█████▉    | 292/492 [3:02:32<6:15:08, 112.54s/it] 60%|█████▉    | 293/492 [3:04:24<6:13:00, 112.47s/it] 60%|█████▉    | 294/492 [3:06:17<6:11:03, 112.44s/it] 60%|█████▉    | 295/492 [3:08:09<6:09:06, 112.42s/it]                                                       60%|█████▉    | 295/492 [3:08:09<6:09:06, 112.42s/it] 60%|██████    | 296/492 [3:10:02<6:07:33, 112.52s/it] 60%|██████    | 297/492 [3:11:54<6:05:25, 112.44s/it] 61%|██████    | 298/492 [3:13:46<6:03:34, 112.44s/it] 61%|██████    | 299/492 [3:15:39<6:01:55, 112.51s/it] 61%|██████    | 300/492 [3:17:31<6:00:00, 112.50s/it]                                                       61%|██████    | 300/492 [3:17:31<6:00:00, 112.50s/it]{'eval_loss': 0.1270112842321396, 'eval_runtime': 566.0408, 'eval_samples_per_second': 1.767, 'eval_steps_per_second': 0.221, 'epoch': 2.03}
{'loss': 0.1204, 'grad_norm': 0.07709399610757828, 'learning_rate': 5.567389211245485e-05, 'epoch': 2.07}
{'loss': 0.1165, 'grad_norm': 0.11390144377946854, 'learning_rate': 5.390524012629824e-05, 'epoch': 2.11}
{'loss': 0.1209, 'grad_norm': 0.09440046548843384, 'learning_rate': 5.2131656433338506e-05, 'epoch': 2.15}
{'loss': 0.1265, 'grad_norm': 0.2260516881942749, 'learning_rate': 5.035538079207488e-05, 'epoch': 2.19}
{'loss': 0.1231, 'grad_norm': 0.08039233833551407, 'learning_rate': 4.857865636051585e-05, 'epoch': 2.23}
{'loss': 0.1135, 'grad_norm': 0.13909466564655304, 'learning_rate': 4.6803726863421725e-05, 'epoch': 2.28}
{'loss': 0.103, 'grad_norm': 0.12441807985305786, 'learning_rate': 4.503283375883165e-05, 'epoch': 2.32}
{'loss': 0.1136, 'grad_norm': 0.09395081549882889, 'learning_rate': 4.326821340745304e-05, 'epoch': 2.36}
{'loss': 0.1133, 'grad_norm': 0.09730109572410583, 'learning_rate': 4.151209424848819e-05, 'epoch': 2.4}
{'loss': 0.1177, 'grad_norm': 0.09149850159883499, 'learning_rate': 3.976669398546451e-05, 'epoch': 2.44}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:38,  2.27s/it][A
  2%|▏         | 3/125 [00:09<06:32,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.71s/it][A
  4%|▍         | 5/125 [00:18<08:01,  4.01s/it][A
  5%|▍         | 6/125 [00:22<08:18,  4.19s/it][A
  6%|▌         | 7/125 [00:27<08:27,  4.30s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:31,  4.41s/it][A
  8%|▊         | 10/125 [00:40<08:32,  4.46s/it][A
  9%|▉         | 11/125 [00:45<08:31,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:28,  4.50s/it][A
 10%|█         | 13/125 [00:54<08:23,  4.50s/it][A
 11%|█         | 14/125 [00:58<08:20,  4.51s/it][A
 12%|█▏        | 15/125 [01:03<08:15,  4.51s/it][A
 13%|█▎        | 16/125 [01:08<08:12,  4.52s/it][A
 14%|█▎        | 17/125 [01:12<08:09,  4.53s/it][A
 14%|█▍        | 18/125 [01:17<08:05,  4.53s/it][A
 15%|█▌        | 19/125 [01:21<07:59,  4.52s/it][A
 16%|█▌        | 20/125 [01:26<07:55,  4.53s/it][A
 17%|█▋        | 21/125 [01:30<07:50,  4.52s/it][A
 18%|█▊        | 22/125 [01:35<07:44,  4.51s/it][A
 18%|█▊        | 23/125 [01:39<07:39,  4.51s/it][A
 19%|█▉        | 24/125 [01:44<07:37,  4.53s/it][A
 20%|██        | 25/125 [01:48<07:35,  4.56s/it][A
 21%|██        | 26/125 [01:53<07:32,  4.57s/it][A
 22%|██▏       | 27/125 [01:57<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:02<07:19,  4.53s/it][A
 23%|██▎       | 29/125 [02:06<07:15,  4.53s/it][A
 24%|██▍       | 30/125 [02:11<07:09,  4.52s/it][A
 25%|██▍       | 31/125 [02:16<07:05,  4.53s/it][A
 26%|██▌       | 32/125 [02:20<07:00,  4.52s/it][A
 26%|██▋       | 33/125 [02:25<06:56,  4.52s/it][A
 27%|██▋       | 34/125 [02:29<06:50,  4.51s/it][A
 28%|██▊       | 35/125 [02:34<06:46,  4.52s/it][A
 29%|██▉       | 36/125 [02:38<06:42,  4.52s/it][A
 30%|██▉       | 37/125 [02:43<06:37,  4.51s/it][A
 30%|███       | 38/125 [02:47<06:32,  4.52s/it][A
 31%|███       | 39/125 [02:52<06:29,  4.52s/it][A
 32%|███▏      | 40/125 [02:56<06:24,  4.53s/it][A
 33%|███▎      | 41/125 [03:01<06:21,  4.55s/it][A
 34%|███▎      | 42/125 [03:05<06:16,  4.54s/it][A
 34%|███▍      | 43/125 [03:10<06:11,  4.53s/it][A
 35%|███▌      | 44/125 [03:14<06:07,  4.54s/it][A
 36%|███▌      | 45/125 [03:19<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:23<05:58,  4.54s/it][A
 38%|███▊      | 47/125 [03:28<05:52,  4.52s/it][A
 38%|███▊      | 48/125 [03:33<05:48,  4.53s/it][A
 39%|███▉      | 49/125 [03:37<05:44,  4.53s/it][A
 40%|████      | 50/125 [03:42<05:39,  4.53s/it][A
 41%|████      | 51/125 [03:46<05:35,  4.53s/it][A
 42%|████▏     | 52/125 [03:51<05:30,  4.53s/it][A
 42%|████▏     | 53/125 [03:55<05:26,  4.53s/it][A
 43%|████▎     | 54/125 [04:00<05:21,  4.53s/it][A
 44%|████▍     | 55/125 [04:04<05:17,  4.54s/it][A
 45%|████▍     | 56/125 [04:09<05:13,  4.54s/it][A
 46%|████▌     | 57/125 [04:13<05:08,  4.53s/it][A
 46%|████▋     | 58/125 [04:18<05:04,  4.55s/it][A
 47%|████▋     | 59/125 [04:22<04:58,  4.53s/it][A
 48%|████▊     | 60/125 [04:27<04:54,  4.53s/it][A
 49%|████▉     | 61/125 [04:31<04:49,  4.52s/it][A
 50%|████▉     | 62/125 [04:36<04:44,  4.52s/it][A
 50%|█████     | 63/125 [04:41<04:41,  4.54s/it][A
 51%|█████     | 64/125 [04:45<04:37,  4.54s/it][A
 52%|█████▏    | 65/125 [04:50<04:31,  4.52s/it][A
 53%|█████▎    | 66/125 [04:54<04:28,  4.54s/it][A
 54%|█████▎    | 67/125 [04:59<04:22,  4.52s/it][A
 54%|█████▍    | 68/125 [05:03<04:18,  4.53s/it][A
 55%|█████▌    | 69/125 [05:08<04:13,  4.52s/it][A
 56%|█████▌    | 70/125 [05:12<04:09,  4.53s/it][A
 57%|█████▋    | 71/125 [05:17<04:04,  4.53s/it][A
 58%|█████▊    | 72/125 [05:21<04:00,  4.54s/it][A
 58%|█████▊    | 73/125 [05:26<03:56,  4.55s/it][A
 59%|█████▉    | 74/125 [05:31<03:53,  4.59s/it][A
 60%|██████    | 75/125 [05:35<03:48,  4.57s/it][A
 61%|██████    | 76/125 [05:40<03:43,  4.56s/it][A
 62%|██████▏   | 77/125 [05:44<03:38,  4.55s/it][A
 62%|██████▏   | 78/125 [05:49<03:33,  4.54s/it][A
 63%|██████▎   | 79/125 [05:53<03:28,  4.53s/it][A
 64%|██████▍   | 80/125 [05:58<03:24,  4.53s/it][A
 65%|██████▍   | 81/125 [06:02<03:19,  4.54s/it][A
 66%|██████▌   | 82/125 [06:07<03:14,  4.53s/it][A
 66%|██████▋   | 83/125 [06:11<03:10,  4.53s/it][A
 67%|██████▋   | 84/125 [06:16<03:05,  4.53s/it][A
 68%|██████▊   | 85/125 [06:20<03:01,  4.53s/it][A
 69%|██████▉   | 86/125 [06:25<02:56,  4.53s/it][A
 70%|██████▉   | 87/125 [06:29<02:52,  4.54s/it][A
 70%|███████   | 88/125 [06:34<02:47,  4.54s/it][A
 71%|███████   | 89/125 [06:38<02:43,  4.53s/it][A
 72%|███████▏  | 90/125 [06:43<02:38,  4.52s/it][A
 73%|███████▎  | 91/125 [06:47<02:33,  4.51s/it][A
 74%|███████▎  | 92/125 [06:52<02:28,  4.50s/it][A
 74%|███████▍  | 93/125 [06:57<02:24,  4.53s/it][A
 75%|███████▌  | 94/125 [07:01<02:20,  4.52s/it][A
 76%|███████▌  | 95/125 [07:06<02:15,  4.53s/it][A
 77%|███████▋  | 96/125 [07:10<02:11,  4.52s/it][A
 78%|███████▊  | 97/125 [07:15<02:06,  4.53s/it][A
 78%|███████▊  | 98/125 [07:19<02:02,  4.52s/it][A
 79%|███████▉  | 99/125 [07:24<01:57,  4.52s/it][A
 80%|████████  | 100/125 [07:28<01:53,  4.52s/it][A
 81%|████████  | 101/125 [07:33<01:48,  4.52s/it][A
 82%|████████▏ | 102/125 [07:37<01:44,  4.54s/it][A
 82%|████████▏ | 103/125 [07:42<01:40,  4.55s/it][A
 83%|████████▎ | 104/125 [07:46<01:35,  4.55s/it][A
 84%|████████▍ | 105/125 [07:51<01:30,  4.54s/it][A
 85%|████████▍ | 106/125 [07:55<01:26,  4.53s/it][A
 86%|████████▌ | 107/125 [08:00<01:21,  4.52s/it][A
 86%|████████▋ | 108/125 [08:04<01:16,  4.52s/it][A
 87%|████████▋ | 109/125 [08:09<01:12,  4.53s/it][A
 88%|████████▊ | 110/125 [08:14<01:07,  4.53s/it][A
 89%|████████▉ | 111/125 [08:18<01:03,  4.54s/it][A
 90%|████████▉ | 112/125 [08:23<00:58,  4.53s/it][A
 90%|█████████ | 113/125 [08:27<00:54,  4.51s/it][A
 91%|█████████ | 114/125 [08:32<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:36<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:41<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:45<00:36,  4.55s/it][A
 94%|█████████▍| 118/125 [08:50<00:31,  4.54s/it][A
 95%|█████████▌| 119/125 [08:54<00:27,  4.54s/it][A
 96%|█████████▌| 120/125 [08:59<00:22,  4.53s/it][A
 97%|█████████▋| 121/125 [09:03<00:18,  4.54s/it][A
 98%|█████████▊| 122/125 [09:08<00:13,  4.54s/it][A
 98%|█████████▊| 123/125 [09:13<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:17<00:04,  4.56s/it][A
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A                                                      
                                                 [A 61%|██████    | 300/492 [3:26:58<6:00:00, 112.50s/it]
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-300)... Done. 5.0s
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 61%|██████    | 301/492 [3:29:02<15:09:52, 285.83s/it] 61%|██████▏   | 302/492 [3:30:54<12:20:07, 233.73s/it] 62%|██████▏   | 303/492 [3:32:46<10:21:31, 197.31s/it] 62%|██████▏   | 304/492 [3:34:39<8:59:09, 172.07s/it]  62%|██████▏   | 305/492 [3:36:32<8:00:41, 154.23s/it]                                                       62%|██████▏   | 305/492 [3:36:32<8:00:41, 154.23s/it] 62%|██████▏   | 306/492 [3:38:25<7:19:28, 141.77s/it] 62%|██████▏   | 307/492 [3:40:17<6:49:59, 132.97s/it] 63%|██████▎   | 308/492 [3:42:09<6:28:29, 126.68s/it] 63%|██████▎   | 309/492 [3:44:02<6:13:29, 122.46s/it] 63%|██████▎   | 310/492 [3:45:54<6:02:17, 119.44s/it]                                                       63%|██████▎   | 310/492 [3:45:54<6:02:17, 119.44s/it] 63%|██████▎   | 311/492 [3:47:47<5:53:59, 117.35s/it] 63%|██████▎   | 312/492 [3:49:39<5:47:55, 115.97s/it] 64%|██████▎   | 313/492 [3:51:32<5:43:00, 114.97s/it] 64%|██████▍   | 314/492 [3:53:25<5:38:55, 114.25s/it] 64%|██████▍   | 315/492 [3:55:17<5:35:44, 113.81s/it]                                                       64%|██████▍   | 315/492 [3:55:17<5:35:44, 113.81s/it] 64%|██████▍   | 316/492 [3:57:10<5:32:22, 113.31s/it] 64%|██████▍   | 317/492 [3:59:02<5:29:41, 113.03s/it] 65%|██████▍   | 318/492 [4:00:54<5:27:20, 112.88s/it] 65%|██████▍   | 319/492 [4:02:47<5:25:16, 112.81s/it] 65%|██████▌   | 320/492 [4:04:40<5:23:29, 112.84s/it]                                                       65%|██████▌   | 320/492 [4:04:40<5:23:29, 112.84s/it] 65%|██████▌   | 321/492 [4:06:32<5:21:15, 112.72s/it] 65%|██████▌   | 322/492 [4:08:25<5:19:00, 112.59s/it] 66%|██████▌   | 323/492 [4:10:17<5:16:57, 112.53s/it] 66%|██████▌   | 324/492 [4:12:10<5:15:37, 112.73s/it] 66%|██████▌   | 325/492 [4:14:03<5:13:30, 112.64s/it]                                                       66%|██████▌   | 325/492 [4:14:03<5:13:30, 112.64s/it] 66%|██████▋   | 326/492 [4:15:55<5:11:26, 112.57s/it] 66%|██████▋   | 327/492 [4:17:49<5:10:17, 112.83s/it] 67%|██████▋   | 328/492 [4:19:41<5:07:56, 112.66s/it] 67%|██████▋   | 329/492 [4:21:33<5:05:48, 112.57s/it] 67%|██████▋   | 330/492 [4:23:25<5:03:31, 112.41s/it]                                                       67%|██████▋   | 330/492 [4:23:25<5:03:31, 112.41s/it] 67%|██████▋   | 331/492 [4:25:18<5:01:33, 112.38s/it] 67%|██████▋   | 332/492 [4:27:10<4:59:54, 112.47s/it] 68%|██████▊   | 333/492 [4:29:03<4:58:04, 112.48s/it] 68%|██████▊   | 334/492 [4:30:55<4:56:22, 112.55s/it] 68%|██████▊   | 335/492 [4:32:48<4:54:40, 112.62s/it]                                                       68%|██████▊   | 335/492 [4:32:48<4:54:40, 112.62s/it] 68%|██████▊   | 336/492 [4:34:41<4:52:34, 112.53s/it] 68%|██████▊   | 337/492 [4:36:33<4:50:45, 112.55s/it] 69%|██████▊   | 338/492 [4:38:25<4:48:31, 112.41s/it] 69%|██████▉   | 339/492 [4:40:18<4:46:56, 112.53s/it] 69%|██████▉   | 340/492 [4:42:11<4:45:41, 112.77s/it]                                                       69%|██████▉   | 340/492 [4:42:11<4:45:41, 112.77s/it] 69%|██████▉   | 341/492 [4:44:04<4:43:24, 112.61s/it] 70%|██████▉   | 342/492 [4:45:56<4:41:18, 112.53s/it] 70%|██████▉   | 343/492 [4:47:49<4:39:32, 112.57s/it] 70%|██████▉   | 344/492 [4:49:41<4:37:42, 112.58s/it] 70%|███████   | 345/492 [4:51:34<4:35:56, 112.63s/it]                                                       70%|███████   | 345/492 [4:51:34<4:35:56, 112.63s/it] 70%|███████   | 346/492 [4:53:26<4:33:45, 112.50s/it] 71%|███████   | 347/492 [4:55:19<4:31:48, 112.48s/it] 71%|███████   | 348/492 [4:57:11<4:30:01, 112.51s/it] 71%|███████   | 349/492 [4:59:04<4:28:02, 112.47s/it] 71%|███████   | 350/492 [5:00:56<4:26:06, 112.44s/it]                                                       71%|███████   | 350/492 [5:00:56<4:26:06, 112.44s/it]{'eval_loss': 0.12281998991966248, 'eval_runtime': 566.7313, 'eval_samples_per_second': 1.765, 'eval_steps_per_second': 0.221, 'epoch': 2.44}
{'loss': 0.117, 'grad_norm': 0.09771734476089478, 'learning_rate': 3.803421678562213e-05, 'epoch': 2.48}
{'loss': 0.1121, 'grad_norm': 0.11150355637073517, 'learning_rate': 3.631685049639586e-05, 'epoch': 2.52}
{'loss': 0.1123, 'grad_norm': 0.09728321433067322, 'learning_rate': 3.461676388250651e-05, 'epoch': 2.56}
{'loss': 0.1091, 'grad_norm': 0.1387196183204651, 'learning_rate': 3.293610388715048e-05, 'epoch': 2.6}
{'loss': 0.1123, 'grad_norm': 0.08297745138406754, 'learning_rate': 3.127699292074683e-05, 'epoch': 2.64}
{'loss': 0.117, 'grad_norm': 0.07975372672080994, 'learning_rate': 2.964152618066508e-05, 'epoch': 2.68}
{'loss': 0.1167, 'grad_norm': 0.09079435467720032, 'learning_rate': 2.8031769005319147e-05, 'epoch': 2.72}
{'loss': 0.1149, 'grad_norm': 0.11697285622358322, 'learning_rate': 2.6449754265968264e-05, 'epoch': 2.76}
{'loss': 0.1078, 'grad_norm': 0.14380836486816406, 'learning_rate': 2.4897479799518796e-05, 'epoch': 2.8}
{'loss': 0.1041, 'grad_norm': 0.08891697227954865, 'learning_rate': 2.3376905885569182e-05, 'epoch': 2.84}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:39,  2.27s/it][A
  2%|▏         | 3/125 [00:09<06:32,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.71s/it][A
  4%|▍         | 5/125 [00:18<08:01,  4.01s/it][A
  5%|▍         | 6/125 [00:22<08:17,  4.18s/it][A
  6%|▌         | 7/125 [00:27<08:28,  4.31s/it][A
  6%|▋         | 8/125 [00:31<08:32,  4.38s/it][A
  7%|▋         | 9/125 [00:36<08:31,  4.41s/it][A
  8%|▊         | 10/125 [00:40<08:32,  4.46s/it][A
  9%|▉         | 11/125 [00:45<08:31,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:28,  4.50s/it][A
 10%|█         | 13/125 [00:54<08:23,  4.50s/it][A
 11%|█         | 14/125 [00:58<08:20,  4.51s/it][A
 12%|█▏        | 15/125 [01:03<08:15,  4.51s/it][A
 13%|█▎        | 16/125 [01:08<08:12,  4.52s/it][A
 14%|█▎        | 17/125 [01:12<08:08,  4.53s/it][A
 14%|█▍        | 18/125 [01:17<08:04,  4.53s/it][A
 15%|█▌        | 19/125 [01:21<07:59,  4.52s/it][A
 16%|█▌        | 20/125 [01:26<07:55,  4.53s/it][A
 17%|█▋        | 21/125 [01:30<07:50,  4.52s/it][A
 18%|█▊        | 22/125 [01:35<07:44,  4.51s/it][A
 18%|█▊        | 23/125 [01:39<07:39,  4.51s/it][A
 19%|█▉        | 24/125 [01:44<07:37,  4.53s/it][A
 20%|██        | 25/125 [01:48<07:35,  4.55s/it][A
 21%|██        | 26/125 [01:53<07:32,  4.57s/it][A
 22%|██▏       | 27/125 [01:57<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:02<07:19,  4.53s/it][A
 23%|██▎       | 29/125 [02:06<07:15,  4.53s/it][A
 24%|██▍       | 30/125 [02:11<07:09,  4.52s/it][A
 25%|██▍       | 31/125 [02:16<07:05,  4.53s/it][A
 26%|██▌       | 32/125 [02:20<07:00,  4.52s/it][A
 26%|██▋       | 33/125 [02:25<06:56,  4.52s/it][A
 27%|██▋       | 34/125 [02:29<06:50,  4.51s/it][A
 28%|██▊       | 35/125 [02:34<06:46,  4.52s/it][A
 29%|██▉       | 36/125 [02:38<06:42,  4.52s/it][A
 30%|██▉       | 37/125 [02:43<06:37,  4.51s/it][A
 30%|███       | 38/125 [02:47<06:32,  4.52s/it][A
 31%|███       | 39/125 [02:52<06:29,  4.52s/it][A
 32%|███▏      | 40/125 [02:56<06:24,  4.52s/it][A
 33%|███▎      | 41/125 [03:01<06:22,  4.55s/it][A
 34%|███▎      | 42/125 [03:05<06:16,  4.54s/it][A
 34%|███▍      | 43/125 [03:10<06:11,  4.53s/it][A
 35%|███▌      | 44/125 [03:14<06:07,  4.53s/it][A
 36%|███▌      | 45/125 [03:19<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:23<05:58,  4.54s/it][A
 38%|███▊      | 47/125 [03:28<05:52,  4.52s/it][A
 38%|███▊      | 48/125 [03:32<05:48,  4.53s/it][A
 39%|███▉      | 49/125 [03:37<05:44,  4.53s/it][A
 40%|████      | 50/125 [03:42<05:39,  4.53s/it][A
 41%|████      | 51/125 [03:46<05:35,  4.53s/it][A
 42%|████▏     | 52/125 [03:51<05:30,  4.53s/it][A
 42%|████▏     | 53/125 [03:55<05:26,  4.53s/it][A
 43%|████▎     | 54/125 [04:00<05:21,  4.53s/it][A
 44%|████▍     | 55/125 [04:04<05:17,  4.54s/it][A
 45%|████▍     | 56/125 [04:09<05:13,  4.54s/it][A
 46%|████▌     | 57/125 [04:13<05:08,  4.53s/it][A
 46%|████▋     | 58/125 [04:18<05:04,  4.55s/it][A
 47%|████▋     | 59/125 [04:22<04:58,  4.53s/it][A
 48%|████▊     | 60/125 [04:27<04:54,  4.53s/it][A
 49%|████▉     | 61/125 [04:31<04:49,  4.52s/it][A
 50%|████▉     | 62/125 [04:36<04:44,  4.52s/it][A
 50%|█████     | 63/125 [04:40<04:41,  4.54s/it][A
 51%|█████     | 64/125 [04:45<04:36,  4.54s/it][A
 52%|█████▏    | 65/125 [04:50<04:31,  4.52s/it][A
 53%|█████▎    | 66/125 [04:54<04:28,  4.54s/it][A
 54%|█████▎    | 67/125 [04:59<04:22,  4.53s/it][A
 54%|█████▍    | 68/125 [05:03<04:18,  4.53s/it][A
 55%|█████▌    | 69/125 [05:08<04:13,  4.52s/it][A
 56%|█████▌    | 70/125 [05:12<04:09,  4.53s/it][A
 57%|█████▋    | 71/125 [05:17<04:04,  4.53s/it][A
 58%|█████▊    | 72/125 [05:21<04:00,  4.54s/it][A
 58%|█████▊    | 73/125 [05:26<03:56,  4.55s/it][A
 59%|█████▉    | 74/125 [05:31<03:53,  4.58s/it][A
 60%|██████    | 75/125 [05:35<03:48,  4.57s/it][A
 61%|██████    | 76/125 [05:40<03:43,  4.56s/it][A
 62%|██████▏   | 77/125 [05:44<03:38,  4.55s/it][A
 62%|██████▏   | 78/125 [05:49<03:33,  4.54s/it][A
 63%|██████▎   | 79/125 [05:53<03:28,  4.52s/it][A
 64%|██████▍   | 80/125 [05:58<03:23,  4.53s/it][A
 65%|██████▍   | 81/125 [06:02<03:19,  4.54s/it][A
 66%|██████▌   | 82/125 [06:07<03:14,  4.53s/it][A
 66%|██████▋   | 83/125 [06:11<03:10,  4.52s/it][A
 67%|██████▋   | 84/125 [06:16<03:05,  4.52s/it][A
 68%|██████▊   | 85/125 [06:20<03:01,  4.53s/it][A
 69%|██████▉   | 86/125 [06:25<02:56,  4.53s/it][A
 70%|██████▉   | 87/125 [06:29<02:52,  4.54s/it][A
 70%|███████   | 88/125 [06:34<02:47,  4.53s/it][A
 71%|███████   | 89/125 [06:38<02:43,  4.53s/it][A
 72%|███████▏  | 90/125 [06:43<02:38,  4.52s/it][A
 73%|███████▎  | 91/125 [06:47<02:33,  4.51s/it][A
 74%|███████▎  | 92/125 [06:52<02:28,  4.50s/it][A
 74%|███████▍  | 93/125 [06:57<02:24,  4.53s/it][A
 75%|███████▌  | 94/125 [07:01<02:20,  4.52s/it][A
 76%|███████▌  | 95/125 [07:06<02:15,  4.53s/it][A
 77%|███████▋  | 96/125 [07:10<02:11,  4.52s/it][A
 78%|███████▊  | 97/125 [07:15<02:06,  4.53s/it][A
 78%|███████▊  | 98/125 [07:19<02:02,  4.52s/it][A
 79%|███████▉  | 99/125 [07:24<01:57,  4.52s/it][A
 80%|████████  | 100/125 [07:28<01:53,  4.52s/it][A
 81%|████████  | 101/125 [07:33<01:48,  4.52s/it][A
 82%|████████▏ | 102/125 [07:37<01:44,  4.54s/it][A
 82%|████████▏ | 103/125 [07:42<01:40,  4.55s/it][A
 83%|████████▎ | 104/125 [07:46<01:35,  4.55s/it][A
 84%|████████▍ | 105/125 [07:51<01:30,  4.54s/it][A
 85%|████████▍ | 106/125 [07:55<01:26,  4.53s/it][A
 86%|████████▌ | 107/125 [08:00<01:21,  4.52s/it][A
 86%|████████▋ | 108/125 [08:04<01:16,  4.52s/it][A
 87%|████████▋ | 109/125 [08:09<01:12,  4.53s/it][A
 88%|████████▊ | 110/125 [08:13<01:07,  4.52s/it][A
 89%|████████▉ | 111/125 [08:18<01:03,  4.53s/it][A
 90%|████████▉ | 112/125 [08:23<00:58,  4.53s/it][A
 90%|█████████ | 113/125 [08:27<00:54,  4.51s/it][A
 91%|█████████ | 114/125 [08:32<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:36<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:41<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:45<00:36,  4.55s/it][A
 94%|█████████▍| 118/125 [08:50<00:31,  4.54s/it][A
 95%|█████████▌| 119/125 [08:54<00:27,  4.54s/it][A
 96%|█████████▌| 120/125 [08:59<00:22,  4.53s/it][A
 97%|█████████▋| 121/125 [09:03<00:18,  4.53s/it][A
 98%|█████████▊| 122/125 [09:08<00:13,  4.54s/it][A
 98%|█████████▊| 123/125 [09:13<00:09,  4.55s/it][A
 99%|█████████▉| 124/125 [09:17<00:04,  4.55s/it][A
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A                                                      
                                                 [A 71%|███████   | 350/492 [5:10:23<4:26:06, 112.44s/it]
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-350)... Done. 5.1s
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 71%|███████▏  | 351/492 [5:12:26<11:11:46, 285.86s/it] 72%|███████▏  | 352/492 [5:14:19<9:05:46, 233.90s/it]  72%|███████▏  | 353/492 [5:16:12<7:37:46, 197.60s/it] 72%|███████▏  | 354/492 [5:18:04<6:35:43, 172.06s/it] 72%|███████▏  | 355/492 [5:19:57<5:52:20, 154.31s/it]                                                       72%|███████▏  | 355/492 [5:19:57<5:52:20, 154.31s/it] 72%|███████▏  | 356/492 [5:21:50<5:21:26, 141.81s/it] 73%|███████▎  | 357/492 [5:23:43<4:59:20, 133.04s/it] 73%|███████▎  | 358/492 [5:25:35<4:43:30, 126.94s/it] 73%|███████▎  | 359/492 [5:27:28<4:31:39, 122.55s/it] 73%|███████▎  | 360/492 [5:29:20<4:22:52, 119.49s/it]                                                       73%|███████▎  | 360/492 [5:29:20<4:22:52, 119.49s/it] 73%|███████▎  | 361/492 [5:31:12<4:16:14, 117.36s/it] 74%|███████▎  | 362/492 [5:33:05<4:11:00, 115.85s/it] 74%|███████▍  | 363/492 [5:34:57<4:06:48, 114.79s/it] 74%|███████▍  | 364/492 [5:36:49<4:03:25, 114.11s/it] 74%|███████▍  | 365/492 [5:38:42<4:00:33, 113.65s/it]                                                       74%|███████▍  | 365/492 [5:38:42<4:00:33, 113.65s/it] 74%|███████▍  | 366/492 [5:40:35<3:57:56, 113.30s/it] 75%|███████▍  | 367/492 [5:42:27<3:55:42, 113.14s/it] 75%|███████▍  | 368/492 [5:44:19<3:53:09, 112.82s/it] 75%|███████▌  | 369/492 [5:46:12<3:51:07, 112.74s/it] 75%|███████▌  | 370/492 [5:47:57<3:44:50, 110.58s/it]                                                       75%|███████▌  | 370/492 [5:47:57<3:44:50, 110.58s/it] 75%|███████▌  | 371/492 [5:49:50<3:43:53, 111.02s/it] 76%|███████▌  | 372/492 [5:51:42<3:42:57, 111.48s/it] 76%|███████▌  | 373/492 [5:53:35<3:41:52, 111.87s/it] 76%|███████▌  | 374/492 [5:55:27<3:40:26, 112.08s/it] 76%|███████▌  | 375/492 [5:57:20<3:38:50, 112.23s/it]                                                       76%|███████▌  | 375/492 [5:57:20<3:38:50, 112.23s/it] 76%|███████▋  | 376/492 [5:59:13<3:37:14, 112.37s/it] 77%|███████▋  | 377/492 [6:01:05<3:35:11, 112.27s/it] 77%|███████▋  | 378/492 [6:02:57<3:33:20, 112.28s/it] 77%|███████▋  | 379/492 [6:04:50<3:31:53, 112.51s/it] 77%|███████▋  | 380/492 [6:06:43<3:30:10, 112.59s/it]                                                       77%|███████▋  | 380/492 [6:06:43<3:30:10, 112.59s/it] 77%|███████▋  | 381/492 [6:08:35<3:28:15, 112.57s/it] 78%|███████▊  | 382/492 [6:10:28<3:26:18, 112.53s/it] 78%|███████▊  | 383/492 [6:12:20<3:24:10, 112.39s/it] 78%|███████▊  | 384/492 [6:14:12<3:22:21, 112.42s/it] 78%|███████▊  | 385/492 [6:16:05<3:20:25, 112.39s/it]                                                       78%|███████▊  | 385/492 [6:16:05<3:20:25, 112.39s/it] 78%|███████▊  | 386/492 [6:17:57<3:18:34, 112.40s/it] 79%|███████▊  | 387/492 [6:19:50<3:16:51, 112.49s/it] 79%|███████▉  | 388/492 [6:21:42<3:15:02, 112.53s/it] 79%|███████▉  | 389/492 [6:23:35<3:12:59, 112.42s/it] 79%|███████▉  | 390/492 [6:25:28<3:11:25, 112.60s/it]                                                       79%|███████▉  | 390/492 [6:25:28<3:11:25, 112.60s/it] 79%|███████▉  | 391/492 [6:27:20<3:09:30, 112.58s/it] 80%|███████▉  | 392/492 [6:29:13<3:07:45, 112.66s/it] 80%|███████▉  | 393/492 [6:31:05<3:05:43, 112.56s/it] 80%|████████  | 394/492 [6:32:58<3:03:47, 112.52s/it] 80%|████████  | 395/492 [6:34:51<3:02:06, 112.65s/it]                                                       80%|████████  | 395/492 [6:34:51<3:02:06, 112.65s/it] 80%|████████  | 396/492 [6:36:43<3:00:08, 112.59s/it] 81%|████████  | 397/492 [6:38:36<2:58:17, 112.61s/it] 81%|████████  | 398/492 [6:40:28<2:56:11, 112.47s/it] 81%|████████  | 399/492 [6:42:21<2:54:35, 112.64s/it] 81%|████████▏ | 400/492 [6:44:13<2:52:35, 112.56s/it]                                                       81%|████████▏ | 400/492 [6:44:13<2:52:35, 112.56s/it]{'eval_loss': 0.11983277648687363, 'eval_runtime': 566.6646, 'eval_samples_per_second': 1.765, 'eval_steps_per_second': 0.221, 'epoch': 2.84}
{'loss': 0.1212, 'grad_norm': 0.09689132869243622, 'learning_rate': 2.1889952770883643e-05, 'epoch': 2.88}
{'loss': 0.105, 'grad_norm': 0.08049995452165604, 'learning_rate': 2.043849824442124e-05, 'epoch': 2.92}
{'loss': 0.11, 'grad_norm': 0.0926508679986, 'learning_rate': 1.9024375265982384e-05, 'epoch': 2.97}
{'loss': 0.1067, 'grad_norm': 0.09762662649154663, 'learning_rate': 1.764936965146773e-05, 'epoch': 3.01}
{'loss': 0.0963, 'grad_norm': 0.11719583719968796, 'learning_rate': 1.631521781767214e-05, 'epoch': 3.05}
{'loss': 0.1081, 'grad_norm': 0.09774573147296906, 'learning_rate': 1.502360458946232e-05, 'epoch': 3.09}
{'loss': 0.107, 'grad_norm': 0.10405320674180984, 'learning_rate': 1.3776161072106702e-05, 'epoch': 3.13}
{'loss': 0.1101, 'grad_norm': 0.10721355676651001, 'learning_rate': 1.257446259144494e-05, 'epoch': 3.17}
{'loss': 0.1096, 'grad_norm': 0.12284258753061295, 'learning_rate': 1.1420026704498077e-05, 'epoch': 3.21}
{'loss': 0.1059, 'grad_norm': 0.09421534836292267, 'learning_rate': 1.031431128303153e-05, 'epoch': 3.25}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:38,  2.27s/it][A
  2%|▏         | 3/125 [00:09<06:32,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.71s/it][A
  4%|▍         | 5/125 [00:18<08:01,  4.01s/it][A
  5%|▍         | 6/125 [00:22<08:18,  4.19s/it][A
  6%|▌         | 7/125 [00:27<08:27,  4.30s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.38s/it][A
  7%|▋         | 9/125 [00:36<08:31,  4.41s/it][A
  8%|▊         | 10/125 [00:40<08:32,  4.46s/it][A
  9%|▉         | 11/125 [00:45<08:31,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:28,  4.50s/it][A
 10%|█         | 13/125 [00:54<08:23,  4.50s/it][A
 11%|█         | 14/125 [00:58<08:20,  4.51s/it][A
 12%|█▏        | 15/125 [01:03<08:15,  4.51s/it][A
 13%|█▎        | 16/125 [01:08<08:12,  4.52s/it][A
 14%|█▎        | 17/125 [01:12<08:09,  4.53s/it][A
 14%|█▍        | 18/125 [01:17<08:05,  4.53s/it][A
 15%|█▌        | 19/125 [01:21<07:59,  4.52s/it][A
 16%|█▌        | 20/125 [01:26<07:55,  4.53s/it][A
 17%|█▋        | 21/125 [01:30<07:50,  4.52s/it][A
 18%|█▊        | 22/125 [01:35<07:45,  4.51s/it][A
 18%|█▊        | 23/125 [01:39<07:39,  4.51s/it][A
 19%|█▉        | 24/125 [01:44<07:37,  4.53s/it][A
 20%|██        | 25/125 [01:48<07:35,  4.56s/it][A
 21%|██        | 26/125 [01:53<07:32,  4.57s/it][A
 22%|██▏       | 27/125 [01:57<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:02<07:19,  4.53s/it][A
 23%|██▎       | 29/125 [02:07<07:15,  4.54s/it][A
 24%|██▍       | 30/125 [02:11<07:09,  4.52s/it][A
 25%|██▍       | 31/125 [02:16<07:05,  4.53s/it][A
 26%|██▌       | 32/125 [02:20<07:00,  4.52s/it][A
 26%|██▋       | 33/125 [02:25<06:55,  4.52s/it][A
 27%|██▋       | 34/125 [02:29<06:50,  4.51s/it][A
 28%|██▊       | 35/125 [02:34<06:46,  4.51s/it][A
 29%|██▉       | 36/125 [02:38<06:42,  4.52s/it][A
 30%|██▉       | 37/125 [02:43<06:37,  4.51s/it][A
 30%|███       | 38/125 [02:47<06:32,  4.51s/it][A
 31%|███       | 39/125 [02:52<06:28,  4.52s/it][A
 32%|███▏      | 40/125 [02:56<06:24,  4.52s/it][A
 33%|███▎      | 41/125 [03:01<06:21,  4.55s/it][A
 34%|███▎      | 42/125 [03:05<06:16,  4.54s/it][A
 34%|███▍      | 43/125 [03:10<06:11,  4.53s/it][A
 35%|███▌      | 44/125 [03:14<06:07,  4.54s/it][A
 36%|███▌      | 45/125 [03:19<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:23<05:58,  4.54s/it][A
 38%|███▊      | 47/125 [03:28<05:52,  4.52s/it][A
 38%|███▊      | 48/125 [03:33<05:48,  4.53s/it][A
 39%|███▉      | 49/125 [03:37<05:44,  4.53s/it][A
 40%|████      | 50/125 [03:42<05:39,  4.53s/it][A
 41%|████      | 51/125 [03:46<05:35,  4.53s/it][A
 42%|████▏     | 52/125 [03:51<05:30,  4.53s/it][A
 42%|████▏     | 53/125 [03:55<05:26,  4.53s/it][A
 43%|████▎     | 54/125 [04:00<05:22,  4.54s/it][A
 44%|████▍     | 55/125 [04:04<05:17,  4.54s/it][A
 45%|████▍     | 56/125 [04:09<05:13,  4.54s/it][A
 46%|████▌     | 57/125 [04:13<05:08,  4.53s/it][A
 46%|████▋     | 58/125 [04:18<05:04,  4.55s/it][A
 47%|████▋     | 59/125 [04:22<04:58,  4.53s/it][A
 48%|████▊     | 60/125 [04:27<04:54,  4.53s/it][A
 49%|████▉     | 61/125 [04:31<04:49,  4.52s/it][A
 50%|████▉     | 62/125 [04:36<04:44,  4.52s/it][A
 50%|█████     | 63/125 [04:41<04:41,  4.54s/it][A
 51%|█████     | 64/125 [04:45<04:36,  4.54s/it][A
 52%|█████▏    | 65/125 [04:50<04:31,  4.52s/it][A
 53%|█████▎    | 66/125 [04:54<04:27,  4.54s/it][A
 54%|█████▎    | 67/125 [04:59<04:22,  4.52s/it][A
 54%|█████▍    | 68/125 [05:03<04:18,  4.53s/it][A
 55%|█████▌    | 69/125 [05:08<04:13,  4.52s/it][A
 56%|█████▌    | 70/125 [05:12<04:09,  4.53s/it][A
 57%|█████▋    | 71/125 [05:17<04:05,  4.54s/it][A
 58%|█████▊    | 72/125 [05:21<04:00,  4.55s/it][A
 58%|█████▊    | 73/125 [05:26<03:56,  4.55s/it][A
 59%|█████▉    | 74/125 [05:31<03:53,  4.59s/it][A
 60%|██████    | 75/125 [05:35<03:48,  4.57s/it][A
 61%|██████    | 76/125 [05:40<03:43,  4.56s/it][A
 62%|██████▏   | 77/125 [05:44<03:38,  4.55s/it][A
 62%|██████▏   | 78/125 [05:49<03:33,  4.54s/it][A
 63%|██████▎   | 79/125 [05:53<03:28,  4.53s/it][A
 64%|██████▍   | 80/125 [05:58<03:23,  4.53s/it][A
 65%|██████▍   | 81/125 [06:02<03:19,  4.54s/it][A
 66%|██████▌   | 82/125 [06:07<03:14,  4.53s/it][A
 66%|██████▋   | 83/125 [06:11<03:10,  4.53s/it][A
 67%|██████▋   | 84/125 [06:16<03:05,  4.52s/it][A
 68%|██████▊   | 85/125 [06:20<03:01,  4.53s/it][A
 69%|██████▉   | 86/125 [06:25<02:56,  4.53s/it][A
 70%|██████▉   | 87/125 [06:29<02:52,  4.54s/it][A
 70%|███████   | 88/125 [06:34<02:47,  4.54s/it][A
 71%|███████   | 89/125 [06:38<02:43,  4.53s/it][A
 72%|███████▏  | 90/125 [06:43<02:38,  4.52s/it][A
 73%|███████▎  | 91/125 [06:47<02:33,  4.51s/it][A
 74%|███████▎  | 92/125 [06:52<02:28,  4.50s/it][A
 74%|███████▍  | 93/125 [06:57<02:24,  4.53s/it][A
 75%|███████▌  | 94/125 [07:01<02:20,  4.52s/it][A
 76%|███████▌  | 95/125 [07:06<02:15,  4.53s/it][A
 77%|███████▋  | 96/125 [07:10<02:11,  4.53s/it][A
 78%|███████▊  | 97/125 [07:15<02:06,  4.53s/it][A
 78%|███████▊  | 98/125 [07:19<02:02,  4.53s/it][A
 79%|███████▉  | 99/125 [07:24<01:57,  4.52s/it][A
 80%|████████  | 100/125 [07:28<01:53,  4.52s/it][A
 81%|████████  | 101/125 [07:33<01:48,  4.52s/it][A
 82%|████████▏ | 102/125 [07:37<01:44,  4.54s/it][A
 82%|████████▏ | 103/125 [07:42<01:40,  4.55s/it][A
 83%|████████▎ | 104/125 [07:46<01:35,  4.55s/it][A
 84%|████████▍ | 105/125 [07:51<01:30,  4.54s/it][A
 85%|████████▍ | 106/125 [07:55<01:26,  4.53s/it][A
 86%|████████▌ | 107/125 [08:00<01:21,  4.52s/it][A
 86%|████████▋ | 108/125 [08:05<01:16,  4.53s/it][A
 87%|████████▋ | 109/125 [08:09<01:12,  4.53s/it][A
 88%|████████▊ | 110/125 [08:14<01:07,  4.52s/it][A
 89%|████████▉ | 111/125 [08:18<01:03,  4.53s/it][A
 90%|████████▉ | 112/125 [08:23<00:58,  4.53s/it][A
 90%|█████████ | 113/125 [08:27<00:54,  4.51s/it][A
 91%|█████████ | 114/125 [08:32<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:36<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:41<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:45<00:36,  4.55s/it][A
 94%|█████████▍| 118/125 [08:50<00:31,  4.54s/it][A
 95%|█████████▌| 119/125 [08:54<00:27,  4.54s/it][A
 96%|█████████▌| 120/125 [08:59<00:22,  4.53s/it][A
 97%|█████████▋| 121/125 [09:03<00:18,  4.54s/it][A
 98%|█████████▊| 122/125 [09:08<00:13,  4.54s/it][A
 98%|█████████▊| 123/125 [09:13<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:17<00:04,  4.55s/it][A
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A                                                      
                                                 [A 81%|████████▏ | 400/492 [6:53:40<2:52:35, 112.56s/it]
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-400)... Done. 5.1s
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
wandb: WARNING Cache size exceeded. Attempting to reclaim space...
 82%|████████▏ | 401/492 [6:55:44<7:13:43, 285.97s/it] 82%|████████▏ | 402/492 [6:57:37<5:50:59, 233.99s/it] 82%|████████▏ | 403/492 [6:59:29<4:53:04, 197.57s/it] 82%|████████▏ | 404/492 [7:01:22<4:12:24, 172.10s/it] 82%|████████▏ | 405/492 [7:03:14<3:43:35, 154.20s/it]                                                       82%|████████▏ | 405/492 [7:03:14<3:43:35, 154.20s/it] 83%|████████▎ | 406/492 [7:05:07<3:23:11, 141.76s/it] 83%|████████▎ | 407/492 [7:07:00<3:08:23, 132.98s/it] 83%|████████▎ | 408/492 [7:08:52<2:57:34, 126.84s/it] 83%|████████▎ | 409/492 [7:10:45<2:49:35, 122.59s/it] 83%|████████▎ | 410/492 [7:12:37<2:43:23, 119.56s/it]                                                       83%|████████▎ | 410/492 [7:12:37<2:43:23, 119.56s/it] 84%|████████▎ | 411/492 [7:14:30<2:38:31, 117.43s/it] 84%|████████▎ | 412/492 [7:16:22<2:34:39, 115.99s/it] 84%|████████▍ | 413/492 [7:18:15<2:31:18, 114.91s/it] 84%|████████▍ | 414/492 [7:20:08<2:28:33, 114.28s/it] 84%|████████▍ | 415/492 [7:22:00<2:26:07, 113.87s/it]                                                       84%|████████▍ | 415/492 [7:22:00<2:26:07, 113.87s/it] 85%|████████▍ | 416/492 [7:23:53<2:23:47, 113.52s/it] 85%|████████▍ | 417/492 [7:25:46<2:21:40, 113.34s/it] 85%|████████▍ | 418/492 [7:27:38<2:19:24, 113.03s/it] 85%|████████▌ | 419/492 [7:29:31<2:17:23, 112.93s/it] 85%|████████▌ | 420/492 [7:31:24<2:15:20, 112.78s/it]                                                       85%|████████▌ | 420/492 [7:31:24<2:15:20, 112.78s/it] 86%|████████▌ | 421/492 [7:33:16<2:13:23, 112.72s/it] 86%|████████▌ | 422/492 [7:35:08<2:11:20, 112.58s/it] 86%|████████▌ | 423/492 [7:37:01<2:09:24, 112.52s/it] 86%|████████▌ | 424/492 [7:38:53<2:07:20, 112.36s/it] 86%|████████▋ | 425/492 [7:40:45<2:05:32, 112.42s/it]                                                       86%|████████▋ | 425/492 [7:40:45<2:05:32, 112.42s/it] 87%|████████▋ | 426/492 [7:42:38<2:03:44, 112.50s/it] 87%|████████▋ | 427/492 [7:44:31<2:02:04, 112.68s/it] 87%|████████▋ | 428/492 [7:46:24<2:00:09, 112.65s/it] 87%|████████▋ | 429/492 [7:48:16<1:58:04, 112.45s/it] 87%|████████▋ | 430/492 [7:50:08<1:56:03, 112.32s/it]                                                       87%|████████▋ | 430/492 [7:50:08<1:56:03, 112.32s/it] 88%|████████▊ | 431/492 [7:52:00<1:54:14, 112.38s/it] 88%|████████▊ | 432/492 [7:53:53<1:52:29, 112.49s/it] 88%|████████▊ | 433/492 [7:55:46<1:50:42, 112.58s/it] 88%|████████▊ | 434/492 [7:57:38<1:48:50, 112.60s/it] 88%|████████▊ | 435/492 [7:59:31<1:46:57, 112.60s/it]                                                       88%|████████▊ | 435/492 [7:59:31<1:46:57, 112.60s/it] 89%|████████▊ | 436/492 [8:01:23<1:45:01, 112.53s/it] 89%|████████▉ | 437/492 [8:03:16<1:43:12, 112.59s/it] 89%|████████▉ | 438/492 [8:05:09<1:41:18, 112.56s/it] 89%|████████▉ | 439/492 [8:07:01<1:39:31, 112.66s/it] 89%|████████▉ | 440/492 [8:08:54<1:37:33, 112.56s/it]                                                       89%|████████▉ | 440/492 [8:08:54<1:37:33, 112.56s/it] 90%|████████▉ | 441/492 [8:10:47<1:35:44, 112.63s/it] 90%|████████▉ | 442/492 [8:12:39<1:33:53, 112.67s/it] 90%|█████████ | 443/492 [8:14:32<1:32:00, 112.67s/it] 90%|█████████ | 444/492 [8:16:25<1:30:08, 112.67s/it] 90%|█████████ | 445/492 [8:18:17<1:28:10, 112.57s/it]                                                       90%|█████████ | 445/492 [8:18:17<1:28:10, 112.57s/it] 91%|█████████ | 446/492 [8:20:09<1:26:15, 112.52s/it] 91%|█████████ | 447/492 [8:22:02<1:24:25, 112.58s/it] 91%|█████████ | 448/492 [8:23:54<1:22:29, 112.50s/it] 91%|█████████▏| 449/492 [8:25:47<1:20:39, 112.55s/it] 91%|█████████▏| 450/492 [8:27:40<1:18:47, 112.56s/it]                                                       91%|█████████▏| 450/492 [8:27:40<1:18:47, 112.56s/it]{'eval_loss': 0.11832693219184875, 'eval_runtime': 566.7299, 'eval_samples_per_second': 1.765, 'eval_steps_per_second': 0.221, 'epoch': 3.25}
{'loss': 0.1129, 'grad_norm': 0.09948204457759857, 'learning_rate': 9.258712672491415e-06, 'epoch': 3.29}
{'loss': 0.1101, 'grad_norm': 0.10511817038059235, 'learning_rate': 8.254563928638893e-06, 'epoch': 3.33}
{'loss': 0.1121, 'grad_norm': 0.11750485748052597, 'learning_rate': 7.3031331341093915e-06, 'epoch': 3.37}
{'loss': 0.1102, 'grad_norm': 0.09111586213111877, 'learning_rate': 6.405621797022848e-06, 'epoch': 3.41}
{'loss': 0.0995, 'grad_norm': 0.08644920587539673, 'learning_rate': 5.563163333667099e-06, 'epoch': 3.45}
{'loss': 0.0984, 'grad_norm': 0.10021346062421799, 'learning_rate': 4.776821637170526e-06, 'epoch': 3.49}
{'loss': 0.1102, 'grad_norm': 0.09591208398342133, 'learning_rate': 4.047589733971646e-06, 'epoch': 3.53}
{'loss': 0.1085, 'grad_norm': 0.11921706050634384, 'learning_rate': 3.376388529782215e-06, 'epoch': 3.57}
{'loss': 0.1082, 'grad_norm': 0.08839091658592224, 'learning_rate': 2.7640656466274782e-06, 'epoch': 3.62}
{'loss': 0.1041, 'grad_norm': 0.09160158783197403, 'learning_rate': 2.2113943524323167e-06, 'epoch': 3.66}

  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:04<04:39,  2.27s/it][A
  2%|▏         | 3/125 [00:09<06:33,  3.22s/it][A
  3%|▎         | 4/125 [00:13<07:28,  3.71s/it][A
  4%|▍         | 5/125 [00:18<08:01,  4.01s/it][A
  5%|▍         | 6/125 [00:22<08:18,  4.19s/it][A
  6%|▌         | 7/125 [00:27<08:27,  4.30s/it][A
  6%|▋         | 8/125 [00:31<08:31,  4.37s/it][A
  7%|▋         | 9/125 [00:36<08:31,  4.41s/it][A
  8%|▊         | 10/125 [00:40<08:32,  4.46s/it][A
  9%|▉         | 11/125 [00:45<08:31,  4.49s/it][A
 10%|▉         | 12/125 [00:49<08:28,  4.50s/it][A
 10%|█         | 13/125 [00:54<08:23,  4.50s/it][A
 11%|█         | 14/125 [00:58<08:20,  4.51s/it][A
 12%|█▏        | 15/125 [01:03<08:15,  4.50s/it][A
 13%|█▎        | 16/125 [01:08<08:12,  4.52s/it][A
 14%|█▎        | 17/125 [01:12<08:08,  4.53s/it][A
 14%|█▍        | 18/125 [01:17<08:04,  4.53s/it][A
 15%|█▌        | 19/125 [01:21<07:59,  4.52s/it][A
 16%|█▌        | 20/125 [01:26<07:55,  4.53s/it][A
 17%|█▋        | 21/125 [01:30<07:50,  4.52s/it][A
 18%|█▊        | 22/125 [01:35<07:45,  4.52s/it][A
 18%|█▊        | 23/125 [01:39<07:39,  4.51s/it][A
 19%|█▉        | 24/125 [01:44<07:37,  4.53s/it][A
 20%|██        | 25/125 [01:48<07:35,  4.56s/it][A
 21%|██        | 26/125 [01:53<07:32,  4.57s/it][A
 22%|██▏       | 27/125 [01:57<07:26,  4.56s/it][A
 22%|██▏       | 28/125 [02:02<07:19,  4.53s/it][A
 23%|██▎       | 29/125 [02:06<07:15,  4.53s/it][A
 24%|██▍       | 30/125 [02:11<07:09,  4.52s/it][A
 25%|██▍       | 31/125 [02:16<07:05,  4.53s/it][A
 26%|██▌       | 32/125 [02:20<07:00,  4.52s/it][A
 26%|██▋       | 33/125 [02:25<06:56,  4.52s/it][A
 27%|██▋       | 34/125 [02:29<06:50,  4.51s/it][A
 28%|██▊       | 35/125 [02:34<06:46,  4.51s/it][A
 29%|██▉       | 36/125 [02:38<06:42,  4.52s/it][A
 30%|██▉       | 37/125 [02:43<06:37,  4.51s/it][A
 30%|███       | 38/125 [02:47<06:32,  4.51s/it][A
 31%|███       | 39/125 [02:52<06:28,  4.52s/it][A
 32%|███▏      | 40/125 [02:56<06:24,  4.52s/it][A
 33%|███▎      | 41/125 [03:01<06:21,  4.55s/it][A
 34%|███▎      | 42/125 [03:05<06:16,  4.54s/it][A
 34%|███▍      | 43/125 [03:10<06:11,  4.53s/it][A
 35%|███▌      | 44/125 [03:14<06:07,  4.53s/it][A
 36%|███▌      | 45/125 [03:19<06:04,  4.55s/it][A
 37%|███▋      | 46/125 [03:23<05:58,  4.54s/it][A
 38%|███▊      | 47/125 [03:28<05:52,  4.52s/it][A
 38%|███▊      | 48/125 [03:32<05:48,  4.53s/it][A
 39%|███▉      | 49/125 [03:37<05:44,  4.53s/it][A
 40%|████      | 50/125 [03:42<05:39,  4.53s/it][A
 41%|████      | 51/125 [03:46<05:35,  4.53s/it][A
 42%|████▏     | 52/125 [03:51<05:30,  4.53s/it][A
 42%|████▏     | 53/125 [03:55<05:26,  4.53s/it][A
 43%|████▎     | 54/125 [04:00<05:22,  4.54s/it][A
 44%|████▍     | 55/125 [04:04<05:18,  4.54s/it][A
 45%|████▍     | 56/125 [04:09<05:13,  4.54s/it][A
 46%|████▌     | 57/125 [04:13<05:08,  4.54s/it][A
 46%|████▋     | 58/125 [04:18<05:04,  4.55s/it][A
 47%|████▋     | 59/125 [04:22<04:58,  4.53s/it][A
 48%|████▊     | 60/125 [04:27<04:54,  4.53s/it][A
 49%|████▉     | 61/125 [04:31<04:49,  4.52s/it][A
 50%|████▉     | 62/125 [04:36<04:44,  4.52s/it][A
 50%|█████     | 63/125 [04:41<04:41,  4.54s/it][A
 51%|█████     | 64/125 [04:45<04:36,  4.54s/it][A
 52%|█████▏    | 65/125 [04:50<04:31,  4.52s/it][A
 53%|█████▎    | 66/125 [04:54<04:27,  4.54s/it][A
 54%|█████▎    | 67/125 [04:59<04:22,  4.52s/it][A
 54%|█████▍    | 68/125 [05:03<04:18,  4.53s/it][A
 55%|█████▌    | 69/125 [05:08<04:13,  4.52s/it][A
 56%|█████▌    | 70/125 [05:12<04:09,  4.53s/it][A
 57%|█████▋    | 71/125 [05:17<04:04,  4.54s/it][A
 58%|█████▊    | 72/125 [05:21<04:00,  4.54s/it][A
 58%|█████▊    | 73/125 [05:26<03:56,  4.55s/it][A
 59%|█████▉    | 74/125 [05:31<03:53,  4.58s/it][A
 60%|██████    | 75/125 [05:35<03:48,  4.56s/it][A
 61%|██████    | 76/125 [05:40<03:43,  4.56s/it][A
 62%|██████▏   | 77/125 [05:44<03:38,  4.55s/it][A
 62%|██████▏   | 78/125 [05:49<03:33,  4.54s/it][A
 63%|██████▎   | 79/125 [05:53<03:28,  4.53s/it][A
 64%|██████▍   | 80/125 [05:58<03:23,  4.53s/it][A
 65%|██████▍   | 81/125 [06:02<03:19,  4.54s/it][A
 66%|██████▌   | 82/125 [06:07<03:14,  4.53s/it][A
 66%|██████▋   | 83/125 [06:11<03:10,  4.52s/it][A
 67%|██████▋   | 84/125 [06:16<03:05,  4.52s/it][A
 68%|██████▊   | 85/125 [06:20<03:01,  4.53s/it][A
 69%|██████▉   | 86/125 [06:25<02:56,  4.53s/it][A
 70%|██████▉   | 87/125 [06:29<02:52,  4.54s/it][A
 70%|███████   | 88/125 [06:34<02:47,  4.54s/it][A
 71%|███████   | 89/125 [06:38<02:43,  4.53s/it][A
 72%|███████▏  | 90/125 [06:43<02:38,  4.52s/it][A
 73%|███████▎  | 91/125 [06:47<02:33,  4.51s/it][A
 74%|███████▎  | 92/125 [06:52<02:28,  4.50s/it][A
 74%|███████▍  | 93/125 [06:57<02:24,  4.53s/it][A
 75%|███████▌  | 94/125 [07:01<02:20,  4.52s/it][A
 76%|███████▌  | 95/125 [07:06<02:15,  4.53s/it][A
 77%|███████▋  | 96/125 [07:10<02:11,  4.52s/it][A
 78%|███████▊  | 97/125 [07:15<02:06,  4.53s/it][A
 78%|███████▊  | 98/125 [07:19<02:02,  4.52s/it][A
 79%|███████▉  | 99/125 [07:24<01:57,  4.52s/it][A
 80%|████████  | 100/125 [07:28<01:53,  4.53s/it][A
 81%|████████  | 101/125 [07:33<01:48,  4.52s/it][A
 82%|████████▏ | 102/125 [07:37<01:44,  4.54s/it][A
 82%|████████▏ | 103/125 [07:42<01:40,  4.55s/it][A
 83%|████████▎ | 104/125 [07:46<01:35,  4.55s/it][A
 84%|████████▍ | 105/125 [07:51<01:30,  4.54s/it][A
 85%|████████▍ | 106/125 [07:55<01:26,  4.53s/it][A
 86%|████████▌ | 107/125 [08:00<01:21,  4.52s/it][A
 86%|████████▋ | 108/125 [08:04<01:16,  4.53s/it][A
 87%|████████▋ | 109/125 [08:09<01:12,  4.53s/it][A
 88%|████████▊ | 110/125 [08:14<01:07,  4.53s/it][A
 89%|████████▉ | 111/125 [08:18<01:03,  4.53s/it][A
 90%|████████▉ | 112/125 [08:23<00:58,  4.53s/it][A
 90%|█████████ | 113/125 [08:27<00:54,  4.51s/it][A
 91%|█████████ | 114/125 [08:32<00:49,  4.54s/it][A
 92%|█████████▏| 115/125 [08:36<00:45,  4.55s/it][A
 93%|█████████▎| 116/125 [08:41<00:40,  4.55s/it][A
 94%|█████████▎| 117/125 [08:45<00:36,  4.55s/it][A
 94%|█████████▍| 118/125 [08:50<00:31,  4.55s/it][A
 95%|█████████▌| 119/125 [08:54<00:27,  4.54s/it][A
 96%|█████████▌| 120/125 [08:59<00:22,  4.53s/it][A
 97%|█████████▋| 121/125 [09:03<00:18,  4.54s/it][A
 98%|█████████▊| 122/125 [09:08<00:13,  4.54s/it][A
 98%|█████████▊| 123/125 [09:13<00:09,  4.56s/it][A
 99%|█████████▉| 124/125 [09:17<00:04,  4.55s/it][A
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A                                                      
                                                 [A 91%|█████████▏| 450/492 [8:37:06<1:18:47, 112.56s/it]
100%|██████████| 125/125 [09:22<00:00,  4.55s/it][A
                                                 [A/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-450)... Done. 5.2s
/workspace/venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 92%|█████████▏| 451/492 [8:39:11<3:15:29, 286.08s/it] 92%|█████████▏| 452/492 [8:41:03<2:35:58, 233.95s/it] 92%|█████████▏| 453/492 [8:42:55<2:08:22, 197.50s/it] 92%|█████████▏| 454/492 [8:44:48<1:48:56, 172.02s/it] 92%|█████████▏| 455/492 [8:46:41<1:35:05, 154.22s/it]                                                       92%|█████████▏| 455/492 [8:46:41<1:35:05, 154.22s/it] 93%|█████████▎| 456/492 [8:48:33<1:25:04, 141.79s/it] 93%|█████████▎| 457/492 [8:50:26<1:17:37, 133.08s/it] 93%|█████████▎| 458/492 [8:52:19<1:11:58, 127.03s/it] 93%|█████████▎| 459/492 [8:54:12<1:07:30, 122.75s/it] 93%|█████████▎| 460/492 [8:56:04<1:03:48, 119.65s/it]                                                       93%|█████████▎| 460/492 [8:56:04<1:03:48, 119.65s/it] 94%|█████████▎| 461/492 [8:57:57<1:00:42, 117.49s/it] 94%|█████████▍| 462/492 [8:59:49<57:56, 115.89s/it]   94%|█████████▍| 463/492 [9:01:41<55:31, 114.88s/it] 94%|█████████▍| 464/492 [9:03:34<53:16, 114.17s/it] 95%|█████████▍| 465/492 [9:05:27<51:10, 113.72s/it]                                                     95%|█████████▍| 465/492 [9:05:27<51:10, 113.72s/it] 95%|█████████▍| 466/492 [9:07:20<49:13, 113.60s/it] 95%|█████████▍| 467/492 [9:09:13<47:16, 113.45s/it] 95%|█████████▌| 468/492 [9:11:06<45:17, 113.23s/it] 95%|█████████▌| 469/492 [9:12:58<43:19, 113.02s/it] 96%|█████████▌| 470/492 [9:14:50<41:21, 112.78s/it]                                                     96%|█████████▌| 470/492 [9:14:50<41:21, 112.78s/it] 96%|█████████▌| 471/492 [9:16:43<39:25, 112.67s/it] 96%|█████████▌| 472/492 [9:18:36<37:35, 112.77s/it] 96%|█████████▌| 473/492 [9:20:28<35:38, 112.54s/it] 96%|█████████▋| 474/492 [9:22:20<33:45, 112.55s/it] 97%|█████████▋| 475/492 [9:24:13<31:55, 112.68s/it]                                                     97%|█████████▋| 475/492 [9:24:13<31:55, 112.68s/it] 97%|█████████▋| 476/492 [9:26:06<30:01, 112.59s/it] 97%|█████████▋| 477/492 [9:27:59<28:10, 112.67s/it] 97%|█████████▋| 478/492 [9:29:51<26:15, 112.56s/it] 97%|█████████▋| 479/492 [9:31:43<24:22, 112.51s/it] 98%|█████████▊| 480/492 [9:33:36<22:30, 112.57s/it]                                                     98%|█████████▊| 480/492 [9:33:36<22:30, 112.57s/it] 98%|█████████▊| 481/492 [9:35:28<20:36, 112.39s/it] 98%|█████████▊| 482/492 [9:37:21<18:44, 112.42s/it] 98%|█████████▊| 483/492 [9:39:13<16:51, 112.43s/it] 98%|█████████▊| 484/492 [9:41:06<15:00, 112.51s/it] 99%|█████████▊| 485/492 [9:42:58<13:08, 112.60s/it]                                                     99%|█████████▊| 485/492 [9:42:59<13:08, 112.60s/it] 99%|█████████▉| 486/492 [9:44:51<11:15, 112.60s/it] 99%|█████████▉| 487/492 [9:46:44<09:22, 112.57s/it] 99%|█████████▉| 488/492 [9:48:36<07:30, 112.54s/it] 99%|█████████▉| 489/492 [9:50:28<05:37, 112.49s/it]100%|█████████▉| 490/492 [9:52:21<03:45, 112.57s/it]                                                    100%|█████████▉| 490/492 [9:52:21<03:45, 112.57s/it]100%|█████████▉| 491/492 [9:54:14<01:52, 112.50s/it]100%|██████████| 492/492 [9:56:06<00:00, 112.54s/it]/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb: Adding directory to artifact (./model_training/deepseek_prover_base_no_err/checkpoints-random-09-07-09-02/checkpoint-492)... Done. 5.1s
                                                    100%|██████████| 492/492 [9:56:19<00:00, 112.54s/it]/workspace/venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:232: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
{'eval_loss': 0.11773921549320221, 'eval_runtime': 566.7284, 'eval_samples_per_second': 1.765, 'eval_steps_per_second': 0.221, 'epoch': 3.66}
{'loss': 0.1165, 'grad_norm': 0.11168824136257172, 'learning_rate': 1.7190725845048827e-06, 'epoch': 3.7}
{'loss': 0.1136, 'grad_norm': 0.09236614406108856, 'learning_rate': 1.2877220681510927e-06, 'epoch': 3.74}
{'loss': 0.1092, 'grad_norm': 0.09877419471740723, 'learning_rate': 9.178875315329183e-07, 'epoch': 3.78}
{'loss': 0.1133, 'grad_norm': 0.08279547840356827, 'learning_rate': 6.100360177619946e-07, 'epoch': 3.82}
{'loss': 0.1015, 'grad_norm': 0.10098084062337875, 'learning_rate': 3.6455629509730136e-07, 'epoch': 3.86}
{'loss': 0.1103, 'grad_norm': 0.10278213024139404, 'learning_rate': 1.8175836599173546e-07, 'epoch': 3.9}
{'loss': 0.1062, 'grad_norm': 0.09736195206642151, 'learning_rate': 6.187307560754363e-08, 'epoch': 3.94}
{'loss': 0.1088, 'grad_norm': 0.09903877973556519, 'learning_rate': 5.051820295032261e-09, 'epoch': 3.98}
{'train_runtime': 35786.8606, 'train_samples_per_second': 0.88, 'train_steps_per_second': 0.014, 'train_loss': 0.06722529256731515, 'epoch': 4.0}
Finetuning Finished.
wandb: - 9781.498 MB of 9781.498 MB uploaded (22.047 MB deduped)wandb: \ 9781.498 MB of 9781.498 MB uploaded (22.047 MB deduped)wandb: | 9781.498 MB of 9781.498 MB uploaded (22.047 MB deduped)wandb: / 9781.498 MB of 9781.498 MB uploaded (22.047 MB deduped)wandb: - 9781.498 MB of 9781.498 MB uploaded (22.047 MB deduped)wandb: \ 9781.514 MB of 9781.527 MB uploaded (22.047 MB deduped)wandb: | 9781.527 MB of 9781.527 MB uploaded (22.047 MB deduped)wandb: 
wandb: Run history:
wandb:               eval/loss █▅▃▁▁
wandb:            eval/runtime ▁█▇██
wandb: eval/samples_per_second █▁▁▁▁
wandb:   eval/steps_per_second ▁▁▁▁▁
wandb:             train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train/global_step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:         train/grad_norm ▅▂▂▂▁▂▃▂▃█▂▄▂▂▃▃▄▂▂▃▂▂▂▃▃▃▄▂▃▃▂▃▂▂▂▂▃▃▃▃
wandb:     train/learning_rate ███▇▇▇▇▆▆▆▆▅▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:              train/loss █▅▇▆▅▆▅▅▄▆▆▂▄▅▄▄▃▄▄▄▂▅▃▃▃▃▃▂▄▄▃▁▃▃▂▄▃▂▃▃
wandb: 
wandb: Run summary:
wandb:                eval/loss 0.11774
wandb:             eval/runtime 566.7284
wandb:  eval/samples_per_second 1.765
wandb:    eval/steps_per_second 0.221
wandb:               total_flos 3.138580840489943e+18
wandb:              train/epoch 3.99695
wandb:        train/global_step 492
wandb:          train/grad_norm 0.09904
wandb:      train/learning_rate 0.0
wandb:               train/loss 0.1088
wandb:               train_loss 0.06723
wandb:            train_runtime 35786.8606
wandb: train_samples_per_second 0.88
wandb:   train_steps_per_second 0.014
wandb: 
wandb: 🚀 View run deepseek_prover_base_no_err-random-09-07-09-02 at: https://wandb.ai/tcwong/decoder/runs/v2s2rx9y
wandb: ⭐️ View project at: https://wandb.ai/tcwong/decoder
wandb: Synced 5 W&B file(s), 0 media file(s), 66 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240907_185630-v2s2rx9y/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
